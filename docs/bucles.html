<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R avanzado 2023 - Bucles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R avanzado 2023</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuales" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Manuales</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-manuales">    
        <li>
    <a class="dropdown-item" href="./fundamentos_de_r.html">
 <span class="dropdown-text">Fundamentos de R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./reportes_dinamicos.html">
 <span class="dropdown-text">Reportes dinámicos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./funciones.html">
 <span class="dropdown-text">Funciones</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./bucles.html">
 <span class="dropdown-text">Bucles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./modelos_de_regresion.html">
 <span class="dropdown-text">Modelos de regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./estadistica_tradicional_regresion.html">
 <span class="dropdown-text">Estadística tradicional como regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ggplot2.html">
 <span class="dropdown-text">Gráficos con ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./preparacion_curso.html">
 <span class="menu-text">Preparación para el curso</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://codefile.io/f/inMsojTFoN">
 <span class="menu-text">Compartir código</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html">
 <span class="menu-text">Instructor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maRce10/R_avanzado_2023/"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul class="collapse">
  <li><a href="#bucles-loops" id="toc-bucles-loops" class="nav-link active" data-scroll-target="#bucles-loops"><span class="toc-section-number">1</span>  Bucles (loops)</a></li>
  <li><a href="#bucles-for" id="toc-bucles-for" class="nav-link" data-scroll-target="#bucles-for"><span class="toc-section-number">2</span>  Bucles ‘for’</a>
  <ul class="collapse">
  <li><a href="#aplicación-al-manejo-de-datos" id="toc-aplicación-al-manejo-de-datos" class="nav-link" data-scroll-target="#aplicación-al-manejo-de-datos"><span class="toc-section-number">2.1</span>  Aplicación al manejo de datos</a></li>
  </ul></li>
  <li><a href="#bucles-xapply" id="toc-bucles-xapply" class="nav-link" data-scroll-target="#bucles-xapply"><span class="toc-section-number">3</span>  Bucles ‘(X)apply’</a>
  <ul class="collapse">
  <li><a href="#bucles-replicate" id="toc-bucles-replicate" class="nav-link" data-scroll-target="#bucles-replicate"><span class="toc-section-number">3.1</span>  bucles <code>replicate</code></a></li>
  </ul></li>
  <li><a href="#bucles-repeat" id="toc-bucles-repeat" class="nav-link" data-scroll-target="#bucles-repeat"><span class="toc-section-number">4</span>  Bucles ‘repeat’</a></li>
  <li><a href="#bucles-while" id="toc-bucles-while" class="nav-link" data-scroll-target="#bucles-while"><span class="toc-section-number">5</span>  Bucles ‘While’</a>
  <ul class="collapse">
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="toc-section-number">5.1</span>  Referencias</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><font size="7"><b>Bucles</b></font></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">28 de septiembre de 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<div class="cell">

</div>
<section id="objetivos-del-manual" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Objetivos del manual</h1>
<ul>
<li>Aprender a procesar de forma serial operaciones que deben repetirse sobre diferentes objetos</li>
<li>Familiarizarse con el uso de bucles en la plataforma R</li>
<li>Tener una noción general de los opciones disponibles en R para construir bucles</li>
</ul>
</section>
<hr>
<p>Primero debemos preparar los archivos de ejemplo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># definir directorio a donde guardar los archivos</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>directorio <span class="ot">&lt;-</span> <span class="st">"DIRECCION_DONDE_GUARDAR_LOS ARCHIVOS_DE_EJEMPLO"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># guardar archivos</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">download.file</span>(</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="st">"https://github.com/maRce10/ucr_r_avanzado/"</span>,</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="st">"raw/master/additional_files/datos_camara_submarina.zip"</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  ),</span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="at">destfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">"datos_camara_submarina.zip"</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>)</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># extraerlos del zip</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">unzip</span>(</span>
<span id="cb1-15"><a href="#cb1-15"></a>  <span class="at">zipfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">"datos_camara_submarina.zip"</span>),</span>
<span id="cb1-16"><a href="#cb1-16"></a>  <span class="at">exdir =</span> directorio</span>
<span id="cb1-17"><a href="#cb1-17"></a>)</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># hacer vector con nombre y direccion de archivos</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>archivos_txt <span class="ot">&lt;-</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="fu">list.files</span>(</span>
<span id="cb1-22"><a href="#cb1-22"></a>    <span class="at">path =</span> directorio,</span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-24"><a href="#cb1-24"></a>    <span class="at">pattern =</span> <span class="st">"TXT$"</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<p>&nbsp;</p>
<p>También pueden bajar el archivo directamente de <a href="https://github.com/maRce10/ucr_r_avanzado/raw/master/additional_files/datos_camara_submarina.zip">este enlance</a>. Recuerde extraer los archivos y hacer el vector con los nombres de los archivos (correr lineas de la 9 a la 13).</p>
<p>Si todo salió bien el vector “archivos_txt” deberia tener 19 elementos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">length</span>(archivos_txt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19</code></pre>
</div>
</div>
<hr>
<p>&nbsp;</p>
<section id="bucles-loops" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Bucles (loops)</h1>
<ul>
<li>Proceso automatizado de varios pasos organizado como secuencias de acciones (p.&nbsp;Ej., procesos ‘por lotes’)</li>
<li>Se usa para acelerar los procedimientos en los que se aplica la misma acción a muchos objetos (similares)</li>
<li>Crítico para la gestión de grandes bases de datos (‘big data’, y buenas prácticas de programación)</li>
</ul>
<p>2 tipos básicos:</p>
<ol type="1">
<li>Ejecutar para un número predefinido de iteraciones (es decir, tiempos). Estos se subdividen en dos clases:
<ol type="a">
<li>Los resultados pueden ingresarse nuevamente en la siguiente iteración (bucles <code>for</code>)</li>
<li>Los resultados de una interacción no pueden afectar a otras iteraciones (<code>(X)apply</code>)</li>
</ol></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/loops2_esp.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p><font size="2"> * Modificado de <i> Tutorial de bucles Datacamp </i> </font></p>
<p>&nbsp;</p>
<ol start="2" type="1">
<li>Ejecutar hasta que se cumpla una condición predefinida (bucles <code>while</code> y<code>repeat</code>)</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/loops1_esp.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="bucles-for" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Bucles ‘for’</h1>
<p>Por mucho, <code>for</code> es el bucle más popular. Se caracteriza por que el número de iteraciones se puede determinar de antemano y las iteraciones pueden tomar en cuenta resultados de iteraciones anteriores:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/for_esp.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>El bucle <code>for</code> se inicia con el operador <code>for</code>. A este se le da un vector (<em>sensu lato</em>: lista o vector atómico) sobre el cual repetir una tarea. La tarea se encuentra en el cuerpo del bucle:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) { <span class="co"># inicio del bucle</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>} <span class="co"># cuerpo del bucle</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1
[1] 4
[1] 9</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Note que en dentro de los paréntesis del operador <code>for</code> se usa el operador <code>in</code>. Este denota el nombre de objeto que se usará en el cuerpo del bucle para asignar los velores del vector. El bucle devuelve 3 valores, uno para cada valor en <code>vctr</code>.</p>
<p>Una forma mas clara de demostrar como el bucle repite la acción de forma serial sobre cada elemento del vector es añadiendo pausas entre iteraciones. La función <code>Sys.sleep()</code> pausa el código de R por el número de segundos que se le defina:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) { <span class="co"># inicio del bucle</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"# corriendo iteración"</span>, i))</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>) <span class="co"># pausar 2 segundos</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>) <span class="co"># cuerpo del bucle</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "# corriendo iteración 1"
[1] 1
[1] "# corriendo iteración 2"
[1] 4
[1] "# corriendo iteración 3"
[1] 9</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>En este caso vemos como el bucle toma una pausa entre cada iteración y luego hace el cálculo (cuando corre el código en su computadora).</p>
<p>Si deseamos guardar el resultado de las operaciones debemos añadirlo a un vector vacío. Para hacer esto hay 2 opciones:</p>
<ul>
<li>Usando la función <code>append()</code></li>
<li>Agregar nuevos elementos a un vector usando indexación</li>
</ul>
<p>El siguiente código guarda los resultados usando <code>append()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># vector vacio</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># inicio del bucle</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  i2 <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, i2)</span>
<span id="cb8-14"><a href="#cb8-14"></a>}</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># ver resultados</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>resultados</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 9</code></pre>
</div>
</div>
<p>Note que <code>append()</code> se usa dentro del cuerpo del bucle luego de hacer los cálculos.</p>
<p>Así podemos guardar los resultados usando indexación:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># vector vacio</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co"># inicio del bucle</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  i2 <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>  resultados[<span class="fu">length</span>(resultados) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> i2</span>
<span id="cb10-14"><a href="#cb10-14"></a>}</span>
<span id="cb10-15"><a href="#cb10-15"></a></span>
<span id="cb10-16"><a href="#cb10-16"></a>resultados</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 9</code></pre>
</div>
</div>
<p>Estos bucles se pueden correr sobre cualquier vector. Por ejemplo podemos evaluar para el juego de datos <code>iris</code> el promedio del largo del sépalo para cada especie de esta forma:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>vctr <span class="ot">&lt;-</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co"># vector vacio</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co"># inicio del bucle</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">max</span>(iris<span class="sc">$</span>Sepal.Length[iris<span class="sc">$</span>Species <span class="sc">==</span> i])</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, i2)</span>
<span id="cb12-14"><a href="#cb12-14"></a>}</span>
<span id="cb12-15"><a href="#cb12-15"></a></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co"># añadir nombre de especies</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="fu">names</span>(resultados) <span class="ot">&lt;-</span> vctr</span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a>resultados</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    setosa versicolor  virginica 
       5.8        7.0        7.9 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<section id="aplicación-al-manejo-de-datos" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="aplicación-al-manejo-de-datos"><span class="header-section-number">2.1</span> Aplicación al manejo de datos</h2>
<p>Usaremos los datos de ejemplo que bajamos al inicio del manual para demostrar la utilidad del los bucles en el manejo de datos. Estos datos muestran la salida de un programa de identificación automática de especies marinas en videos pasivos tomados en la columna de agua. Para cada video analizado el programa genera un archivo de texto (.TXT) con una fila para cada especie detectada mas una serie de metadatos asociados a la detección. Los datos se ven así:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/datos.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Recordemos que los nombres de los archivos .TXT están guardados en un vector llamado <code>archivos_txt</code>. Podemos leer el primer archivo (i.e.&nbsp;el primer elemento en <code>archivos_txt</code>) de la siguiente forma:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>archivo1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(archivos_txt[<span class="dv">1</span>], <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># ver pirmeras 4 filas y 8 columnas</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="fu">head</span>(archivo1[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 17%">
<col style="width: 5%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Filename</th>
<th style="text-align: right;">Frame</th>
<th style="text-align: right;">Time..mins.</th>
<th style="text-align: left;">Period</th>
<th style="text-align: right;">Period.time..mins.</th>
<th style="text-align: left;">OpCode</th>
<th style="text-align: left;">TapeReader</th>
<th style="text-align: right;">Depth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GH018767_LcamT3.MP4</td>
<td style="text-align: right;">11451</td>
<td style="text-align: right;">3.1840</td>
<td style="text-align: left;">inicio</td>
<td style="text-align: right;">1.5504</td>
<td style="text-align: left;">R3-LcamT3-RcamN4_Pelada1_2021-09-24</td>
<td style="text-align: left;">Andres</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH018767_LcamT3.MP4</td>
<td style="text-align: right;">25005</td>
<td style="text-align: right;">6.9528</td>
<td style="text-align: left;">inicio</td>
<td style="text-align: right;">5.3192</td>
<td style="text-align: left;">R3-LcamT3-RcamN4_Pelada1_2021-09-24</td>
<td style="text-align: left;">Andres</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GH028767_LcamT3.MP4</td>
<td style="text-align: right;">30464</td>
<td style="text-align: right;">24.5201</td>
<td style="text-align: left;">inicio</td>
<td style="text-align: right;">22.8865</td>
<td style="text-align: left;">R3-LcamT3-RcamN4_Pelada1_2021-09-24</td>
<td style="text-align: left;">Andres</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">GH018767_LcamT3.MP4</td>
<td style="text-align: right;">26911</td>
<td style="text-align: right;">7.4828</td>
<td style="text-align: left;">inicio</td>
<td style="text-align: right;">5.8492</td>
<td style="text-align: left;">R3-LcamT3-RcamN4_Pelada1_2021-09-24</td>
<td style="text-align: left;">Andres</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos saber cuantas especies se observaron en ese muestreo simplemente calculado el número de filas en <code>archivo</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">nrow</span>(archivo1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Ahora, para hacer esto con todos los archivos <strong>no es eficiente leer cada uno en su propia linea de código</strong> y luego calcular el número de filas. Al fin de cuentas, todos los códigos serian muy parecidos, solo cambiaría el nombre del archivo. Es en estos casos que los bucles son de gran utilidad. En este ejemplo solo debemos incorporar el código de lectura del archivo y del cálculo del número de filas en el cuerpo del bucle, usando el nombre de los archivos (<code>archivos_txt</code>) como el vector sobre el cual iterar el bucle:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># vector vacio</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># inicio del bucle</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="co"># leer archivo</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="co"># calcular numero de filas</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  nrw <span class="ot">&lt;-</span> <span class="fu">nrow</span>(txt)</span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, nrw)</span>
<span id="cb17-13"><a href="#cb17-13"></a>}</span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a>resultados</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 39  1  2 12 14  9 12  8 32 36 21 12 22 27 29 19  8 12 26</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos ordenar estos resultados fácilmente haciendo un cuadro de datos (data.frame). Para esto creamos una columna con el nombre del archivo y otra con el resultado del número de filas:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># organizar en data frame</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>n_filas_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">archivo =</span> <span class="fu">basename</span>(archivos_txt), <span class="at">filas =</span> resultados)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># ver primeras 6 filas</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="fu">head</span>(n_filas_df)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">archivo</th>
<th style="text-align: right;">filas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2022-09-02_R3-LcamT3-RcamN4_Pel1_2021-09-24_MaxN.TXT</td>
<td style="text-align: right;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-09-03_S6-LB13-RB12_PuntaMariaOeste_2022-03-24_MaxN.TXT</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-09-03_T4-LB19-RB18_PuntaMariaOeste_2022-03-24_MaxN.TXT</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-09-04_S1-LB10-RN9_Arco2_2022-07-15_MaxN.TXT</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2022-09-07_P1-LB12-RB13_Gissler_2022-03-30_MaxN.TXT</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">2022-09-11_P1-LB14-RB13_Risco_2022-03-26_MaxN.TXT</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="alert alert-info">
<p><font size="5"> Ejercicio 1 </font></p>
<p>&nbsp;</p>
<p>Podemos calcular el número de familias observadas para el primer archivo que leímos (<code>archivo1</code>) de esta forma:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(archivo1<span class="sc">$</span>Family))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19</code></pre>
</div>
</div>
<p>1.1 Haga un bucle <code>for</code> que devuelva el número de familias para cada archivo</p>
<div class="cell">

</div>
<p>&nbsp;</p>
<p>1.2 Cree un cuadro de datos (data frame) que contenga dos columnas, una para el nombre del archivo y otra para el número de familias</p>
<p>&nbsp;</p>
<p>1.3 Añada una columna al cuadro de datos creado en el ejercicio anterior indicando la fecha de creación del video (esta información se encuentra en la columna ‘Date’ de cada archivo de texto). Note que cada archivo contiene solamente una fecha. Debe usar un bucle <code>for</code> para extraer esta información de los archivos.</p>
<div class="cell">

</div>
<p>&nbsp;</p>
<p>1.4 Añada una columna al cuadro de datos creado en el ejercicio 1.2 (y modificado en 1.3) indicando la profundidad a la que se grabó el video. Debe usar un bucle <code>for</code> para extraer esta información de los archivos.</p>
<div class="cell">

</div>
<p>&nbsp;</p>
<p>Puede usar el siguiente código para convertir profundidad a un vector numérico:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>n_filas_df<span class="sc">$</span>profundidad <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" m"</span>, <span class="st">""</span>, <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">,"</span>, <span class="st">"."</span>, n_filas_df<span class="sc">$</span>profundidad))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>1.5 ¿Cuál es la correlación entre el número de especies observadas (que es igual al número de filas) y la profundidad? (pista: <code>cor.test()</code>)</p>
<p>&nbsp;</p>
<p>1.6 ¿Cuál es la correlación entre el número de familias y la profundidad?</p>
<p>&nbsp;</p>
</div>
<p>El bucle <code>for</code> también puede ser usado para juntar todas los datos de los archivos de texto en un solo cuadro de datos. Esto lo podemos hacer “rellenando” un cuadro de datos vacío, de forma análoga a como rellenamos un vector vació anteriormente:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># vector vacio</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>df_resultados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co"># inicio del bucle</span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="co"># leer archivo</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  df_resultados <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_resultados, txt)</span>
<span id="cb23-11"><a href="#cb23-11"></a>}</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="fu">nrow</span>(df_resultados) <span class="sc">==</span> <span class="fu">sum</span>(n_filas_df<span class="sc">$</span>filas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="bucles-xapply" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Bucles ‘(X)apply’</h1>
<p><code>(X)apply</code> se refiere en realidad a una familia de funciones que toman una función como entrada y la aplican a una secuencia de objetos (vectores <em>sensu lato</em>). Por lo tanto hay varias funciones <code>(X)apply</code> en R:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">apropos</span>(<span class="st">"apply$"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "apply"      "dendrapply" "eapply"     "kernapply"  "lapply"    
 [6] "mapply"     "rapply"     "sapply"     "tapply"     "vapply"    </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Sin embargo, las más utilizadas son <code>apply</code>,<code>sapply</code>, <code>lapply</code> y<code>tapply</code>. Todos siguen la misma lógica:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/xapply_esp.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p><code>lapply</code> toma un vector (atómico o de lista), aplica una función a cada elemento y devuelve una lista:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>), <span class="at">FUN =</span> sqrt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 2

[[2]]
[1] 3

[[3]]
[1] 4</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p><code>sapply</code> también toma un vector (atómico o de lista) y aplica la función a cada elemento, sin embargo, el resultado es un vector atómico (si es que se puede empaquetar como un vector):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>), <span class="at">FUN =</span> sqrt)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 2

[[2]]
[1] 3

[[3]]
[1] 4</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p><code>apply</code> aplica una función a cada una de las filas o columnas de un objeto bidimensional. Por ejemplo, el siguiente código calcula el promedio para largo y ancho de sépalo en el juego de datos <code>iris</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># promedio de largo y ancho de setalo</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">apply</span>(<span class="at">X =</span> iris[, <span class="fu">c</span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width 
      5.8433       3.0573 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Note que el argumento ‘MARGIN’ indica si el calculo se lleva a cabo a nivel de filas (<code>MARGIN = 1</code>) o columnas (<code>MARGIN = 2</code>).</p>
<p><code>tapply</code> es más específico ya que aplica una función a un subconjunto de datos definido por un vector categórico adicional. Por ejemplo, podemos calcular la longitud promedio de pétalo para cada especie en el juego de datos ‘iris’ de la siguiente manera:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> iris<span class="sc">$</span>Petal.Length, <span class="at">INDEX =</span> iris<span class="sc">$</span>Species, <span class="at">FUN =</span> mean)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    setosa versicolor  virginica 
     1.462      4.260      5.552 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Los bucles <code>(X)apply</code> pueden modificarse para realizar acciones personalizadas creando nuevas funciones (ya sea dentro o fuera del bucle):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># funcion desde fuera del bucle</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>n_filas <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="co"># leer archivo</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(x, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="co"># calcular numero de filas</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>  nrw <span class="ot">&lt;-</span> <span class="fu">nrow</span>(txt)</span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">return</span>(nrw)</span>
<span id="cb35-9"><a href="#cb35-9"></a>}</span>
<span id="cb35-10"><a href="#cb35-10"></a></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="co"># correr bucle</span></span>
<span id="cb35-12"><a href="#cb35-12"></a>filas <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> n_filas)</span>
<span id="cb35-13"><a href="#cb35-13"></a></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="co"># ver resultados</span></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="fu">head</span>(filas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 39

[[2]]
[1] 1

[[3]]
[1] 2

[[4]]
[1] 12

[[5]]
[1] 14

[[6]]
[1] 9</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Note que el resultado es una lista. Si deseamos generar un vector podemos usar el bucle <code>sapply</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># correr bucle</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>filas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> n_filas)</span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="co"># ver resultados</span></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="fu">head</span>(filas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       ./data//2022-09-02_R3-LcamT3-RcamN4_Pel1_2021-09-24_MaxN.TXT 
                                                                 39 
./data//2022-09-03_S6-LB13-RB12_PuntaMariaOeste_2022-03-24_MaxN.TXT 
                                                                  1 
./data//2022-09-03_T4-LB19-RB18_PuntaMariaOeste_2022-03-24_MaxN.TXT 
                                                                  2 
           ./data//2022-09-04_S1-LB10-RN9_Arco2_2022-07-15_MaxN.TXT 
                                                                 12 
        ./data//2022-09-07_P1-LB12-RB13_Gissler_2022-03-30_MaxN.TXT 
                                                                 14 
          ./data//2022-09-11_P1-LB14-RB13_Risco_2022-03-26_MaxN.TXT 
                                                                  9 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos usar funciones anónimas (i.e.&nbsp;funciones que se crean dentro del llamado del bucle) así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># correr bucle</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>filas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb39-3"><a href="#cb39-3"></a>  <span class="fu">nrow</span>(<span class="fu">read.table</span>(x, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>))</span>
<span id="cb39-4"><a href="#cb39-4"></a>})</span>
<span id="cb39-5"><a href="#cb39-5"></a></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="co"># ver resultados</span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="fu">head</span>(filas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       ./data//2022-09-02_R3-LcamT3-RcamN4_Pel1_2021-09-24_MaxN.TXT 
                                                                 39 
./data//2022-09-03_S6-LB13-RB12_PuntaMariaOeste_2022-03-24_MaxN.TXT 
                                                                  1 
./data//2022-09-03_T4-LB19-RB18_PuntaMariaOeste_2022-03-24_MaxN.TXT 
                                                                  2 
           ./data//2022-09-04_S1-LB10-RN9_Arco2_2022-07-15_MaxN.TXT 
                                                                 12 
        ./data//2022-09-07_P1-LB12-RB13_Gissler_2022-03-30_MaxN.TXT 
                                                                 14 
          ./data//2022-09-11_P1-LB14-RB13_Risco_2022-03-26_MaxN.TXT 
                                                                  9 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Tenga en cuenta que:</p>
<ol type="1">
<li><p>en este tipo de bucles no hay retroalimentación de las iteraciones anteriores (es decir, los resultados de una iteración no se pueden ingresar en las iteraciones posteriores)</p></li>
<li><p><code>(X)apply</code> es más limpio que otros bucles porque los objetos creados dentro de ellos no están disponibles en el entorno de trabajo actual.</p></li>
</ol>
<p>&nbsp;</p>
<section id="bucles-replicate" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="bucles-replicate"><span class="header-section-number">3.1</span> bucles <code>replicate</code></h2>
<p>El bucle <code>replicate</code> también pertenece a la familia de los <code>(X)apply</code> (a pesar de su nombre), ya que toma una función y la replica. Sin embargo solo replica una acción (generalmente aleatoria) y el usuario no tiene control sobre el insumo a la función. El argumento ‘n’ define cuantas veces se replica la acción y ‘expr’ define la acción a realizar:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]     [,3]
 [1,] -0.75919  2.123379  0.35639
 [2,] -1.94534 -1.478239 -2.51877
 [3,] -0.28177  1.127031 -0.70940
 [4,]  0.10823 -1.027990 -1.44061
 [5,] -0.33134  0.153722  0.21577
 [6,]  1.00456 -0.994653 -1.46813
 [7,]  0.30925  0.352210  1.42555
 [8,] -1.72841 -0.413025  0.55576
 [9,]  0.54653  0.642674 -1.11939
[10,]  2.03375 -0.089979  0.54550</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Note que los resultados son agrupados en una matrix. ‘expr’ también puede replicar código que no ha sido “empaquetado en una función”.</p>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5"> Ejercicio 2</font></p>
<p>&nbsp;</p>
<p>2.1 Haga un bucle <code>lapply</code> equivalente al bucle <code>for</code> en el ejercicio 1.1.</p>
<p>&nbsp;</p>
<p>2.2 Haga un bucle <code>sapply</code> equivalente al bucle <code>for</code> en el ejercicio 1.1 y ponga el resultado en un cuadro de datos, similiar a lo hecho en el ejercicio 1.2</p>
<p>&nbsp;</p>
<p>2.3 Haga un bucle <code>sapply</code> que permita añadir al cuadro de datos creado en el ejercicio anterior el total de individuos observados en un muestreo (pista: sumatoria de la columna ‘MaxN’).</p>
<p>&nbsp;</p>
<p>2.4 Haga un bucle <code>tapply</code> para calcular el error estandar para el ancho de sépalo por especie en el juego de datos ‘iris’.</p>
</div>
<hr>
<p>&nbsp;</p>
</section>
</section>
<section id="bucles-repeat" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Bucles ‘repeat’</h1>
<p>Los bucles <code>repeat</code> deben cumplir una condición para detenerse. Típicamente el bucle lleva a cabo la acción al menos una vez, independientemente de la evaluación de la condición:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/repeat_esp.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>El siguiente bucle <code>repeat</code> se ejecuta hasta que la correlación de las variables continuas generadas al azar es mayor que un umbral:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># crear vector vacio</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="cf">repeat</span>{</span>
<span id="cb43-5"><a href="#cb43-5"></a>  <span class="co"># generar la variable 1</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb43-7"><a href="#cb43-7"></a></span>
<span id="cb43-8"><a href="#cb43-8"></a>  <span class="co"># generar la variable 2</span></span>
<span id="cb43-9"><a href="#cb43-9"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb43-10"><a href="#cb43-10"></a></span>
<span id="cb43-11"><a href="#cb43-11"></a>  <span class="co"># correr la correlacion</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb43-13"><a href="#cb43-13"></a></span>
<span id="cb43-14"><a href="#cb43-14"></a>  <span class="co"># guardar resultados</span></span>
<span id="cb43-15"><a href="#cb43-15"></a>  cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb43-16"><a href="#cb43-16"></a></span>
<span id="cb43-17"><a href="#cb43-17"></a>  <span class="co"># parar si se cumple la condicion</span></span>
<span id="cb43-18"><a href="#cb43-18"></a>  <span class="cf">if</span> (corr_coef <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="cf">break</span></span>
<span id="cb43-19"><a href="#cb43-19"></a>}</span>
<span id="cb43-20"><a href="#cb43-20"></a></span>
<span id="cb43-21"><a href="#cb43-21"></a><span class="fu">head</span>(cc_vector)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.21762 -0.16681 -0.34826  0.16664 -0.22393  0.34355</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos graficarlo el resultado asi así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> cc_vector, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cc_vector))</span>
<span id="cb45-2"><a href="#cb45-2"></a></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cc, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">col =</span> cols[<span class="dv">4</span>], <span class="at">lwd =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> cols[<span class="dv">8</span>], <span class="at">lwd =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iteraciones"</span>, <span class="at">y =</span> <span class="st">"Correlación de pearson (r)"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="bucles_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La condición determina si el ciclo debe detenerse.</p>
<p>Una característica importante de los bucles <code>while</code>,<code>repeat</code> y <code>for</code> es que pueden tomar resultados de iteraciones anteriores como entrada en iteraciones posteriores. Esto se debe a que los objetos creados dentro de la función se guardan en el entorno actual (a diferencia de los bucles <code>Xapply</code>).</p>
<hr>
<p>&nbsp;</p>
</section>
<section id="bucles-while" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Bucles ‘While’</h1>
<p>Los bucles <code>while</code> aplican una acción en una secuencia de elementos hasta que se cumpla una condición. Son muy parecidos a los bucles <code>repeat</code>. La condición puede evaluar un resultado del propio bucle o una entrada externa:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/while_esp.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co"># iniciar bucle</span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="co"># generar la variable 1</span></span>
<span id="cb46-7"><a href="#cb46-7"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb46-8"><a href="#cb46-8"></a></span>
<span id="cb46-9"><a href="#cb46-9"></a>  <span class="co"># generar la variable 2</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb46-11"><a href="#cb46-11"></a></span>
<span id="cb46-12"><a href="#cb46-12"></a>  <span class="co"># corrrer  la correlacion</span></span>
<span id="cb46-13"><a href="#cb46-13"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb46-14"><a href="#cb46-14"></a></span>
<span id="cb46-15"><a href="#cb46-15"></a>  <span class="co"># imprimir</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">print</span>(corr_coef)</span>
<span id="cb46-17"><a href="#cb46-17"></a>}</span>
<span id="cb46-18"><a href="#cb46-18"></a></span>
<span id="cb46-19"><a href="#cb46-19"></a>corr_coef</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1]  0.0872575  0.3865472  0.1199017 -0.2902941  0.2413406 -0.1667497
 [7]  0.1272541  0.0011283 -0.1344395 -0.0184824  0.5966901</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Con un pequeño ajuste, un bucle <code>while</code> también puede evaluar varias condiciones a la vez. Por ejemplo, también podemos incluir altos valores de correlación negativa:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r numberLines lineAnchors code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="co"># crear vector vacio</span></span>
<span id="cb48-5"><a href="#cb48-5"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> corr_coef <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">0.5</span>) {</span>
<span id="cb48-8"><a href="#cb48-8"></a>  <span class="co"># generar la variable 1</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb48-10"><a href="#cb48-10"></a></span>
<span id="cb48-11"><a href="#cb48-11"></a>  <span class="co"># generar la variable 2</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb48-13"><a href="#cb48-13"></a></span>
<span id="cb48-14"><a href="#cb48-14"></a>  <span class="co"># correr correlacion</span></span>
<span id="cb48-15"><a href="#cb48-15"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb48-16"><a href="#cb48-16"></a></span>
<span id="cb48-17"><a href="#cb48-17"></a>  <span class="co"># guardar resultados</span></span>
<span id="cb48-18"><a href="#cb48-18"></a>  cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb48-19"><a href="#cb48-19"></a>}</span>
<span id="cb48-20"><a href="#cb48-20"></a></span>
<span id="cb48-21"><a href="#cb48-21"></a><span class="fu">head</span>(cc_vector)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.047693  0.232015  0.133767 -0.089900  0.364152  0.203306</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="bucles_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="alert alert-info">
<p><font size="5">Ejercicio 3</font></p>
<p>&nbsp;</p>
<p>3.1 Haga un bucle <code>while</code> que se detenga si la correlación es superior a 0.8 o si el bucle ha estado ejecutándose durante más de 10 segundos (consejo: use la función<code>difftime</code> y/o <code>as.numeric</code>)</p>
<p>&nbsp;</p>
<p>3.2 Haga un bucle <code>repeat</code> que se detenga solo si la correlación es mayor que 0.5 pero menor que 0.55</p>
</div>
<hr>
<section id="referencias" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="referencias"><span class="header-section-number">5.1</span> Referencias</h2>
<ul>
<li><a href="http://adv-r.had.co.nz/Functionals.html">Advanced R, H Wickham</a></li>
<li><a href="https://www.datacamp.com/community/tutorials/tutorial-on-loops-in-r">A Tutorial on Loops in R - Usage and Alternatives, DataCamp</a></li>
</ul>
<hr>
<p><font size="5">Session information</font></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 Patched (2022-11-10 r83330)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_ES.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] RColorBrewer_1.1-3 ggplot2_3.4.3     

loaded via a namespace (and not attached):
 [1] rstudioapi_0.14   knitr_1.42        magrittr_2.0.3    tidyselect_1.2.0 
 [5] munsell_0.5.0     colorspace_2.1-0  R6_2.5.1          rlang_1.1.1      
 [9] fastmap_1.1.1     fansi_1.0.4       dplyr_1.1.0       tools_4.2.2      
[13] grid_4.2.2        gtable_0.3.4      xfun_0.40         utf8_1.2.3       
[17] cli_3.6.1         withr_2.5.0       htmltools_0.5.6   yaml_2.3.7       
[21] digest_0.6.33     tibble_3.2.1      lifecycle_1.0.3   farver_2.1.1     
[25] htmlwidgets_1.5.4 vctrs_0.6.3       glue_1.6.2        evaluate_0.21    
[29] rmarkdown_2.21    labeling_0.4.3    compiler_4.2.2    pillar_1.9.0     
[33] generics_0.1.3    scales_1.2.1      jsonlite_1.8.7    pkgconfig_2.0.3  </code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/marce10\.github\.io\/R_avanzado_2023\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb51" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> &lt;font size="7"&gt;&lt;b&gt;Bucles&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="in">body</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="in">  { counter-reset: source-line 0; }</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="in">pre.numberSource code</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="in">  { counter-reset: none; }</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,echo=FALSE,message=FALSE}</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"digits"</span> <span class="ot">=</span> <span class="dv">5</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"digits.secs"</span> <span class="ot">=</span> <span class="dv">3</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co"># options to customize chunk outputs</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">class.source =</span> <span class="st">"numberLines lineAnchors"</span>, <span class="co"># for code line numbers</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">50</span>))</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="st">"Spectral"</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="fu"># Objetivos del manual {.unnumbered .unlisted}</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aprender a procesar de forma serial operaciones que deben repetirse sobre diferentes objetos</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Familiarizarse con el uso de bucles en la plataforma R</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tener una noción general de los opciones disponibles en R para construir bucles</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>Primero debemos preparar los archivos de ejemplo:</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="co"># definir directorio a donde guardar los archivos</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>directorio <span class="ot">&lt;-</span> <span class="st">"DIRECCION_DONDE_GUARDAR_LOS ARCHIVOS_DE_EJEMPLO"</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar archivos</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="fu">paste0</span>(</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://github.com/maRce10/ucr_r_avanzado/"</span>,</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"raw/master/additional_files/datos_camara_submarina.zip"</span></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">"datos_camara_submarina.zip"</span>)</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="co"># extraerlos del zip</span></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">zipfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">"datos_camara_submarina.zip"</span>),</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">exdir =</span> directorio</span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer vector con nombre y direccion de archivos</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>archivos_txt <span class="ot">&lt;-</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">path =</span> directorio,</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">full.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"TXT$"</span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="co"># definir directorio a donde guardar los archivos</span></span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a>directorio <span class="ot">&lt;-</span> <span class="st">"./data/"</span></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a><span class="co"># guardar archivos</span></span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(</span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span></span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://github.com/maRce10/"</span>,</span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a>      <span class="st">"r_avanzado_2023/raw/master/data/datos_camara_submarina.zip"</span></span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">destfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">"datos_camara_submarina.zip"</span>)</span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a><span class="co"># extraerlos del zip</span></span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="at">zipfile =</span> <span class="fu">file.path</span>(directorio, <span class="st">"datos_camara_submarina.zip"</span>), <span class="at">exdir =</span> directorio)</span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a><span class="co"># hacer vector con nombre y direccion de archivos</span></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a>archivos_txt <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> directorio, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">pattern =</span> <span class="st">"TXT$"</span>)</span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a>También pueden bajar el archivo directamente de <span class="co">[</span><span class="ot">este enlance</span><span class="co">](https://github.com/maRce10/ucr_r_avanzado/raw/master/additional_files/datos_camara_submarina.zip)</span>. Recuerde extraer los archivos y hacer el vector con los nombres de los archivos (correr lineas de la 9 a la 13).</span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-101"><a href="#cb51-101" aria-hidden="true" tabindex="-1"></a>Si todo salió bien el vector "archivos_txt" deberia tener <span class="in">`r length(archivos_txt)`</span> elementos:</span>
<span id="cb51-102"><a href="#cb51-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-105"><a href="#cb51-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-106"><a href="#cb51-106" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(archivos_txt)</span>
<span id="cb51-107"><a href="#cb51-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-108"><a href="#cb51-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-109"><a href="#cb51-109" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-110"><a href="#cb51-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-111"><a href="#cb51-111" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-112"><a href="#cb51-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-113"><a href="#cb51-113" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bucles (loops)</span></span>
<span id="cb51-114"><a href="#cb51-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-115"><a href="#cb51-115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Proceso automatizado de varios pasos organizado como secuencias de acciones (p. Ej., procesos 'por lotes')</span>
<span id="cb51-116"><a href="#cb51-116" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Se usa para acelerar los procedimientos en los que se aplica la misma acción a muchos objetos (similares)</span>
<span id="cb51-117"><a href="#cb51-117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Crítico para la gestión de grandes bases de datos ('big data', y buenas prácticas de programación)</span>
<span id="cb51-118"><a href="#cb51-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-119"><a href="#cb51-119" aria-hidden="true" tabindex="-1"></a>2 tipos básicos:</span>
<span id="cb51-120"><a href="#cb51-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-121"><a href="#cb51-121" aria-hidden="true" tabindex="-1"></a>1)  Ejecutar para un número predefinido de iteraciones (es decir, tiempos). Estos se subdividen en dos clases:</span>
<span id="cb51-122"><a href="#cb51-122" aria-hidden="true" tabindex="-1"></a>    a.  Los resultados pueden ingresarse nuevamente en la siguiente iteración (bucles <span class="in">`for`</span>)</span>
<span id="cb51-123"><a href="#cb51-123" aria-hidden="true" tabindex="-1"></a>    b.  Los resultados de una interacción no pueden afectar a otras iteraciones (<span class="in">`(X)apply`</span>)</span>
<span id="cb51-124"><a href="#cb51-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-125"><a href="#cb51-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="70%", fig.align="center"}</span></span>
<span id="cb51-126"><a href="#cb51-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-127"><a href="#cb51-127" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/loops2_esp.png"</span>)</span>
<span id="cb51-128"><a href="#cb51-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-129"><a href="#cb51-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-130"><a href="#cb51-130" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-131"><a href="#cb51-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-132"><a href="#cb51-132" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">"2"</span><span class="kw">&gt;</span> <span class="sc">\*</span> Modificado de <span class="kw">&lt;i&gt;</span> Tutorial de bucles Datacamp <span class="kw">&lt;/i&gt;</span> <span class="kw">&lt;/font&gt;</span></span>
<span id="cb51-133"><a href="#cb51-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-134"><a href="#cb51-134" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-135"><a href="#cb51-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-136"><a href="#cb51-136" aria-hidden="true" tabindex="-1"></a>2)  Ejecutar hasta que se cumpla una condición predefinida (bucles <span class="in">`while`</span> y<span class="in">`repeat`</span>)</span>
<span id="cb51-137"><a href="#cb51-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-138"><a href="#cb51-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="70%", fig.align="center"}</span></span>
<span id="cb51-139"><a href="#cb51-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-140"><a href="#cb51-140" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/loops1_esp.png"</span>)</span>
<span id="cb51-141"><a href="#cb51-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-142"><a href="#cb51-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-143"><a href="#cb51-143" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-144"><a href="#cb51-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-145"><a href="#cb51-145" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-146"><a href="#cb51-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-147"><a href="#cb51-147" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bucles 'for'</span></span>
<span id="cb51-148"><a href="#cb51-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-149"><a href="#cb51-149" aria-hidden="true" tabindex="-1"></a>Por mucho, <span class="in">`for`</span> es el bucle más popular. Se caracteriza por que el número de iteraciones se puede determinar de antemano y las iteraciones pueden tomar en cuenta resultados de iteraciones anteriores:</span>
<span id="cb51-150"><a href="#cb51-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-151"><a href="#cb51-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="40%", fig.align="center"}</span></span>
<span id="cb51-152"><a href="#cb51-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-153"><a href="#cb51-153" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/for_esp.png"</span>)</span>
<span id="cb51-154"><a href="#cb51-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-155"><a href="#cb51-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-156"><a href="#cb51-156" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-157"><a href="#cb51-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-158"><a href="#cb51-158" aria-hidden="true" tabindex="-1"></a>El bucle <span class="in">`for`</span> se inicia con el operador <span class="in">`for`</span>. A este se le da un vector (*sensu lato*: lista o vector atómico) sobre el cual repetir una tarea. La tarea se encuentra en el cuerpo del bucle:</span>
<span id="cb51-159"><a href="#cb51-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-162"><a href="#cb51-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-163"><a href="#cb51-163" aria-hidden="true" tabindex="-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb51-164"><a href="#cb51-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-165"><a href="#cb51-165" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) { <span class="co"># inicio del bucle</span></span>
<span id="cb51-166"><a href="#cb51-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-167"><a href="#cb51-167" aria-hidden="true" tabindex="-1"></a>} <span class="co"># cuerpo del bucle</span></span>
<span id="cb51-168"><a href="#cb51-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-169"><a href="#cb51-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-170"><a href="#cb51-170" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-171"><a href="#cb51-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-172"><a href="#cb51-172" aria-hidden="true" tabindex="-1"></a>Note que en dentro de los paréntesis del operador <span class="in">`for`</span> se usa el operador <span class="in">`in`</span>. Este denota el nombre de objeto que se usará en el cuerpo del bucle para asignar los velores del vector. El bucle devuelve 3 valores, uno para cada valor en <span class="in">`vctr`</span>.</span>
<span id="cb51-173"><a href="#cb51-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-174"><a href="#cb51-174" aria-hidden="true" tabindex="-1"></a>Una forma mas clara de demostrar como el bucle repite la acción de forma serial sobre cada elemento del vector es añadiendo pausas entre iteraciones. La función <span class="in">`Sys.sleep()`</span> pausa el código de R por el número de segundos que se le defina:</span>
<span id="cb51-175"><a href="#cb51-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-178"><a href="#cb51-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-179"><a href="#cb51-179" aria-hidden="true" tabindex="-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb51-180"><a href="#cb51-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-181"><a href="#cb51-181" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) { <span class="co"># inicio del bucle</span></span>
<span id="cb51-182"><a href="#cb51-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"# corriendo iteración"</span>, i))</span>
<span id="cb51-183"><a href="#cb51-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>) <span class="co"># pausar 2 segundos</span></span>
<span id="cb51-184"><a href="#cb51-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i<span class="sc">^</span><span class="dv">2</span>) <span class="co"># cuerpo del bucle</span></span>
<span id="cb51-185"><a href="#cb51-185" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-186"><a href="#cb51-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-187"><a href="#cb51-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-188"><a href="#cb51-188" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-189"><a href="#cb51-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-190"><a href="#cb51-190" aria-hidden="true" tabindex="-1"></a>En este caso vemos como el bucle toma una pausa entre cada iteración y luego hace el cálculo (cuando corre el código en su computadora).</span>
<span id="cb51-191"><a href="#cb51-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-192"><a href="#cb51-192" aria-hidden="true" tabindex="-1"></a>Si deseamos guardar el resultado de las operaciones debemos añadirlo a un vector vacío. Para hacer esto hay 2 opciones:</span>
<span id="cb51-193"><a href="#cb51-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-194"><a href="#cb51-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Usando la función <span class="in">`append()`</span></span>
<span id="cb51-195"><a href="#cb51-195" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Agregar nuevos elementos a un vector usando indexación</span>
<span id="cb51-196"><a href="#cb51-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-197"><a href="#cb51-197" aria-hidden="true" tabindex="-1"></a>El siguiente código guarda los resultados usando <span class="in">`append()`</span>:</span>
<span id="cb51-198"><a href="#cb51-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-201"><a href="#cb51-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-202"><a href="#cb51-202" aria-hidden="true" tabindex="-1"></a><span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb51-203"><a href="#cb51-203" aria-hidden="true" tabindex="-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb51-204"><a href="#cb51-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-205"><a href="#cb51-205" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-206"><a href="#cb51-206" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-207"><a href="#cb51-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-208"><a href="#cb51-208" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-209"><a href="#cb51-209" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb51-210"><a href="#cb51-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb51-211"><a href="#cb51-211" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-212"><a href="#cb51-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-213"><a href="#cb51-213" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-214"><a href="#cb51-214" aria-hidden="true" tabindex="-1"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, i2)</span>
<span id="cb51-215"><a href="#cb51-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-216"><a href="#cb51-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-217"><a href="#cb51-217" aria-hidden="true" tabindex="-1"></a><span class="co"># ver resultados</span></span>
<span id="cb51-218"><a href="#cb51-218" aria-hidden="true" tabindex="-1"></a>resultados</span>
<span id="cb51-219"><a href="#cb51-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-220"><a href="#cb51-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-221"><a href="#cb51-221" aria-hidden="true" tabindex="-1"></a>Note que <span class="in">`append()`</span> se usa dentro del cuerpo del bucle luego de hacer los cálculos.</span>
<span id="cb51-222"><a href="#cb51-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-223"><a href="#cb51-223" aria-hidden="true" tabindex="-1"></a>Así podemos guardar los resultados usando indexación:</span>
<span id="cb51-224"><a href="#cb51-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-227"><a href="#cb51-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-228"><a href="#cb51-228" aria-hidden="true" tabindex="-1"></a><span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb51-229"><a href="#cb51-229" aria-hidden="true" tabindex="-1"></a>vctr <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb51-230"><a href="#cb51-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-231"><a href="#cb51-231" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-232"><a href="#cb51-232" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-233"><a href="#cb51-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-234"><a href="#cb51-234" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-235"><a href="#cb51-235" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb51-236"><a href="#cb51-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb51-237"><a href="#cb51-237" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> i<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb51-238"><a href="#cb51-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-239"><a href="#cb51-239" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-240"><a href="#cb51-240" aria-hidden="true" tabindex="-1"></a>  resultados[<span class="fu">length</span>(resultados) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> i2</span>
<span id="cb51-241"><a href="#cb51-241" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-242"><a href="#cb51-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-243"><a href="#cb51-243" aria-hidden="true" tabindex="-1"></a>resultados</span>
<span id="cb51-244"><a href="#cb51-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-245"><a href="#cb51-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-246"><a href="#cb51-246" aria-hidden="true" tabindex="-1"></a>Estos bucles se pueden correr sobre cualquier vector. Por ejemplo podemos evaluar para el juego de datos <span class="in">`iris`</span> el promedio del largo del sépalo para cada especie de esta forma:</span>
<span id="cb51-247"><a href="#cb51-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-250"><a href="#cb51-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-251"><a href="#cb51-251" aria-hidden="true" tabindex="-1"></a><span class="co"># vector sobre el cual iterar el bucle</span></span>
<span id="cb51-252"><a href="#cb51-252" aria-hidden="true" tabindex="-1"></a>vctr <span class="ot">&lt;-</span> <span class="fu">unique</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb51-253"><a href="#cb51-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-254"><a href="#cb51-254" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-255"><a href="#cb51-255" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-256"><a href="#cb51-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-257"><a href="#cb51-257" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-258"><a href="#cb51-258" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> vctr) {</span>
<span id="cb51-259"><a href="#cb51-259" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cuerpo del bucle</span></span>
<span id="cb51-260"><a href="#cb51-260" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">max</span>(iris<span class="sc">$</span>Sepal.Length[iris<span class="sc">$</span>Species <span class="sc">==</span> i])</span>
<span id="cb51-261"><a href="#cb51-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-262"><a href="#cb51-262" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-263"><a href="#cb51-263" aria-hidden="true" tabindex="-1"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, i2)</span>
<span id="cb51-264"><a href="#cb51-264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-265"><a href="#cb51-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-266"><a href="#cb51-266" aria-hidden="true" tabindex="-1"></a><span class="co"># añadir nombre de especies</span></span>
<span id="cb51-267"><a href="#cb51-267" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(resultados) <span class="ot">&lt;-</span> vctr</span>
<span id="cb51-268"><a href="#cb51-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-269"><a href="#cb51-269" aria-hidden="true" tabindex="-1"></a>resultados</span>
<span id="cb51-270"><a href="#cb51-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-271"><a href="#cb51-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-272"><a href="#cb51-272" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-273"><a href="#cb51-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-274"><a href="#cb51-274" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aplicación al manejo de datos</span></span>
<span id="cb51-275"><a href="#cb51-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-276"><a href="#cb51-276" aria-hidden="true" tabindex="-1"></a>Usaremos los datos de ejemplo que bajamos al inicio del manual para demostrar la utilidad del los bucles en el manejo de datos. Estos datos muestran la salida de un programa de identificación automática de especies marinas en videos pasivos tomados en la columna de agua. Para cada video analizado el programa genera un archivo de texto (.TXT) con una fila para cada especie detectada mas una serie de metadatos asociados a la detección. Los datos se ven así:</span>
<span id="cb51-277"><a href="#cb51-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-278"><a href="#cb51-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="100%", fig.align="center"}</span></span>
<span id="cb51-279"><a href="#cb51-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-280"><a href="#cb51-280" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/datos.png"</span>)</span>
<span id="cb51-281"><a href="#cb51-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-282"><a href="#cb51-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-283"><a href="#cb51-283" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-284"><a href="#cb51-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-285"><a href="#cb51-285" aria-hidden="true" tabindex="-1"></a>Recordemos que los nombres de los archivos .TXT están guardados en un vector llamado <span class="in">`archivos_txt`</span>. Podemos leer el primer archivo (i.e. el primer elemento en <span class="in">`archivos_txt`</span>) de la siguiente forma:</span>
<span id="cb51-286"><a href="#cb51-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-289"><a href="#cb51-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-290"><a href="#cb51-290" aria-hidden="true" tabindex="-1"></a>archivo1 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(archivos_txt[<span class="dv">1</span>], <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-291"><a href="#cb51-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-292"><a href="#cb51-292" aria-hidden="true" tabindex="-1"></a><span class="co"># ver pirmeras 4 filas y 8 columnas</span></span>
<span id="cb51-293"><a href="#cb51-293" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(archivo1[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb51-294"><a href="#cb51-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-295"><a href="#cb51-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-296"><a href="#cb51-296" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-297"><a href="#cb51-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-298"><a href="#cb51-298" aria-hidden="true" tabindex="-1"></a>Podemos saber cuantas especies se observaron en ese muestreo simplemente calculado el número de filas en <span class="in">`archivo`</span>:</span>
<span id="cb51-299"><a href="#cb51-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-302"><a href="#cb51-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-303"><a href="#cb51-303" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(archivo1)</span>
<span id="cb51-304"><a href="#cb51-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-305"><a href="#cb51-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-306"><a href="#cb51-306" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-307"><a href="#cb51-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-308"><a href="#cb51-308" aria-hidden="true" tabindex="-1"></a>Ahora, para hacer esto con todos los archivos **no es eficiente leer cada uno en su propia linea de código** y luego calcular el número de filas. Al fin de cuentas, todos los códigos serian muy parecidos, solo cambiaría el nombre del archivo. Es en estos casos que los bucles son de gran utilidad. En este ejemplo solo debemos incorporar el código de lectura del archivo y del cálculo del número de filas en el cuerpo del bucle, usando el nombre de los archivos (<span class="in">`archivos_txt`</span>) como el vector sobre el cual iterar el bucle:</span>
<span id="cb51-309"><a href="#cb51-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-312"><a href="#cb51-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-313"><a href="#cb51-313" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-314"><a href="#cb51-314" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-315"><a href="#cb51-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-316"><a href="#cb51-316" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-317"><a href="#cb51-317" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb51-318"><a href="#cb51-318" aria-hidden="true" tabindex="-1"></a>  <span class="co"># leer archivo</span></span>
<span id="cb51-319"><a href="#cb51-319" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-320"><a href="#cb51-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcular numero de filas</span></span>
<span id="cb51-321"><a href="#cb51-321" aria-hidden="true" tabindex="-1"></a>  nrw <span class="ot">&lt;-</span> <span class="fu">nrow</span>(txt)</span>
<span id="cb51-322"><a href="#cb51-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-323"><a href="#cb51-323" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-324"><a href="#cb51-324" aria-hidden="true" tabindex="-1"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, nrw)</span>
<span id="cb51-325"><a href="#cb51-325" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-326"><a href="#cb51-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-327"><a href="#cb51-327" aria-hidden="true" tabindex="-1"></a>resultados</span>
<span id="cb51-328"><a href="#cb51-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-329"><a href="#cb51-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-330"><a href="#cb51-330" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-331"><a href="#cb51-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-332"><a href="#cb51-332" aria-hidden="true" tabindex="-1"></a>Podemos ordenar estos resultados fácilmente haciendo un cuadro de datos (data.frame). Para esto creamos una columna con el nombre del archivo y otra con el resultado del número de filas:</span>
<span id="cb51-333"><a href="#cb51-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-336"><a href="#cb51-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-337"><a href="#cb51-337" aria-hidden="true" tabindex="-1"></a><span class="co"># organizar en data frame</span></span>
<span id="cb51-338"><a href="#cb51-338" aria-hidden="true" tabindex="-1"></a>n_filas_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">archivo =</span> <span class="fu">basename</span>(archivos_txt), <span class="at">filas =</span> resultados)</span>
<span id="cb51-339"><a href="#cb51-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-340"><a href="#cb51-340" aria-hidden="true" tabindex="-1"></a><span class="co"># ver primeras 6 filas</span></span>
<span id="cb51-341"><a href="#cb51-341" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(n_filas_df)</span>
<span id="cb51-342"><a href="#cb51-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-343"><a href="#cb51-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-344"><a href="#cb51-344" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb51-345"><a href="#cb51-345" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">"5"</span><span class="kw">&gt;</span> Ejercicio 1 <span class="kw">&lt;/font&gt;</span></span>
<span id="cb51-346"><a href="#cb51-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-347"><a href="#cb51-347" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-348"><a href="#cb51-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-349"><a href="#cb51-349" aria-hidden="true" tabindex="-1"></a>Podemos calcular el número de familias observadas para el primer archivo que leímos (<span class="in">`archivo1`</span>) de esta forma:</span>
<span id="cb51-350"><a href="#cb51-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-353"><a href="#cb51-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-354"><a href="#cb51-354" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(archivo1<span class="sc">$</span>Family))</span>
<span id="cb51-355"><a href="#cb51-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-356"><a href="#cb51-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-357"><a href="#cb51-357" aria-hidden="true" tabindex="-1"></a>1.1 Haga un bucle <span class="in">`for`</span> que devuelva el número de familias para cada archivo</span>
<span id="cb51-358"><a href="#cb51-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-359"><a href="#cb51-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb51-360"><a href="#cb51-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-361"><a href="#cb51-361" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-362"><a href="#cb51-362" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-363"><a href="#cb51-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-364"><a href="#cb51-364" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-365"><a href="#cb51-365" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb51-366"><a href="#cb51-366" aria-hidden="true" tabindex="-1"></a>  <span class="co"># leer archivo</span></span>
<span id="cb51-367"><a href="#cb51-367" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-368"><a href="#cb51-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-369"><a href="#cb51-369" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcular numero de familias</span></span>
<span id="cb51-370"><a href="#cb51-370" aria-hidden="true" tabindex="-1"></a>  nfam <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(txt<span class="sc">$</span>Family))</span>
<span id="cb51-371"><a href="#cb51-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-372"><a href="#cb51-372" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-373"><a href="#cb51-373" aria-hidden="true" tabindex="-1"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, nfam)</span>
<span id="cb51-374"><a href="#cb51-374" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-375"><a href="#cb51-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-376"><a href="#cb51-376" aria-hidden="true" tabindex="-1"></a>n_filas_df<span class="sc">$</span>familias <span class="ot">&lt;-</span> resultados</span>
<span id="cb51-377"><a href="#cb51-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-378"><a href="#cb51-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-379"><a href="#cb51-379" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-380"><a href="#cb51-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-381"><a href="#cb51-381" aria-hidden="true" tabindex="-1"></a>1.2 Cree un cuadro de datos (data frame) que contenga dos columnas, una para el nombre del archivo y otra para el número de familias</span>
<span id="cb51-382"><a href="#cb51-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-383"><a href="#cb51-383" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-384"><a href="#cb51-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-385"><a href="#cb51-385" aria-hidden="true" tabindex="-1"></a>1.3 Añada una columna al cuadro de datos creado en el ejercicio anterior indicando la fecha de creación del video (esta información se encuentra en la columna 'Date' de cada archivo de texto). Note que cada archivo contiene solamente una fecha. Debe usar un bucle <span class="in">`for`</span> para extraer esta información de los archivos.</span>
<span id="cb51-386"><a href="#cb51-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-387"><a href="#cb51-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb51-388"><a href="#cb51-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-389"><a href="#cb51-389" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-390"><a href="#cb51-390" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb51-391"><a href="#cb51-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-392"><a href="#cb51-392" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-393"><a href="#cb51-393" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb51-394"><a href="#cb51-394" aria-hidden="true" tabindex="-1"></a>  <span class="co"># leer archivo</span></span>
<span id="cb51-395"><a href="#cb51-395" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-396"><a href="#cb51-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-397"><a href="#cb51-397" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar fecha</span></span>
<span id="cb51-398"><a href="#cb51-398" aria-hidden="true" tabindex="-1"></a>  fecha <span class="ot">&lt;-</span> txt<span class="sc">$</span>Date[<span class="dv">1</span>]</span>
<span id="cb51-399"><a href="#cb51-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-400"><a href="#cb51-400" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-401"><a href="#cb51-401" aria-hidden="true" tabindex="-1"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, fecha)</span>
<span id="cb51-402"><a href="#cb51-402" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-403"><a href="#cb51-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-404"><a href="#cb51-404" aria-hidden="true" tabindex="-1"></a>n_filas_df<span class="sc">$</span>fecha <span class="ot">&lt;-</span> resultados</span>
<span id="cb51-405"><a href="#cb51-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-406"><a href="#cb51-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-407"><a href="#cb51-407" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-408"><a href="#cb51-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-409"><a href="#cb51-409" aria-hidden="true" tabindex="-1"></a>1.4 Añada una columna al cuadro de datos creado en el ejercicio 1.2 (y modificado en 1.3) indicando la profundidad a la que se grabó el video. Debe usar un bucle <span class="in">`for`</span> para extraer esta información de los archivos.</span>
<span id="cb51-410"><a href="#cb51-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-411"><a href="#cb51-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb51-412"><a href="#cb51-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-413"><a href="#cb51-413" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">vector</span>() <span class="co"># vector vacio</span></span>
<span id="cb51-414"><a href="#cb51-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-415"><a href="#cb51-415" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) { <span class="co"># inicio del bucle</span></span>
<span id="cb51-416"><a href="#cb51-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-417"><a href="#cb51-417" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) <span class="co"># leer archivo</span></span>
<span id="cb51-418"><a href="#cb51-418" aria-hidden="true" tabindex="-1"></a>  prof <span class="ot">&lt;-</span> txt<span class="sc">$</span>Depth[<span class="dv">1</span>] <span class="co"># calcular numero de familias</span></span>
<span id="cb51-419"><a href="#cb51-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-420"><a href="#cb51-420" aria-hidden="true" tabindex="-1"></a>  resultados <span class="ot">&lt;-</span> <span class="fu">append</span>(resultados, prof) <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-421"><a href="#cb51-421" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-422"><a href="#cb51-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-423"><a href="#cb51-423" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" m"</span>, <span class="st">""</span>, resultados)</span>
<span id="cb51-424"><a href="#cb51-424" aria-hidden="true" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">,"</span>, <span class="st">"."</span>, resultados)</span>
<span id="cb51-425"><a href="#cb51-425" aria-hidden="true" tabindex="-1"></a>n_filas_df<span class="sc">$</span>profundidad <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(resultados)</span>
<span id="cb51-426"><a href="#cb51-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-427"><a href="#cb51-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-428"><a href="#cb51-428" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-429"><a href="#cb51-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-430"><a href="#cb51-430" aria-hidden="true" tabindex="-1"></a>Puede usar el siguiente código para convertir profundidad a un vector numérico:</span>
<span id="cb51-431"><a href="#cb51-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-432"><a href="#cb51-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb51-433"><a href="#cb51-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-434"><a href="#cb51-434" aria-hidden="true" tabindex="-1"></a>n_filas_df<span class="sc">$</span>profundidad <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" m"</span>, <span class="st">""</span>, <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">,"</span>, <span class="st">"."</span>, n_filas_df<span class="sc">$</span>profundidad))</span>
<span id="cb51-435"><a href="#cb51-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-436"><a href="#cb51-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-437"><a href="#cb51-437" aria-hidden="true" tabindex="-1"></a>1.5 ¿Cuál es la correlación entre el número de especies observadas (que es igual al número de filas) y la profundidad? (pista: <span class="in">`cor.test()`</span>)</span>
<span id="cb51-438"><a href="#cb51-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-439"><a href="#cb51-439" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-440"><a href="#cb51-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-441"><a href="#cb51-441" aria-hidden="true" tabindex="-1"></a>1.6 ¿Cuál es la correlación entre el número de familias y la profundidad?</span>
<span id="cb51-442"><a href="#cb51-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-443"><a href="#cb51-443" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-444"><a href="#cb51-444" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb51-445"><a href="#cb51-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-446"><a href="#cb51-446" aria-hidden="true" tabindex="-1"></a>El bucle <span class="in">`for`</span> también puede ser usado para juntar todas los datos de los archivos de texto en un solo cuadro de datos. Esto lo podemos hacer "rellenando" un cuadro de datos vacío, de forma análoga a como rellenamos un vector vació anteriormente:</span>
<span id="cb51-447"><a href="#cb51-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-448"><a href="#cb51-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE}</span></span>
<span id="cb51-449"><a href="#cb51-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-450"><a href="#cb51-450" aria-hidden="true" tabindex="-1"></a><span class="co"># vector vacio</span></span>
<span id="cb51-451"><a href="#cb51-451" aria-hidden="true" tabindex="-1"></a>df_resultados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb51-452"><a href="#cb51-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-453"><a href="#cb51-453" aria-hidden="true" tabindex="-1"></a><span class="co"># inicio del bucle</span></span>
<span id="cb51-454"><a href="#cb51-454" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> archivos_txt) {</span>
<span id="cb51-455"><a href="#cb51-455" aria-hidden="true" tabindex="-1"></a>  <span class="co"># leer archivo</span></span>
<span id="cb51-456"><a href="#cb51-456" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(i, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-457"><a href="#cb51-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-458"><a href="#cb51-458" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados en vector vacio</span></span>
<span id="cb51-459"><a href="#cb51-459" aria-hidden="true" tabindex="-1"></a>  df_resultados <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_resultados, txt)</span>
<span id="cb51-460"><a href="#cb51-460" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-461"><a href="#cb51-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-462"><a href="#cb51-462" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_resultados) <span class="sc">==</span> <span class="fu">sum</span>(n_filas_df<span class="sc">$</span>filas)</span>
<span id="cb51-463"><a href="#cb51-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-464"><a href="#cb51-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-465"><a href="#cb51-465" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-466"><a href="#cb51-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-467"><a href="#cb51-467" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bucles '(X)apply'</span></span>
<span id="cb51-468"><a href="#cb51-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-469"><a href="#cb51-469" aria-hidden="true" tabindex="-1"></a><span class="in">`(X)apply`</span> se refiere en realidad a una familia de funciones que toman una función como entrada y la aplican a una secuencia de objetos (vectores *sensu lato*). Por lo tanto hay varias funciones <span class="in">`(X)apply`</span> en R:</span>
<span id="cb51-470"><a href="#cb51-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-473"><a href="#cb51-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-474"><a href="#cb51-474" aria-hidden="true" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">"apply$"</span>)</span>
<span id="cb51-475"><a href="#cb51-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-476"><a href="#cb51-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-477"><a href="#cb51-477" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-478"><a href="#cb51-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-479"><a href="#cb51-479" aria-hidden="true" tabindex="-1"></a>Sin embargo, las más utilizadas son <span class="in">`apply`</span>,<span class="in">`sapply`</span>, <span class="in">`lapply`</span> y<span class="in">`tapply`</span>. Todos siguen la misma lógica:</span>
<span id="cb51-480"><a href="#cb51-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-481"><a href="#cb51-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="40%", fig.align="center"}</span></span>
<span id="cb51-482"><a href="#cb51-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-483"><a href="#cb51-483" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/xapply_esp.png"</span>)</span>
<span id="cb51-484"><a href="#cb51-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-485"><a href="#cb51-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-486"><a href="#cb51-486" aria-hidden="true" tabindex="-1"></a><span class="in">`lapply`</span> toma un vector (atómico o de lista), aplica una función a cada elemento y devuelve una lista:</span>
<span id="cb51-487"><a href="#cb51-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-488"><a href="#cb51-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb51-489"><a href="#cb51-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-490"><a href="#cb51-490" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>), <span class="at">FUN =</span> sqrt)</span>
<span id="cb51-491"><a href="#cb51-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-492"><a href="#cb51-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-493"><a href="#cb51-493" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-494"><a href="#cb51-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-495"><a href="#cb51-495" aria-hidden="true" tabindex="-1"></a><span class="in">`sapply`</span> también toma un vector (atómico o de lista) y aplica la función a cada elemento, sin embargo, el resultado es un vector atómico (si es que se puede empaquetar como un vector):</span>
<span id="cb51-496"><a href="#cb51-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-497"><a href="#cb51-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb51-498"><a href="#cb51-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-499"><a href="#cb51-499" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">16</span>), <span class="at">FUN =</span> sqrt)</span>
<span id="cb51-500"><a href="#cb51-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-501"><a href="#cb51-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-502"><a href="#cb51-502" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-503"><a href="#cb51-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-504"><a href="#cb51-504" aria-hidden="true" tabindex="-1"></a><span class="in">`apply`</span> aplica una función a cada una de las filas o columnas de un objeto bidimensional. Por ejemplo, el siguiente código calcula el promedio para largo y ancho de sépalo en el juego de datos <span class="in">`iris`</span>:</span>
<span id="cb51-505"><a href="#cb51-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-508"><a href="#cb51-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-509"><a href="#cb51-509" aria-hidden="true" tabindex="-1"></a><span class="co"># promedio de largo y ancho de setalo</span></span>
<span id="cb51-510"><a href="#cb51-510" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> iris[, <span class="fu">c</span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>)], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb51-511"><a href="#cb51-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-512"><a href="#cb51-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-513"><a href="#cb51-513" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-514"><a href="#cb51-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-515"><a href="#cb51-515" aria-hidden="true" tabindex="-1"></a>Note que el argumento 'MARGIN' indica si el calculo se lleva a cabo a nivel de filas (<span class="in">`MARGIN = 1`</span>) o columnas (<span class="in">`MARGIN = 2`</span>).</span>
<span id="cb51-516"><a href="#cb51-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-517"><a href="#cb51-517" aria-hidden="true" tabindex="-1"></a><span class="in">`tapply`</span> es más específico ya que aplica una función a un subconjunto de datos definido por un vector categórico adicional. Por ejemplo, podemos calcular la longitud promedio de pétalo para cada especie en el juego de datos 'iris' de la siguiente manera:</span>
<span id="cb51-518"><a href="#cb51-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-519"><a href="#cb51-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=T, echo=T}</span></span>
<span id="cb51-520"><a href="#cb51-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-521"><a href="#cb51-521" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(<span class="at">X =</span> iris<span class="sc">$</span>Petal.Length, <span class="at">INDEX =</span> iris<span class="sc">$</span>Species, <span class="at">FUN =</span> mean)</span>
<span id="cb51-522"><a href="#cb51-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-523"><a href="#cb51-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-524"><a href="#cb51-524" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-525"><a href="#cb51-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-526"><a href="#cb51-526" aria-hidden="true" tabindex="-1"></a>Los bucles <span class="in">`(X)apply`</span> pueden modificarse para realizar acciones personalizadas creando nuevas funciones (ya sea dentro o fuera del bucle):</span>
<span id="cb51-527"><a href="#cb51-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-528"><a href="#cb51-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb51-529"><a href="#cb51-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-530"><a href="#cb51-530" aria-hidden="true" tabindex="-1"></a><span class="co"># funcion desde fuera del bucle</span></span>
<span id="cb51-531"><a href="#cb51-531" aria-hidden="true" tabindex="-1"></a>n_filas <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb51-532"><a href="#cb51-532" aria-hidden="true" tabindex="-1"></a>  <span class="co"># leer archivo</span></span>
<span id="cb51-533"><a href="#cb51-533" aria-hidden="true" tabindex="-1"></a>  txt <span class="ot">&lt;-</span> <span class="fu">read.table</span>(x, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb51-534"><a href="#cb51-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-535"><a href="#cb51-535" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcular numero de filas</span></span>
<span id="cb51-536"><a href="#cb51-536" aria-hidden="true" tabindex="-1"></a>  nrw <span class="ot">&lt;-</span> <span class="fu">nrow</span>(txt)</span>
<span id="cb51-537"><a href="#cb51-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(nrw)</span>
<span id="cb51-538"><a href="#cb51-538" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-539"><a href="#cb51-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-540"><a href="#cb51-540" aria-hidden="true" tabindex="-1"></a><span class="co"># correr bucle</span></span>
<span id="cb51-541"><a href="#cb51-541" aria-hidden="true" tabindex="-1"></a>filas <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> n_filas)</span>
<span id="cb51-542"><a href="#cb51-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-543"><a href="#cb51-543" aria-hidden="true" tabindex="-1"></a><span class="co"># ver resultados</span></span>
<span id="cb51-544"><a href="#cb51-544" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filas)</span>
<span id="cb51-545"><a href="#cb51-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-546"><a href="#cb51-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-547"><a href="#cb51-547" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-548"><a href="#cb51-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-549"><a href="#cb51-549" aria-hidden="true" tabindex="-1"></a>Note que el resultado es una lista. Si deseamos generar un vector podemos usar el bucle <span class="in">`sapply`</span>:</span>
<span id="cb51-550"><a href="#cb51-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-551"><a href="#cb51-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb51-552"><a href="#cb51-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-553"><a href="#cb51-553" aria-hidden="true" tabindex="-1"></a><span class="co"># correr bucle</span></span>
<span id="cb51-554"><a href="#cb51-554" aria-hidden="true" tabindex="-1"></a>filas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> n_filas)</span>
<span id="cb51-555"><a href="#cb51-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-556"><a href="#cb51-556" aria-hidden="true" tabindex="-1"></a><span class="co"># ver resultados</span></span>
<span id="cb51-557"><a href="#cb51-557" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filas)</span>
<span id="cb51-558"><a href="#cb51-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-559"><a href="#cb51-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-560"><a href="#cb51-560" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-561"><a href="#cb51-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-562"><a href="#cb51-562" aria-hidden="true" tabindex="-1"></a>Podemos usar funciones anónimas (i.e. funciones que se crean dentro del llamado del bucle) así:</span>
<span id="cb51-563"><a href="#cb51-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-564"><a href="#cb51-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb51-565"><a href="#cb51-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-566"><a href="#cb51-566" aria-hidden="true" tabindex="-1"></a><span class="co"># correr bucle</span></span>
<span id="cb51-567"><a href="#cb51-567" aria-hidden="true" tabindex="-1"></a>filas <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> archivos_txt, <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb51-568"><a href="#cb51-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>(<span class="fu">read.table</span>(x, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">skip =</span> <span class="dv">4</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>))</span>
<span id="cb51-569"><a href="#cb51-569" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb51-570"><a href="#cb51-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-571"><a href="#cb51-571" aria-hidden="true" tabindex="-1"></a><span class="co"># ver resultados</span></span>
<span id="cb51-572"><a href="#cb51-572" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filas)</span>
<span id="cb51-573"><a href="#cb51-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-574"><a href="#cb51-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-575"><a href="#cb51-575" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-576"><a href="#cb51-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-577"><a href="#cb51-577" aria-hidden="true" tabindex="-1"></a>Tenga en cuenta que:</span>
<span id="cb51-578"><a href="#cb51-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-579"><a href="#cb51-579" aria-hidden="true" tabindex="-1"></a>1)  en este tipo de bucles no hay retroalimentación de las iteraciones anteriores (es decir, los resultados de una iteración no se pueden ingresar en las iteraciones posteriores)</span>
<span id="cb51-580"><a href="#cb51-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-581"><a href="#cb51-581" aria-hidden="true" tabindex="-1"></a>2)  <span class="in">`(X)apply`</span> es más limpio que otros bucles porque los objetos creados dentro de ellos no están disponibles en el entorno de trabajo actual.</span>
<span id="cb51-582"><a href="#cb51-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-583"><a href="#cb51-583" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-584"><a href="#cb51-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-585"><a href="#cb51-585" aria-hidden="true" tabindex="-1"></a><span class="fu">## bucles `replicate`</span></span>
<span id="cb51-586"><a href="#cb51-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-587"><a href="#cb51-587" aria-hidden="true" tabindex="-1"></a>El bucle <span class="in">`replicate`</span> también pertenece a la familia de los <span class="in">`(X)apply`</span> (a pesar de su nombre), ya que toma una función y la replica. Sin embargo solo replica una acción (generalmente aleatoria) y el usuario no tiene control sobre el insumo a la función. El argumento 'n' define cuantas veces se replica la acción y 'expr' define la acción a realizar:</span>
<span id="cb51-588"><a href="#cb51-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-591"><a href="#cb51-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb51-592"><a href="#cb51-592" aria-hidden="true" tabindex="-1"></a><span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>))</span>
<span id="cb51-593"><a href="#cb51-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-594"><a href="#cb51-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-595"><a href="#cb51-595" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-596"><a href="#cb51-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-597"><a href="#cb51-597" aria-hidden="true" tabindex="-1"></a>Note que los resultados son agrupados en una matrix. 'expr' también puede replicar código que no ha sido "empaquetado en una función".</span>
<span id="cb51-598"><a href="#cb51-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-599"><a href="#cb51-599" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-600"><a href="#cb51-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-601"><a href="#cb51-601" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb51-602"><a href="#cb51-602" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">"5"</span><span class="kw">&gt;</span> Ejercicio 2<span class="kw">&lt;/font&gt;</span></span>
<span id="cb51-603"><a href="#cb51-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-604"><a href="#cb51-604" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-605"><a href="#cb51-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-606"><a href="#cb51-606" aria-hidden="true" tabindex="-1"></a>2.1 Haga un bucle <span class="in">`lapply`</span> equivalente al bucle <span class="in">`for`</span> en el ejercicio 1.1.</span>
<span id="cb51-607"><a href="#cb51-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-608"><a href="#cb51-608" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-609"><a href="#cb51-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-610"><a href="#cb51-610" aria-hidden="true" tabindex="-1"></a>2.2 Haga un bucle <span class="in">`sapply`</span> equivalente al bucle <span class="in">`for`</span> en el ejercicio 1.1 y ponga el resultado en un cuadro de datos, similiar a lo hecho en el ejercicio 1.2</span>
<span id="cb51-611"><a href="#cb51-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-612"><a href="#cb51-612" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-613"><a href="#cb51-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-614"><a href="#cb51-614" aria-hidden="true" tabindex="-1"></a>2.3 Haga un bucle <span class="in">`sapply`</span> que permita añadir al cuadro de datos creado en el ejercicio anterior el total de individuos observados en un muestreo (pista: sumatoria de la columna 'MaxN').</span>
<span id="cb51-615"><a href="#cb51-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-616"><a href="#cb51-616" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-617"><a href="#cb51-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-618"><a href="#cb51-618" aria-hidden="true" tabindex="-1"></a>2.4 Haga un bucle <span class="in">`tapply`</span> para calcular el error estandar para el ancho de sépalo por especie en el juego de datos 'iris'.</span>
<span id="cb51-619"><a href="#cb51-619" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb51-620"><a href="#cb51-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-621"><a href="#cb51-621" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-622"><a href="#cb51-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-623"><a href="#cb51-623" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-624"><a href="#cb51-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-625"><a href="#cb51-625" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bucles 'repeat'</span></span>
<span id="cb51-626"><a href="#cb51-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-627"><a href="#cb51-627" aria-hidden="true" tabindex="-1"></a>Los bucles <span class="in">`repeat`</span> deben cumplir una condición para detenerse. Típicamente el bucle lleva a cabo la acción al menos una vez, independientemente de la evaluación de la condición:</span>
<span id="cb51-628"><a href="#cb51-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-629"><a href="#cb51-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="40%", fig.align="center"}</span></span>
<span id="cb51-630"><a href="#cb51-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-631"><a href="#cb51-631" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/repeat_esp.png"</span>)</span>
<span id="cb51-632"><a href="#cb51-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-633"><a href="#cb51-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-634"><a href="#cb51-634" aria-hidden="true" tabindex="-1"></a>El siguiente bucle <span class="in">`repeat`</span> se ejecuta hasta que la correlación de las variables continuas generadas al azar es mayor que un umbral:</span>
<span id="cb51-635"><a href="#cb51-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-636"><a href="#cb51-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=T, echo=T}</span></span>
<span id="cb51-637"><a href="#cb51-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-638"><a href="#cb51-638" aria-hidden="true" tabindex="-1"></a><span class="co"># crear vector vacio</span></span>
<span id="cb51-639"><a href="#cb51-639" aria-hidden="true" tabindex="-1"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb51-640"><a href="#cb51-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-641"><a href="#cb51-641" aria-hidden="true" tabindex="-1"></a><span class="cf">repeat</span>{</span>
<span id="cb51-642"><a href="#cb51-642" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generar la variable 1</span></span>
<span id="cb51-643"><a href="#cb51-643" aria-hidden="true" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-644"><a href="#cb51-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-645"><a href="#cb51-645" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generar la variable 2</span></span>
<span id="cb51-646"><a href="#cb51-646" aria-hidden="true" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-647"><a href="#cb51-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-648"><a href="#cb51-648" aria-hidden="true" tabindex="-1"></a>  <span class="co"># correr la correlacion</span></span>
<span id="cb51-649"><a href="#cb51-649" aria-hidden="true" tabindex="-1"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb51-650"><a href="#cb51-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-651"><a href="#cb51-651" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados</span></span>
<span id="cb51-652"><a href="#cb51-652" aria-hidden="true" tabindex="-1"></a>  cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb51-653"><a href="#cb51-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-654"><a href="#cb51-654" aria-hidden="true" tabindex="-1"></a>  <span class="co"># parar si se cumple la condicion</span></span>
<span id="cb51-655"><a href="#cb51-655" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (corr_coef <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="cf">break</span></span>
<span id="cb51-656"><a href="#cb51-656" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-657"><a href="#cb51-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-658"><a href="#cb51-658" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cc_vector)</span>
<span id="cb51-659"><a href="#cb51-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-660"><a href="#cb51-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-661"><a href="#cb51-661" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-662"><a href="#cb51-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-663"><a href="#cb51-663" aria-hidden="true" tabindex="-1"></a>Podemos graficarlo el resultado asi así:</span>
<span id="cb51-664"><a href="#cb51-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-665"><a href="#cb51-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=T, echo=T}</span></span>
<span id="cb51-666"><a href="#cb51-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-667"><a href="#cb51-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-668"><a href="#cb51-668" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> cc_vector, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cc_vector))</span>
<span id="cb51-669"><a href="#cb51-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-670"><a href="#cb51-670" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cc, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb51-671"><a href="#cb51-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">col =</span> cols[<span class="dv">4</span>], <span class="at">lwd =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb51-672"><a href="#cb51-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> cols[<span class="dv">8</span>], <span class="at">lwd =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb51-673"><a href="#cb51-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iteraciones"</span>, <span class="at">y =</span> <span class="st">"Correlación de pearson (r)"</span>) <span class="sc">+</span></span>
<span id="cb51-674"><a href="#cb51-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">25</span>)</span>
<span id="cb51-675"><a href="#cb51-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-676"><a href="#cb51-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-677"><a href="#cb51-677" aria-hidden="true" tabindex="-1"></a>La condición determina si el ciclo debe detenerse.</span>
<span id="cb51-678"><a href="#cb51-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-679"><a href="#cb51-679" aria-hidden="true" tabindex="-1"></a>Una característica importante de los bucles <span class="in">`while`</span>,<span class="in">`repeat`</span> y <span class="in">`for`</span> es que pueden tomar resultados de iteraciones anteriores como entrada en iteraciones posteriores. Esto se debe a que los objetos creados dentro de la función se guardan en el entorno actual (a diferencia de los bucles <span class="in">`Xapply`</span>).</span>
<span id="cb51-680"><a href="#cb51-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-681"><a href="#cb51-681" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-682"><a href="#cb51-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-683"><a href="#cb51-683" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-684"><a href="#cb51-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-685"><a href="#cb51-685" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bucles 'While'</span></span>
<span id="cb51-686"><a href="#cb51-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-687"><a href="#cb51-687" aria-hidden="true" tabindex="-1"></a>Los bucles <span class="in">`while`</span> aplican una acción en una secuencia de elementos hasta que se cumpla una condición. Son muy parecidos a los bucles <span class="in">`repeat`</span>. La condición puede evaluar un resultado del propio bucle o una entrada externa:</span>
<span id="cb51-688"><a href="#cb51-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-689"><a href="#cb51-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE,out.width="40%", fig.align="center"}</span></span>
<span id="cb51-690"><a href="#cb51-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-691"><a href="#cb51-691" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/while_esp.png"</span>)</span>
<span id="cb51-692"><a href="#cb51-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-693"><a href="#cb51-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-694"><a href="#cb51-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=F, echo=T}</span></span>
<span id="cb51-695"><a href="#cb51-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-696"><a href="#cb51-696" aria-hidden="true" tabindex="-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb51-697"><a href="#cb51-697" aria-hidden="true" tabindex="-1"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-698"><a href="#cb51-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-699"><a href="#cb51-699" aria-hidden="true" tabindex="-1"></a><span class="co"># iniciar bucle</span></span>
<span id="cb51-700"><a href="#cb51-700" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb51-701"><a href="#cb51-701" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generar la variable 1</span></span>
<span id="cb51-702"><a href="#cb51-702" aria-hidden="true" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-703"><a href="#cb51-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-704"><a href="#cb51-704" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generar la variable 2</span></span>
<span id="cb51-705"><a href="#cb51-705" aria-hidden="true" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-706"><a href="#cb51-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-707"><a href="#cb51-707" aria-hidden="true" tabindex="-1"></a>  <span class="co"># corrrer  la correlacion</span></span>
<span id="cb51-708"><a href="#cb51-708" aria-hidden="true" tabindex="-1"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb51-709"><a href="#cb51-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-710"><a href="#cb51-710" aria-hidden="true" tabindex="-1"></a>  <span class="co"># imprimir</span></span>
<span id="cb51-711"><a href="#cb51-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(corr_coef)</span>
<span id="cb51-712"><a href="#cb51-712" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-713"><a href="#cb51-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-714"><a href="#cb51-714" aria-hidden="true" tabindex="-1"></a>corr_coef</span>
<span id="cb51-715"><a href="#cb51-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-716"><a href="#cb51-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-717"><a href="#cb51-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=T, echo=F}</span></span>
<span id="cb51-718"><a href="#cb51-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-719"><a href="#cb51-719" aria-hidden="true" tabindex="-1"></a><span class="co"># set default value as 0</span></span>
<span id="cb51-720"><a href="#cb51-720" aria-hidden="true" tabindex="-1"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-721"><a href="#cb51-721" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb51-722"><a href="#cb51-722" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span>) {</span>
<span id="cb51-723"><a href="#cb51-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">length</span>(cc) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb51-724"><a href="#cb51-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-725"><a href="#cb51-725" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate variable 1</span></span>
<span id="cb51-726"><a href="#cb51-726" aria-hidden="true" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-727"><a href="#cb51-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-728"><a href="#cb51-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">length</span>(cc) <span class="sc">+</span> <span class="dv">100</span>)</span>
<span id="cb51-729"><a href="#cb51-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-730"><a href="#cb51-730" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate variable 2</span></span>
<span id="cb51-731"><a href="#cb51-731" aria-hidden="true" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-732"><a href="#cb51-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-733"><a href="#cb51-733" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run correlation</span></span>
<span id="cb51-734"><a href="#cb51-734" aria-hidden="true" tabindex="-1"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb51-735"><a href="#cb51-735" aria-hidden="true" tabindex="-1"></a>  cc <span class="ot">&lt;-</span> <span class="fu">append</span>(cc, corr_coef)</span>
<span id="cb51-736"><a href="#cb51-736" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-737"><a href="#cb51-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-738"><a href="#cb51-738" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(cc) <span class="sc">&gt;</span> <span class="dv">10</span>) {</span>
<span id="cb51-739"><a href="#cb51-739" aria-hidden="true" tabindex="-1"></a>  cc <span class="ot">&lt;-</span> cc[(<span class="fu">length</span>(cc) <span class="sc">-</span> <span class="dv">10</span>)<span class="sc">:</span><span class="fu">length</span>(cc)]</span>
<span id="cb51-740"><a href="#cb51-740" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-741"><a href="#cb51-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-742"><a href="#cb51-742" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cc)</span>
<span id="cb51-743"><a href="#cb51-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-744"><a href="#cb51-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-745"><a href="#cb51-745" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-746"><a href="#cb51-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-747"><a href="#cb51-747" aria-hidden="true" tabindex="-1"></a>Con un pequeño ajuste, un bucle <span class="in">`while`</span> también puede evaluar varias condiciones a la vez. Por ejemplo, también podemos incluir altos valores de correlación negativa:</span>
<span id="cb51-748"><a href="#cb51-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-749"><a href="#cb51-749" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=T, echo=T}</span></span>
<span id="cb51-750"><a href="#cb51-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-751"><a href="#cb51-751" aria-hidden="true" tabindex="-1"></a><span class="co"># definir valor inicial</span></span>
<span id="cb51-752"><a href="#cb51-752" aria-hidden="true" tabindex="-1"></a>corr_coef <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-753"><a href="#cb51-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-754"><a href="#cb51-754" aria-hidden="true" tabindex="-1"></a><span class="co"># crear vector vacio</span></span>
<span id="cb51-755"><a href="#cb51-755" aria-hidden="true" tabindex="-1"></a>cc_vector <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb51-756"><a href="#cb51-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-757"><a href="#cb51-757" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (corr_coef <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> corr_coef <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">0.5</span>) {</span>
<span id="cb51-758"><a href="#cb51-758" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generar la variable 1</span></span>
<span id="cb51-759"><a href="#cb51-759" aria-hidden="true" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-760"><a href="#cb51-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-761"><a href="#cb51-761" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generar la variable 2</span></span>
<span id="cb51-762"><a href="#cb51-762" aria-hidden="true" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb51-763"><a href="#cb51-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-764"><a href="#cb51-764" aria-hidden="true" tabindex="-1"></a>  <span class="co"># correr correlacion</span></span>
<span id="cb51-765"><a href="#cb51-765" aria-hidden="true" tabindex="-1"></a>  corr_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(v1, v2)</span>
<span id="cb51-766"><a href="#cb51-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-767"><a href="#cb51-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guardar resultados</span></span>
<span id="cb51-768"><a href="#cb51-768" aria-hidden="true" tabindex="-1"></a>  cc_vector[<span class="fu">length</span>(cc_vector) <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> corr_coef</span>
<span id="cb51-769"><a href="#cb51-769" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-770"><a href="#cb51-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-771"><a href="#cb51-771" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cc_vector)</span>
<span id="cb51-772"><a href="#cb51-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-773"><a href="#cb51-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-774"><a href="#cb51-774" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-775"><a href="#cb51-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-776"><a href="#cb51-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=T, echo=F, message=F, warning=F}</span></span>
<span id="cb51-777"><a href="#cb51-777" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> cc_vector</span>
<span id="cb51-778"><a href="#cb51-778" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> cc, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cc))</span>
<span id="cb51-779"><a href="#cb51-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-780"><a href="#cb51-780" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(cc) <span class="sc">&gt;</span> <span class="dv">50</span>) {</span>
<span id="cb51-781"><a href="#cb51-781" aria-hidden="true" tabindex="-1"></a>  cc <span class="ot">&lt;-</span> cc[(<span class="fu">nrow</span>(cc) <span class="sc">-</span> <span class="dv">50</span>)<span class="sc">:</span><span class="fu">nrow</span>(cc), ]</span>
<span id="cb51-782"><a href="#cb51-782" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-783"><a href="#cb51-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-784"><a href="#cb51-784" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cc, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb51-785"><a href="#cb51-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">col =</span> cols[<span class="dv">4</span>], <span class="at">lwd =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb51-786"><a href="#cb51-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col =</span> cols[<span class="dv">8</span>], <span class="at">lwd =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb51-787"><a href="#cb51-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iteraciones"</span>, <span class="at">y =</span> <span class="st">"Correlación de pearson (r)"</span>) <span class="sc">+</span></span>
<span id="cb51-788"><a href="#cb51-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">25</span>)</span>
<span id="cb51-789"><a href="#cb51-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb51-790"><a href="#cb51-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-791"><a href="#cb51-791" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-792"><a href="#cb51-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-793"><a href="#cb51-793" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb51-794"><a href="#cb51-794" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 3<span class="kw">&lt;/font&gt;</span></span>
<span id="cb51-795"><a href="#cb51-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-796"><a href="#cb51-796" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-797"><a href="#cb51-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-798"><a href="#cb51-798" aria-hidden="true" tabindex="-1"></a>3.1 Haga un bucle <span class="in">`while`</span> que se detenga si la correlación es superior a 0.8 o si el bucle ha estado ejecutándose durante más de 10 segundos (consejo: use la función<span class="in">`difftime`</span> y/o <span class="in">`as.numeric`</span>)</span>
<span id="cb51-799"><a href="#cb51-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-800"><a href="#cb51-800" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb51-801"><a href="#cb51-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-802"><a href="#cb51-802" aria-hidden="true" tabindex="-1"></a>3.2 Haga un bucle <span class="in">`repeat`</span> que se detenga solo si la correlación es mayor que 0.5 pero menor que 0.55</span>
<span id="cb51-803"><a href="#cb51-803" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb51-804"><a href="#cb51-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-805"><a href="#cb51-805" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-806"><a href="#cb51-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-807"><a href="#cb51-807" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referencias</span></span>
<span id="cb51-808"><a href="#cb51-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-809"><a href="#cb51-809" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Advanced R, H Wickham</span><span class="co">](http://adv-r.had.co.nz/Functionals.html)</span></span>
<span id="cb51-810"><a href="#cb51-810" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">A Tutorial on Loops in R - Usage and Alternatives, DataCamp</span><span class="co">](https://www.datacamp.com/community/tutorials/tutorial-on-loops-in-r)</span></span>
<span id="cb51-811"><a href="#cb51-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-812"><a href="#cb51-812" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb51-813"><a href="#cb51-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-814"><a href="#cb51-814" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Session information<span class="kw">&lt;/font&gt;</span></span>
<span id="cb51-815"><a href="#cb51-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-816"><a href="#cb51-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb51-817"><a href="#cb51-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-818"><a href="#cb51-818" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb51-819"><a href="#cb51-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></div>
  </div>
</footer>



</body></html>