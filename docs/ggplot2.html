<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R avanzado 2023 - Gráficos con ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R avanzado 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuales" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Manuales</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-manuales">    
        <li>
    <a class="dropdown-item" href="./fundamentos_de_r.html">
 <span class="dropdown-text">Fundamentos de R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./reportes_dinamicos.html">
 <span class="dropdown-text">Reportes dinámicos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./funciones.html">
 <span class="dropdown-text">Funciones</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./bucles.html">
 <span class="dropdown-text">Bucles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./modelos_de_regresion.html">
 <span class="dropdown-text">Modelos de regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./estadistica_tradicional_regresion.html">
 <span class="dropdown-text">Estadística tradicional como regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ggplot2.html">
 <span class="dropdown-text">Gráficos con ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tareas" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tareas</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tareas">    
        <li>
    <a class="dropdown-item" href="./tarea4.html">
 <span class="dropdown-text">Tarea 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tarea5.html">
 <span class="dropdown-text">Tarea 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./respuestas_tarea5.html">
 <span class="dropdown-text">Solución Tarea 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./preparacion_curso.html"> 
<span class="menu-text">Preparación para el curso</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://codefile.io/f/inMsojTFoN"> 
<span class="menu-text">Compartir código</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html"> 
<span class="menu-text">Instructor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https:/github.com/maRce10/R_avanzado_2023/"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text">https:/github.com/maRce10/R_avanzado_2023/</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul class="collapse">
  <li><a href="#gramática-de-gráficos" id="toc-gramática-de-gráficos" class="nav-link active" data-scroll-target="#gramática-de-gráficos"><span class="header-section-number">0.1</span> Gramática de gráficos</a></li>
  <li><a href="#componentes-del-gráfico" id="toc-componentes-del-gráfico" class="nav-link" data-scroll-target="#componentes-del-gráfico"><span class="header-section-number">0.2</span> Componentes del gráfico</a></li>
  <li><a href="#gráficos-de-dispersión" id="toc-gráficos-de-dispersión" class="nav-link" data-scroll-target="#gráficos-de-dispersión"><span class="header-section-number">0.3</span> Gráficos de dispersión</a></li>
  <li><a href="#atributos-estéticos" id="toc-atributos-estéticos" class="nav-link" data-scroll-target="#atributos-estéticos"><span class="header-section-number">0.4</span> Atributos estéticos</a></li>
  <li><a href="#gráficos-multipanel-facetting" id="toc-gráficos-multipanel-facetting" class="nav-link" data-scroll-target="#gráficos-multipanel-facetting"><span class="header-section-number">0.5</span> Gráficos multipanel (Facetting)</a></li>
  <li><a href="#geoms-adicionales" id="toc-geoms-adicionales" class="nav-link" data-scroll-target="#geoms-adicionales"><span class="header-section-number">0.6</span> “geoms” adicionales</a></li>
  <li><a href="#personalización-de-ggplots" id="toc-personalización-de-ggplots" class="nav-link" data-scroll-target="#personalización-de-ggplots"><span class="header-section-number">0.7</span> Personalización de ggplots</a></li>
  <li><a href="#otros-paquetes-de-gráficos-en-r" id="toc-otros-paquetes-de-gráficos-en-r" class="nav-link" data-scroll-target="#otros-paquetes-de-gráficos-en-r"><span class="header-section-number">0.8</span> Otros paquetes de gráficos en R</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">0.9</span> References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><font size="7"><b>Gráficos con ggplot2</b></font></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">8 de noviembre de 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<section id="objetivos-del-manual" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Objetivos del manual</h1>
<ul>
<li><p>Comprender la lógica detras de la estructura los gráficos con ggplot2</p></li>
<li><p>Ser capaz de intregrar en un gŕafico diferentes fuentes de información que representen la complejidad de los datos</p></li>
</ul>
</section>
<p>&nbsp;</p>
<p>&nbsp;</p>
<section id="ggplot2" class="level2 unnumbered unlisted alert alert-warning">
<h2 class="unnumbered unlisted anchored" data-anchor-id="ggplot2">ggplot2</h2>
<ul>
<li><p>Un paquete de R diseñado específicamente para producir gráficos</p></li>
<li><p>A diferencia de otros paquetes, ggplot2 tiene su propia gramática</p></li>
<li><p>La gramática se basa en la “Gramática de los gráficos” (Wilkinson 2005)</p></li>
<li><p>Módulos independientes que pueden combinarse de muchas formas</p></li>
<li><p>Esta gramática proporciona una gran flexibilidad</p></li>
</ul>
</section>
<p>&nbsp;</p>
<section id="gramática-de-gráficos" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="gramática-de-gráficos"><span class="header-section-number">0.1</span> Gramática de gráficos</h2>
<p>La idea principal es empezar con una capa base de datos brutos y luego añadir más capas de anotaciones y resúmenes estadísticos. El paquete nos permite producir gráficos utilizando la misma estructura de pensamiento que utilizamos al diseñar un análisis, reduciendo la distancia de cómo visualizamos un gráfico en la cabeza y el producto final.</p>
<p>Aprender la gramática no sólo es útil para producir un gráfico de interés, sino también para pensar en otros gráficos más complejos. La ventaja de esta gramática es la posibilidad de crear nuevos gráficos compuestos por nuevas combinaciones de elementos.</p>
<p>&nbsp;</p>
</section>
<section id="componentes-del-gráfico" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="componentes-del-gráfico"><span class="header-section-number">0.2</span> Componentes del gráfico</h2>
<p>Todos los gráficos ggplot2 contienen los siguientes componentes:</p>
<ul>
<li><strong>Datos</strong> - El objeto R con la información que necesita ser trazada</li>
<li><strong>Capas</strong> - Los datos específicos que serán graficados (ej. ‘x’ &amp; ‘y’)</li>
<li><strong>Escala</strong> - Rango de datos a incluir</li>
<li><strong>Coordenadas</strong> - Sistema de coordenadas (no se utiliza muy a menudo)</li>
<li><strong>Parcelas (facets)</strong> - Determina cómo dividir los datos en subparcelas en un multipanel</li>
<li><strong>Tema</strong> - Controla el estilo del gráfico</li>
</ul>
<p>&nbsp;</p>
<p>Estos componentes se juntan utilizando “+”.</p>
<p>La sintaxis más habitual incluye los datos dentro de la llamada “ggplot” y una capa “geom_”.</p>
<p>&nbsp;</p>
<p>Primero instala/carga el paquete:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># install</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># load library</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
</section>
<section id="gráficos-de-dispersión" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="gráficos-de-dispersión"><span class="header-section-number">0.3</span> Gráficos de dispersión</h2>
<p>Utilicemos el conjunto de datos “iris” para crear gráficos de dispersión:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-1" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-3-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-1" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>This plot is defined by 3 components: 1. “data”- iris 1. “aes” - Sepal.length vs Petal.length 1. “layer” - Points (geom)</p>
<p>&nbsp;</p>
</section>
<section id="atributos-estéticos" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="atributos-estéticos"><span class="header-section-number">0.4</span> Atributos estéticos</h2>
<p>También podemos añadir otros atributos estéticos como el color, la forma y el tamaño. Estos atributos se pueden incluir dentro de <code>aes()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># color by species</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">ggplot</span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="at">data =</span> iris,</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length, <span class="at">color =</span> Species)</span>
<span id="cb3-5"><a href="#cb3-5"></a>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-2" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-4-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-2" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># color and shape by species</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">ggplot</span>(</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="at">data =</span> iris,</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="at">x =</span> Sepal.Length,</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">y =</span> Petal.Length,</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">color =</span> Species,</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="at">shape =</span> Species</span>
<span id="cb4-9"><a href="#cb4-9"></a>  )</span>
<span id="cb4-10"><a href="#cb4-10"></a>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-3" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-4-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-3" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Tenga en cuenta que los argumentos estéticos también pueden incluirse en la capa “geom”:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="at">data =</span> iris,</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)</span>
<span id="cb5-4"><a href="#cb5-4"></a>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-4" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-5-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-4" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>También podemos incluir un valor fijo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="at">data =</span> iris,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)</span>
<span id="cb6-4"><a href="#cb6-4"></a>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-5" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-6-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-5" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Algunos atributos funcionan mejor con algunos tipos de datos:</p>
<ul>
<li>Color y forma: variables categóricas</li>
<li>Tamaño: variables continuas</li>
</ul>
<p>&nbsp;</p>
<p><br></p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 1</font></p>
<p>Utilizando el conjunto de datos “hylaeformis”:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># lear desde el sitio del curso</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>hylaeformis_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">paste0</span>(<span class="st">"https://raw.githubusercontent.com/maRce10/"</span>, <span class="st">"r_avanzado_2023/master/data/hylaeformis_data.csv"</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># or bajar manualmente y leer copia local</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>hylaeformis_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hylaeformis_data.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="fu">head</span>(hylaeformis_data, <span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>1.1 Create a scatter plot of vs “meanfreq” (mean frequency)</p>
<p>1.1 Crear un gráfico de dispersión de duración (“duration”) vs frecuencia promedio (“meanfreq”)</p>
<p><br></p>
<p>1.2 Añadir un atributo estético para mostrar un color diferente para cada localidad</p>
<p><br></p>
<p>1.3 Añade otro atributo estético para mostrar el rango de frecuencia dominante (“dfrange”) como tamaño los símbolos</p>
<p><br></p>
</div>
<p>&nbsp;</p>
</section>
<section id="gráficos-multipanel-facetting" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="gráficos-multipanel-facetting"><span class="header-section-number">0.5</span> Gráficos multipanel (Facetting)</h2>
<ul>
<li>Otra forma de visualizar variables categóricas</li>
<li>Permite crear gráficos multipanel para cada nivel de la variable</li>
<li>2 tipos: “grid” &amp; “wrap”</li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-6" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-11-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-6" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># o</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Species)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-7" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-11-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-7" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>La escala puede ser fija o libre para los ejes <em>x</em> e <em>y</em>, y puede modificarse el número de columnas y filas:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># free x</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free_x"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-8" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-12-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-8" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># free x and 3 rows</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-9" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-13-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-9" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># both free and 2 rows</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-10" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-14-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-10" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Tenga en cuenta que también podemos guardar el componente básico como un objeto <strong>R</strong> y añadir otros componentes más adelante en el código:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-11" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-15-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-11" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="geoms-adicionales" class="level2" data-number="0.6">
<h2 data-number="0.6" class="anchored" data-anchor-id="geoms-adicionales"><span class="header-section-number">0.6</span> “geoms” adicionales</h2>
<ul>
<li><code>geom_smooth()</code> - añade las líneas de mejor ajuste (incluyendo CI)</li>
<li><code>geom_boxplot()</code> - Distribución de frecuencias</li>
<li><code>geom_histogram()</code> &amp; <code>geom_freqpoly()</code> - distribuciones de frecuencia</li>
<li><code>geom_bar()</code> - distribución de frecuencias de variables categóricas</li>
<li><code>geom_path()</code> &amp; <code>geom_line()</code> - añade líneas a los gráficos de dispersión</li>
</ul>
<p>&nbsp;</p>
<section id="geom_smooth" class="level3" data-number="0.6.1">
<h3 data-number="0.6.1" class="anchored" data-anchor-id="geom_smooth"><span class="header-section-number">0.6.1</span> geom_smooth()</h3>
<p>Las líneas de regresión de mejor ajuste pueden añadirse con <code>geom_smooth()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># con CI</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-12" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-16-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-12" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># sin CI</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-13" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-16-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-13" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 2</font></p>
<p>Utilizando el conjunto de datos de ejemplo “msleep”:</p>
<p><br></p>
<p>2.1 Crear un gráfico de dispersión de peso corporal (“bodywt”) frente a peso cerebral (“brainwt”)</p>
<p><br></p>
<p>2.2 Añadir orden (“order”) como estética del color</p>
<p><br></p>
<p>2.3 Añadir un componente “faceta” para dividir los gráficos por orden utilizando escalas libres</p>
<p><br></p>
<p>2.4 Elimine los órdenes con menos de 4 especies en el conjunto de datos y haga un gráfico similar al 2.3</p>
<p><br></p>
<p>2.5 Añadir una línea de mejor ajuste a cada gráfico del panel</p>
<p><br></p>
</div>
</section>
<section id="boxplots" class="level3" data-number="0.6.2">
<h3 data-number="0.6.2" class="anchored" data-anchor-id="boxplots"><span class="header-section-number">0.6.2</span> Boxplots</h3>
<p>De nuevo, sólo se necesita un nuevo componente “geom” para crear un boxplot:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-14" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-22-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-14" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>Una alternativa interesante son los gráficos de violines:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-15" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-23-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-15" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="histogramas" class="level3" data-number="0.6.3">
<h3 data-number="0.6.3" class="anchored" data-anchor-id="histogramas"><span class="header-section-number">0.6.3</span> Histogramas</h3>
<p>Lo mismo ocurre con los histrogramas y los gráficos de frecuencias:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-16" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-24-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-16" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">geom_freqpoly</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-17" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-24-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-17" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">geom_freqpoly</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-18" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-24-3.png" id="fig-539a35d47e664c97a50115a146a7f1bd-18" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos controlar la anchura de las barras:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"red2"</span>, <span class="at">alpha.f =</span> <span class="fl">0.3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated aesthetics after name standardisation: fill</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-19" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-25-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-19" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Y compara la distribución de los distintos grupos dentro del mismo histograma:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-20" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-26-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-20" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="gráfico-de-barras" class="level3" data-number="0.6.4">
<h3 data-number="0.6.4" class="anchored" data-anchor-id="gráfico-de-barras"><span class="header-section-number">0.6.4</span> Gráfico de barras</h3>
<p>Muestran la distribución de variables discretas (categóricas):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(msleep<span class="sc">$</span>order)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>df <span class="ot">&lt;-</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">as.data.frame</span>(<span class="fu">table</span>(msleep<span class="sc">$</span>order[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">3</span>]]))</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-21" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-27-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-21" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="personalización-de-ggplots" class="level2" data-number="0.7">
<h2 data-number="0.7" class="anchored" data-anchor-id="personalización-de-ggplots"><span class="header-section-number">0.7</span> Personalización de ggplots</h2>
<p>Además de las funciones básicas (por ejemplo, componentes) descritas anteriormente, ggplot tiene muchas otras herramientas (tanto argumentos como funciones adicionales) para personalizar aún más los gráficos. Prácticamente todo se puede modificar. Aquí vemos algunas de las herramientas más comunes.</p>
<p>&nbsp;</p>
<section id="temas" class="level3" data-number="0.7.1">
<h3 data-number="0.7.1" class="anchored" data-anchor-id="temas"><span class="header-section-number">0.7.1</span> Temas</h3>
<p>ggplot2 viene con algunos temas por defecto que se pueden aplicar fácilmente para modificar el aspecto de nuestros gráficos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-22" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-29-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-22" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-23" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-29-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-23" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-24" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-29-3.png" id="fig-539a35d47e664c97a50115a146a7f1bd-24" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>La mayoría de los temas difieren en el uso de cuadrículas, líneas de borde y patrones de etiquetado de ejes.</p>
<p>&nbsp;</p>
</section>
<section id="personalización-de-ejes" class="level3" data-number="0.7.2">
<h3 data-number="0.7.2" class="anchored" data-anchor-id="personalización-de-ejes"><span class="header-section-number">0.7.2</span> Personalización de ejes</h3>
<p>Los límites de los ejes pueden modificarse como sigue:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-25" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-30-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-25" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-26" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-30-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-26" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Los ejes también pueden transformarse:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log"</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-27" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-31-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-27" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>o invertidos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">scale_y_reverse</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-28" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-32-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-28" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-ggplots" class="level3" data-number="0.7.3">
<h3 data-number="0.7.3" class="anchored" data-anchor-id="guardar-ggplots"><span class="header-section-number">0.7.3</span> Guardar ggplots</h3>
<p>Los ggplots pueden exportarse como archivos de imagen utilizando la función <code>ggsave</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="at">data =</span> msleep[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">5</span>], ],</span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bodywt, <span class="at">y =</span> brainwt)</span>
<span id="cb32-4"><a href="#cb32-4"></a>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>order, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-29" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-33-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-29" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Export</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">ggsave</span>(<span class="st">"plot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing missing values (`geom_point()`).</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>El tipo de archivo de imagen se identificará por la extensión en el nombre del archivo</p>
<p>&nbsp;</p>
<p>Personalización adicional del eje:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Log2 scaling of the y axis (with visually-equal spacing)</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">require</span>(scales)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="fu">log2_trans</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-30" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-30" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># show exponents</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(</span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="at">trans =</span> <span class="fu">log2_trans</span>(),</span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log2"</span>, <span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">^</span>x),</span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log2"</span>, <span class="fu">math_format</span>(<span class="dv">2</span><span class="sc">^</span>.x))</span>
<span id="cb37-6"><a href="#cb37-6"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-31" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-31" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Percent</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-32" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-3.png" id="fig-539a35d47e664c97a50115a146a7f1bd-32" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># dollar</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-33" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-4.png" id="fig-539a35d47e664c97a50115a146a7f1bd-33" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># scientific</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-34" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-5.png" id="fig-539a35d47e664c97a50115a146a7f1bd-34" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="do">### Agregar "tick marks" </span><span class="al">###</span></span>
<span id="cb41-2"><a href="#cb41-2"></a></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co"># Cargar librerías</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="fu">library</span>(MASS)</span>
<span id="cb41-5"><a href="#cb41-5"></a></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="fu">data</span>(Animals)</span>
<span id="cb41-7"><a href="#cb41-7"></a></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co"># x and y axis are transformed and formatted</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Animals, <span class="fu">aes</span>(<span class="at">x =</span> body, <span class="at">y =</span> brain)) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  <span class="fu">scale_x_log10</span>(</span>
<span id="cb41-12"><a href="#cb41-12"></a>    <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb41-13"><a href="#cb41-13"></a>    <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))</span>
<span id="cb41-14"><a href="#cb41-14"></a>  ) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>  <span class="fu">scale_y_log10</span>(</span>
<span id="cb41-16"><a href="#cb41-16"></a>    <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb41-17"><a href="#cb41-17"></a>    <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))</span>
<span id="cb41-18"><a href="#cb41-18"></a>  ) <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb41-20"><a href="#cb41-20"></a></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="co"># log-log plot without log tick marks</span></span>
<span id="cb41-22"><a href="#cb41-22"></a>p2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-35" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-6.png" id="fig-539a35d47e664c97a50115a146a7f1bd-35" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Show log tick marks</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-36" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-7.png" id="fig-539a35d47e664c97a50115a146a7f1bd-36" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># # Log ticks on left and right</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"lr"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-37" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-8.png" id="fig-539a35d47e664c97a50115a146a7f1bd-37" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># All sides</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"trbl"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-38" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-34-9.png" id="fig-539a35d47e664c97a50115a146a7f1bd-38" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="otros-gráficos" class="level3" data-number="0.7.4">
<h3 data-number="0.7.4" class="anchored" data-anchor-id="otros-gráficos"><span class="header-section-number">0.7.4</span> Otros gráficos</h3>
<p>Se pueden generar muchos otros tipos de gráficos. Aquí muestro un ejemplo de gráficos de contorno y de “mapa de calor”:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">head</span>(faithful)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead>
<tr>
<th style="text-align:right;">
eruptions
</th>
<th style="text-align:right;">
waiting
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.600
</td>
<td style="text-align:right;">
79
</td>
</tr>
<tr>
<td style="text-align:right;">
1.800
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:right;">
3.333
</td>
<td style="text-align:right;">
74
</td>
</tr>
<tr>
<td style="text-align:right;">
2.283
</td>
<td style="text-align:right;">
62
</td>
</tr>
<tr>
<td style="text-align:right;">
4.533
</td>
<td style="text-align:right;">
85
</td>
</tr>
<tr>
<td style="text-align:right;">
2.883
</td>
<td style="text-align:right;">
55
</td>
</tr>
</tbody>
</table>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> density, <span class="at">colour =</span> <span class="fu">after_stat</span>(level)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-39" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-35-1.png" id="fig-539a35d47e664c97a50115a146a7f1bd-39" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r numberLines lineAnchors number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-539a35d47e664c97a50115a146a7f1bd-40" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div>
<img src="ggplot2_files/figure-html/unnamed-chunk-35-2.png" id="fig-539a35d47e664c97a50115a146a7f1bd-40" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="otros-paquetes-de-gráficos-en-r" class="level2" data-number="0.8">
<h2 data-number="0.8" class="anchored" data-anchor-id="otros-paquetes-de-gráficos-en-r"><span class="header-section-number">0.8</span> Otros paquetes de gráficos en R</h2>
<ul>
<li><strong>ggvis</strong> (ggplots interactivos)</li>
<li><strong>vcd</strong> (Warnes 2015)</li>
<li><strong>plotrix</strong> (Lemon et al.&nbsp;2006)</li>
<li><strong>gplots</strong> (Warnes 2015)</li>
</ul>
<p>Consulte la <a href="http://cran.r-project.org/web/views/Graphics.html">CRAN Graphics Task View</a> para obtener una lista más completa de herramientas gráficas en <strong>R</strong>.</p>
<hr>
<p>&nbsp;</p>
</section>
<section id="references" class="level2" data-number="0.9">
<h2 data-number="0.9" class="anchored" data-anchor-id="references"><span class="header-section-number">0.9</span> References</h2>
<ul>
<li>Lemon J (2006) Plotrix: a package in the red light district of R. R-News 6(4):8–12</li>
<li>Warnes GR, Bolker B, Bonebakker L, Gentleman R, Liaw WHA, Lumley T, Maechler M, Magnusson A, Moeller S, Schwartz M, Venables B (2015) gplots: various R programming tools for plotting data. R package version 2.17.0. https://CRAN.R-project.org/package=gplots</li>
<li>Wickham H (2010) A layered grammar of graphics. J Comput Graph Stat 19(1):3–28</li>
<li>Wilkinson L (2005) The grammar of graphics. Statistics and computing, 2nd edn. Springer, New York</li>
</ul>
<hr>
<hr>
<p><font size="4">Información de la sesión</font></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.1 (2023-06-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3 
LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3;  LAPACK version 3.9.0

locale:
 [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=pt_BR.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=pt_BR.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

time zone: America/Costa_Rica
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] scales_1.2.1       viridis_0.6.4      viridisLite_0.4.2  MASS_7.3-60       
[5] RColorBrewer_1.1-3 ggplot2_3.4.4      knitr_1.45         kableExtra_1.3.4  

loaded via a namespace (and not attached):
 [1] utf8_1.2.4        generics_0.1.3    xml2_1.3.5        stringi_1.7.12   
 [5] lattice_0.22-5    digest_0.6.33     magrittr_2.0.3    evaluate_0.23    
 [9] grid_4.3.1        fastmap_1.1.1     jsonlite_1.8.7    Matrix_1.6-2     
[13] gridExtra_2.3     httr_1.4.7        rvest_1.0.3       mgcv_1.9-0       
[17] fansi_1.0.5       isoband_0.2.7     textshaping_0.3.7 cli_3.6.1        
[21] rlang_1.1.2       munsell_0.5.0     splines_4.3.1     withr_2.5.2      
[25] yaml_2.3.7        tools_4.3.1       dplyr_1.1.3       colorspace_2.1-0 
[29] webshot_0.5.5     vctrs_0.6.4       R6_2.5.1          lifecycle_1.0.4  
[33] stringr_1.5.0     htmlwidgets_1.6.2 ragg_1.2.6        pkgconfig_2.0.3  
[37] pillar_1.9.0      gtable_0.3.4      glue_1.6.2        systemfonts_1.0.5
[41] highr_0.10        xfun_0.41         tibble_3.2.1      tidyselect_1.2.0 
[45] rstudioapi_0.15.0 farver_2.1.1      htmltools_0.5.7   nlme_3.1-163     
[49] rmarkdown_2.25    svglite_2.1.2     labeling_0.4.3    compiler_4.3.1   </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/marce10\.github\.io\/R_avanzado_2023\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb49" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1"></a><span class="co">---</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="an">title:</span><span class="co"> &lt;font size="7"&gt;&lt;b&gt;Gráficos con ggplot2&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="an">toc-depth:</span><span class="co"> 2</span></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="an">highlight-style:</span><span class="co"> pygments</span></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="an">format:</span></span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="co">  html:</span></span>
<span id="cb49-10"><a href="#cb49-10"></a><span class="co">    df-print: kable</span></span>
<span id="cb49-11"><a href="#cb49-11"></a><span class="co">    code-fold: show</span></span>
<span id="cb49-12"><a href="#cb49-12"></a><span class="co">    code-tools: true</span></span>
<span id="cb49-13"><a href="#cb49-13"></a><span class="co">    css: styles.css</span></span>
<span id="cb49-14"><a href="#cb49-14"></a><span class="co">    link-external-icon: false</span></span>
<span id="cb49-15"><a href="#cb49-15"></a><span class="co">    link-external-newwindow: true  </span></span>
<span id="cb49-16"><a href="#cb49-16"></a><span class="co">---</span></span>
<span id="cb49-17"><a href="#cb49-17"></a></span>
<span id="cb49-18"><a href="#cb49-18"></a><span class="in">```{=html}</span></span>
<span id="cb49-19"><a href="#cb49-19"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb49-20"><a href="#cb49-20"></a><span class="in">body</span></span>
<span id="cb49-21"><a href="#cb49-21"></a><span class="in">  { counter-reset: source-line 0; }</span></span>
<span id="cb49-22"><a href="#cb49-22"></a><span class="in">pre.numberSource code</span></span>
<span id="cb49-23"><a href="#cb49-23"></a><span class="in">  { counter-reset: none; }</span></span>
<span id="cb49-24"><a href="#cb49-24"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb49-25"><a href="#cb49-25"></a><span class="in">```</span></span>
<span id="cb49-26"><a href="#cb49-26"></a></span>
<span id="cb49-27"><a href="#cb49-27"></a><span class="in">```{r,echo=FALSE,message=FALSE}</span></span>
<span id="cb49-28"><a href="#cb49-28"></a></span>
<span id="cb49-29"><a href="#cb49-29"></a><span class="in">options("digits" = 5)</span></span>
<span id="cb49-30"><a href="#cb49-30"></a><span class="in">options("digits.secs" = 3)</span></span>
<span id="cb49-31"><a href="#cb49-31"></a></span>
<span id="cb49-32"><a href="#cb49-32"></a><span class="in"># options to customize chunk outputs</span></span>
<span id="cb49-33"><a href="#cb49-33"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb49-34"><a href="#cb49-34"></a><span class="in">  class.source = "numberLines lineAnchors", # for code line numbers</span></span>
<span id="cb49-35"><a href="#cb49-35"></a><span class="in">  message = FALSE</span></span>
<span id="cb49-36"><a href="#cb49-36"></a><span class="in">)</span></span>
<span id="cb49-37"><a href="#cb49-37"></a></span>
<span id="cb49-38"><a href="#cb49-38"></a><span class="in">x &lt;- c("kableExtra", "knitr", "ggplot2", "RColorBrewer", "knitr", "MASS", "viridis")</span></span>
<span id="cb49-39"><a href="#cb49-39"></a></span>
<span id="cb49-40"><a href="#cb49-40"></a><span class="in">aa &lt;- lapply(x, function(y) {</span></span>
<span id="cb49-41"><a href="#cb49-41"></a><span class="in">  if (!y %in% installed.packages()[, "Package"]) {</span></span>
<span id="cb49-42"><a href="#cb49-42"></a><span class="in">    if (!y %in% c("warbleR", "Rraven")) install.packages(y) else devtools::install_github(paste0("maRce10/", y))</span></span>
<span id="cb49-43"><a href="#cb49-43"></a><span class="in">  }</span></span>
<span id="cb49-44"><a href="#cb49-44"></a><span class="in">  try(require(y, character.only = T), silent = T)</span></span>
<span id="cb49-45"><a href="#cb49-45"></a><span class="in">})</span></span>
<span id="cb49-46"><a href="#cb49-46"></a></span>
<span id="cb49-47"><a href="#cb49-47"></a></span>
<span id="cb49-48"><a href="#cb49-48"></a><span class="in"># ggplot settings</span></span>
<span id="cb49-49"><a href="#cb49-49"></a><span class="in">geom_histogram &lt;- function(...) ggplot2::geom_histogram(..., fill = viridis(10, alpha = 0.5)[8], show.legend = FALSE, bins = 20, color = "black")</span></span>
<span id="cb49-50"><a href="#cb49-50"></a></span>
<span id="cb49-51"><a href="#cb49-51"></a><span class="in">geom_smooth &lt;- function(...) ggplot2::geom_smooth(..., color = viridis(10, alpha = 0.5)[8])</span></span>
<span id="cb49-52"><a href="#cb49-52"></a></span>
<span id="cb49-53"><a href="#cb49-53"></a><span class="in">geom_boxplot &lt;- function(...) ggplot2::geom_boxplot(..., fill = viridis(10, alpha = 0.5)[7])</span></span>
<span id="cb49-54"><a href="#cb49-54"></a></span>
<span id="cb49-55"><a href="#cb49-55"></a><span class="in">theme_set(theme_classic(base_size = 20))</span></span>
<span id="cb49-56"><a href="#cb49-56"></a><span class="in">```</span></span>
<span id="cb49-57"><a href="#cb49-57"></a></span>
<span id="cb49-58"><a href="#cb49-58"></a></span>
<span id="cb49-59"><a href="#cb49-59"></a><span class="in">```{r functions and data, eval=T, echo=F}</span></span>
<span id="cb49-60"><a href="#cb49-60"></a></span>
<span id="cb49-61"><a href="#cb49-61"></a><span class="in">hylaeformis_data &lt;- read.csv(</span></span>
<span id="cb49-62"><a href="#cb49-62"></a><span class="in">  paste0("https://raw.githubusercontent.com/maRce10/", "r_avanzado_2023/master/data/hylaeformis_data.csv")</span></span>
<span id="cb49-63"><a href="#cb49-63"></a><span class="in">)</span></span>
<span id="cb49-64"><a href="#cb49-64"></a><span class="in">```</span></span>
<span id="cb49-65"><a href="#cb49-65"></a></span>
<span id="cb49-66"><a href="#cb49-66"></a>::: {.alert .alert-info}</span>
<span id="cb49-67"><a href="#cb49-67"></a><span class="fu"># Objetivos del manual {.unnumbered .unlisted}</span></span>
<span id="cb49-68"><a href="#cb49-68"></a></span>
<span id="cb49-69"><a href="#cb49-69"></a><span class="ss">-   </span>Comprender la lógica detras de la estructura los gráficos con ggplot2</span>
<span id="cb49-70"><a href="#cb49-70"></a></span>
<span id="cb49-71"><a href="#cb49-71"></a><span class="ss">-   </span>Ser capaz de intregrar en un gŕafico diferentes fuentes de información que representen la complejidad de los datos</span>
<span id="cb49-72"><a href="#cb49-72"></a></span>
<span id="cb49-73"><a href="#cb49-73"></a>:::</span>
<span id="cb49-74"><a href="#cb49-74"></a></span>
<span id="cb49-75"><a href="#cb49-75"></a>&nbsp;</span>
<span id="cb49-76"><a href="#cb49-76"></a></span>
<span id="cb49-77"><a href="#cb49-77"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-78"><a href="#cb49-78"></a></span>
<span id="cb49-79"><a href="#cb49-79"></a>&lt;div class="alert alert-warning"&gt;</span>
<span id="cb49-80"><a href="#cb49-80"></a></span>
<span id="cb49-81"><a href="#cb49-81"></a><span class="fu">## ggplot2 {.unnumbered .unlisted}</span></span>
<span id="cb49-82"><a href="#cb49-82"></a></span>
<span id="cb49-83"><a href="#cb49-83"></a><span class="ss">  - </span>Un paquete de R diseñado específicamente para producir gráficos</span>
<span id="cb49-84"><a href="#cb49-84"></a></span>
<span id="cb49-85"><a href="#cb49-85"></a><span class="ss">  - </span>A diferencia de otros paquetes, ggplot2 tiene su propia gramática</span>
<span id="cb49-86"><a href="#cb49-86"></a></span>
<span id="cb49-87"><a href="#cb49-87"></a><span class="ss">  - </span>La gramática se basa en la "Gramática de los gráficos" (Wilkinson 2005)</span>
<span id="cb49-88"><a href="#cb49-88"></a></span>
<span id="cb49-89"><a href="#cb49-89"></a><span class="ss">  - </span>Módulos independientes que pueden combinarse de muchas formas</span>
<span id="cb49-90"><a href="#cb49-90"></a></span>
<span id="cb49-91"><a href="#cb49-91"></a><span class="ss">  - </span>Esta gramática proporciona una gran flexibilidad</span>
<span id="cb49-92"><a href="#cb49-92"></a></span>
<span id="cb49-93"><a href="#cb49-93"></a>&lt;/div&gt;</span>
<span id="cb49-94"><a href="#cb49-94"></a></span>
<span id="cb49-95"><a href="#cb49-95"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-96"><a href="#cb49-96"></a></span>
<span id="cb49-97"><a href="#cb49-97"></a><span class="fu">## Gramática de gráficos</span></span>
<span id="cb49-98"><a href="#cb49-98"></a></span>
<span id="cb49-99"><a href="#cb49-99"></a>La idea principal es empezar con una capa base de datos brutos y luego añadir más capas de anotaciones y resúmenes estadísticos. El paquete nos permite producir gráficos utilizando la misma estructura de pensamiento que utilizamos al diseñar un análisis, reduciendo la distancia de cómo visualizamos un gráfico en la cabeza y el producto final.</span>
<span id="cb49-100"><a href="#cb49-100"></a></span>
<span id="cb49-101"><a href="#cb49-101"></a>Aprender la gramática no sólo es útil para producir un gráfico de interés, sino también para pensar en otros gráficos más complejos. La ventaja de esta gramática es la posibilidad de crear nuevos gráficos compuestos por nuevas combinaciones de elementos.</span>
<span id="cb49-102"><a href="#cb49-102"></a></span>
<span id="cb49-103"><a href="#cb49-103"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-104"><a href="#cb49-104"></a></span>
<span id="cb49-105"><a href="#cb49-105"></a><span class="fu">## Componentes del gráfico</span></span>
<span id="cb49-106"><a href="#cb49-106"></a></span>
<span id="cb49-107"><a href="#cb49-107"></a>Todos los gráficos ggplot2 contienen los siguientes componentes:</span>
<span id="cb49-108"><a href="#cb49-108"></a></span>
<span id="cb49-109"><a href="#cb49-109"></a><span class="ss">  - </span>**Datos** - El objeto R con la información que necesita ser trazada</span>
<span id="cb49-110"><a href="#cb49-110"></a><span class="ss">  - </span>**Capas** - Los datos específicos que serán graficados (ej. 'x' &amp; 'y')</span>
<span id="cb49-111"><a href="#cb49-111"></a><span class="ss">  - </span>**Escala** - Rango de datos a incluir</span>
<span id="cb49-112"><a href="#cb49-112"></a><span class="ss">  - </span>**Coordenadas** - Sistema de coordenadas (no se utiliza muy a menudo)</span>
<span id="cb49-113"><a href="#cb49-113"></a><span class="ss">  - </span>**Parcelas (facets)** - Determina cómo dividir los datos en subparcelas en un multipanel</span>
<span id="cb49-114"><a href="#cb49-114"></a><span class="ss">  - </span>**Tema** - Controla el estilo del gráfico </span>
<span id="cb49-115"><a href="#cb49-115"></a></span>
<span id="cb49-116"><a href="#cb49-116"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-117"><a href="#cb49-117"></a></span>
<span id="cb49-118"><a href="#cb49-118"></a>Estos componentes se juntan utilizando "+".</span>
<span id="cb49-119"><a href="#cb49-119"></a></span>
<span id="cb49-120"><a href="#cb49-120"></a>La sintaxis más habitual incluye los datos dentro de la llamada "ggplot" y una capa "geom_".</span>
<span id="cb49-121"><a href="#cb49-121"></a></span>
<span id="cb49-122"><a href="#cb49-122"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-123"><a href="#cb49-123"></a></span>
<span id="cb49-124"><a href="#cb49-124"></a>Primero instala/carga el paquete:</span>
<span id="cb49-125"><a href="#cb49-125"></a></span>
<span id="cb49-126"><a href="#cb49-126"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb49-127"><a href="#cb49-127"></a></span>
<span id="cb49-128"><a href="#cb49-128"></a><span class="in"># install</span></span>
<span id="cb49-129"><a href="#cb49-129"></a><span class="in">install.packages("ggplot2")</span></span>
<span id="cb49-130"><a href="#cb49-130"></a></span>
<span id="cb49-131"><a href="#cb49-131"></a><span class="in"># load library</span></span>
<span id="cb49-132"><a href="#cb49-132"></a><span class="in">library(ggplot2)</span></span>
<span id="cb49-133"><a href="#cb49-133"></a><span class="in">```</span></span>
<span id="cb49-134"><a href="#cb49-134"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-135"><a href="#cb49-135"></a></span>
<span id="cb49-136"><a href="#cb49-136"></a><span class="fu">## Gráficos de dispersión</span></span>
<span id="cb49-137"><a href="#cb49-137"></a></span>
<span id="cb49-138"><a href="#cb49-138"></a>Utilicemos el conjunto de datos "iris" para crear gráficos de dispersión:</span>
<span id="cb49-139"><a href="#cb49-139"></a></span>
<span id="cb49-142"><a href="#cb49-142"></a><span class="in">```{r}</span></span>
<span id="cb49-143"><a href="#cb49-143"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-144"><a href="#cb49-144"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb49-145"><a href="#cb49-145"></a><span class="in">```</span></span>
<span id="cb49-146"><a href="#cb49-146"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-147"><a href="#cb49-147"></a></span>
<span id="cb49-148"><a href="#cb49-148"></a>This plot is defined by 3 components:</span>
<span id="cb49-149"><a href="#cb49-149"></a><span class="ss">  1. </span>"data"- iris</span>
<span id="cb49-150"><a href="#cb49-150"></a><span class="ss">  1. </span>"aes" - Sepal.length vs Petal.length</span>
<span id="cb49-151"><a href="#cb49-151"></a><span class="ss">  1. </span>"layer" - Points (geom)</span>
<span id="cb49-152"><a href="#cb49-152"></a></span>
<span id="cb49-153"><a href="#cb49-153"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-154"><a href="#cb49-154"></a></span>
<span id="cb49-155"><a href="#cb49-155"></a><span class="fu">## Atributos estéticos</span></span>
<span id="cb49-156"><a href="#cb49-156"></a></span>
<span id="cb49-157"><a href="#cb49-157"></a>También podemos añadir otros atributos estéticos como el color, la forma y el tamaño. Estos atributos se pueden incluir dentro de <span class="in">`aes()`</span>:</span>
<span id="cb49-158"><a href="#cb49-158"></a></span>
<span id="cb49-161"><a href="#cb49-161"></a><span class="in">```{r}</span></span>
<span id="cb49-162"><a href="#cb49-162"></a><span class="co"># color by species</span></span>
<span id="cb49-163"><a href="#cb49-163"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-164"><a href="#cb49-164"></a>  <span class="at">data =</span> iris,</span>
<span id="cb49-165"><a href="#cb49-165"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length, <span class="at">color =</span> Species)</span>
<span id="cb49-166"><a href="#cb49-166"></a>) <span class="sc">+</span></span>
<span id="cb49-167"><a href="#cb49-167"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb49-168"><a href="#cb49-168"></a></span>
<span id="cb49-169"><a href="#cb49-169"></a><span class="co"># color and shape by species</span></span>
<span id="cb49-170"><a href="#cb49-170"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-171"><a href="#cb49-171"></a>  <span class="at">data =</span> iris,</span>
<span id="cb49-172"><a href="#cb49-172"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb49-173"><a href="#cb49-173"></a>    <span class="at">x =</span> Sepal.Length,</span>
<span id="cb49-174"><a href="#cb49-174"></a>    <span class="at">y =</span> Petal.Length,</span>
<span id="cb49-175"><a href="#cb49-175"></a>    <span class="at">color =</span> Species,</span>
<span id="cb49-176"><a href="#cb49-176"></a>    <span class="at">shape =</span> Species</span>
<span id="cb49-177"><a href="#cb49-177"></a>  )</span>
<span id="cb49-178"><a href="#cb49-178"></a>) <span class="sc">+</span></span>
<span id="cb49-179"><a href="#cb49-179"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb49-180"><a href="#cb49-180"></a><span class="in">```</span></span>
<span id="cb49-181"><a href="#cb49-181"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-182"><a href="#cb49-182"></a></span>
<span id="cb49-183"><a href="#cb49-183"></a>Tenga en cuenta que los argumentos estéticos también pueden incluirse en la capa "geom":</span>
<span id="cb49-184"><a href="#cb49-184"></a></span>
<span id="cb49-187"><a href="#cb49-187"></a><span class="in">```{r}</span></span>
<span id="cb49-188"><a href="#cb49-188"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-189"><a href="#cb49-189"></a>  <span class="at">data =</span> iris,</span>
<span id="cb49-190"><a href="#cb49-190"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)</span>
<span id="cb49-191"><a href="#cb49-191"></a>) <span class="sc">+</span></span>
<span id="cb49-192"><a href="#cb49-192"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species))</span>
<span id="cb49-193"><a href="#cb49-193"></a><span class="in">```</span></span>
<span id="cb49-194"><a href="#cb49-194"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-195"><a href="#cb49-195"></a></span>
<span id="cb49-196"><a href="#cb49-196"></a></span>
<span id="cb49-197"><a href="#cb49-197"></a>También podemos incluir un valor fijo:</span>
<span id="cb49-198"><a href="#cb49-198"></a></span>
<span id="cb49-201"><a href="#cb49-201"></a><span class="in">```{r}</span></span>
<span id="cb49-202"><a href="#cb49-202"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-203"><a href="#cb49-203"></a>  <span class="at">data =</span> iris,</span>
<span id="cb49-204"><a href="#cb49-204"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)</span>
<span id="cb49-205"><a href="#cb49-205"></a>) <span class="sc">+</span></span>
<span id="cb49-206"><a href="#cb49-206"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red2"</span>)</span>
<span id="cb49-207"><a href="#cb49-207"></a><span class="in">```</span></span>
<span id="cb49-208"><a href="#cb49-208"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-209"><a href="#cb49-209"></a></span>
<span id="cb49-210"><a href="#cb49-210"></a>Algunos atributos funcionan mejor con algunos tipos de datos:</span>
<span id="cb49-211"><a href="#cb49-211"></a></span>
<span id="cb49-212"><a href="#cb49-212"></a><span class="ss">  - </span>Color y forma: variables categóricas</span>
<span id="cb49-213"><a href="#cb49-213"></a><span class="ss">  - </span>Tamaño: variables continuas</span>
<span id="cb49-214"><a href="#cb49-214"></a></span>
<span id="cb49-215"><a href="#cb49-215"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-216"><a href="#cb49-216"></a></span>
<span id="cb49-217"><a href="#cb49-217"></a></span>
<span id="cb49-218"><a href="#cb49-218"></a>&lt;/br&gt;</span>
<span id="cb49-219"><a href="#cb49-219"></a></span>
<span id="cb49-220"><a href="#cb49-220"></a>&lt;div class="alert alert-info"&gt;</span>
<span id="cb49-221"><a href="#cb49-221"></a></span>
<span id="cb49-222"><a href="#cb49-222"></a>&lt;font size="5"&gt;Ejercicio 1&lt;/font&gt; </span>
<span id="cb49-223"><a href="#cb49-223"></a></span>
<span id="cb49-224"><a href="#cb49-224"></a>Utilizando el conjunto de datos "hylaeformis":</span>
<span id="cb49-225"><a href="#cb49-225"></a></span>
<span id="cb49-226"><a href="#cb49-226"></a><span class="in">```{r,  eval=F, echo=T}</span></span>
<span id="cb49-227"><a href="#cb49-227"></a></span>
<span id="cb49-228"><a href="#cb49-228"></a><span class="in"># lear desde el sitio del curso</span></span>
<span id="cb49-229"><a href="#cb49-229"></a><span class="in">hylaeformis_data &lt;- read.csv(</span></span>
<span id="cb49-230"><a href="#cb49-230"></a><span class="in">  paste0("https://raw.githubusercontent.com/maRce10/", "r_avanzado_2023/master/data/hylaeformis_data.csv")</span></span>
<span id="cb49-231"><a href="#cb49-231"></a><span class="in">)</span></span>
<span id="cb49-232"><a href="#cb49-232"></a></span>
<span id="cb49-233"><a href="#cb49-233"></a><span class="in"># or bajar manualmente y leer copia local</span></span>
<span id="cb49-234"><a href="#cb49-234"></a><span class="in">hylaeformis_data &lt;- read.csv("hylaeformis_data.csv", stringsAsFactors = FALSE)</span></span>
<span id="cb49-235"><a href="#cb49-235"></a></span>
<span id="cb49-236"><a href="#cb49-236"></a><span class="in">head(hylaeformis_data, 20)</span></span>
<span id="cb49-237"><a href="#cb49-237"></a><span class="in">```</span></span>
<span id="cb49-238"><a href="#cb49-238"></a></span>
<span id="cb49-239"><a href="#cb49-239"></a>&lt;/br&gt;</span>
<span id="cb49-240"><a href="#cb49-240"></a></span>
<span id="cb49-241"><a href="#cb49-241"></a>1.1 Create a scatter plot of  vs "meanfreq" (mean frequency)</span>
<span id="cb49-242"><a href="#cb49-242"></a></span>
<span id="cb49-243"><a href="#cb49-243"></a>1.1 Crear un gráfico de dispersión de duración ("duration") vs frecuencia promedio ("meanfreq")</span>
<span id="cb49-244"><a href="#cb49-244"></a></span>
<span id="cb49-245"><a href="#cb49-245"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-246"><a href="#cb49-246"></a></span>
<span id="cb49-247"><a href="#cb49-247"></a><span class="in">ggplot(</span></span>
<span id="cb49-248"><a href="#cb49-248"></a><span class="in">  data = hylaeformis_data,</span></span>
<span id="cb49-249"><a href="#cb49-249"></a><span class="in">  mapping = aes(x = duration, y = meanfreq)</span></span>
<span id="cb49-250"><a href="#cb49-250"></a><span class="in">) +</span></span>
<span id="cb49-251"><a href="#cb49-251"></a><span class="in">  geom_point()</span></span>
<span id="cb49-252"><a href="#cb49-252"></a><span class="in">```</span></span>
<span id="cb49-253"><a href="#cb49-253"></a></span>
<span id="cb49-254"><a href="#cb49-254"></a>&lt;/br&gt;</span>
<span id="cb49-255"><a href="#cb49-255"></a></span>
<span id="cb49-256"><a href="#cb49-256"></a>1.2 Añadir un atributo estético para mostrar un color diferente para cada localidad</span>
<span id="cb49-257"><a href="#cb49-257"></a></span>
<span id="cb49-258"><a href="#cb49-258"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-259"><a href="#cb49-259"></a></span>
<span id="cb49-260"><a href="#cb49-260"></a><span class="in">ggplot(</span></span>
<span id="cb49-261"><a href="#cb49-261"></a><span class="in">  data = hylaeformis_data,</span></span>
<span id="cb49-262"><a href="#cb49-262"></a><span class="in">  mapping = aes(x = duration, y = meanfreq)</span></span>
<span id="cb49-263"><a href="#cb49-263"></a><span class="in">) +</span></span>
<span id="cb49-264"><a href="#cb49-264"></a><span class="in">  geom_point(aes(color = Locality))</span></span>
<span id="cb49-265"><a href="#cb49-265"></a><span class="in">```</span></span>
<span id="cb49-266"><a href="#cb49-266"></a></span>
<span id="cb49-267"><a href="#cb49-267"></a>&lt;/br&gt;</span>
<span id="cb49-268"><a href="#cb49-268"></a></span>
<span id="cb49-269"><a href="#cb49-269"></a>1.3 Añade otro atributo estético para mostrar el rango de frecuencia dominante ("dfrange") como tamaño los símbolos</span>
<span id="cb49-270"><a href="#cb49-270"></a></span>
<span id="cb49-271"><a href="#cb49-271"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-272"><a href="#cb49-272"></a></span>
<span id="cb49-273"><a href="#cb49-273"></a><span class="in">ggplot(</span></span>
<span id="cb49-274"><a href="#cb49-274"></a><span class="in">  data = hylaeformis_data,</span></span>
<span id="cb49-275"><a href="#cb49-275"></a><span class="in">  mapping = aes(x = duration, y = meanfreq)</span></span>
<span id="cb49-276"><a href="#cb49-276"></a><span class="in">) +</span></span>
<span id="cb49-277"><a href="#cb49-277"></a><span class="in">  geom_point(aes(color = Locality, size = dfrange))</span></span>
<span id="cb49-278"><a href="#cb49-278"></a><span class="in">```</span></span>
<span id="cb49-279"><a href="#cb49-279"></a></span>
<span id="cb49-280"><a href="#cb49-280"></a>&lt;/br&gt;</span>
<span id="cb49-281"><a href="#cb49-281"></a></span>
<span id="cb49-282"><a href="#cb49-282"></a>&lt;/div&gt;</span>
<span id="cb49-283"><a href="#cb49-283"></a></span>
<span id="cb49-284"><a href="#cb49-284"></a><span class="dv">&amp;nbsp;</span></span>
<span id="cb49-285"><a href="#cb49-285"></a></span>
<span id="cb49-286"><a href="#cb49-286"></a><span class="fu">## Gráficos multipanel (Facetting)</span></span>
<span id="cb49-287"><a href="#cb49-287"></a></span>
<span id="cb49-288"><a href="#cb49-288"></a><span class="ss">  - </span>Otra forma de visualizar variables categóricas</span>
<span id="cb49-289"><a href="#cb49-289"></a><span class="ss">  - </span>Permite crear gráficos multipanel para cada nivel de la variable</span>
<span id="cb49-290"><a href="#cb49-290"></a><span class="ss">  - </span>2 tipos: "grid" &amp; "wrap"</span>
<span id="cb49-291"><a href="#cb49-291"></a>  </span>
<span id="cb49-294"><a href="#cb49-294"></a><span class="in">```{r}</span></span>
<span id="cb49-295"><a href="#cb49-295"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-296"><a href="#cb49-296"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-297"><a href="#cb49-297"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species)</span>
<span id="cb49-298"><a href="#cb49-298"></a></span>
<span id="cb49-299"><a href="#cb49-299"></a><span class="co"># o</span></span>
<span id="cb49-300"><a href="#cb49-300"></a></span>
<span id="cb49-301"><a href="#cb49-301"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-302"><a href="#cb49-302"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-303"><a href="#cb49-303"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Species)</span>
<span id="cb49-304"><a href="#cb49-304"></a><span class="in">```</span></span>
<span id="cb49-305"><a href="#cb49-305"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-306"><a href="#cb49-306"></a></span>
<span id="cb49-307"><a href="#cb49-307"></a></span>
<span id="cb49-308"><a href="#cb49-308"></a>La escala puede ser fija o libre para los ejes _x_ e _y_, y puede modificarse el número de columnas y filas:</span>
<span id="cb49-309"><a href="#cb49-309"></a></span>
<span id="cb49-312"><a href="#cb49-312"></a><span class="in">```{r}</span></span>
<span id="cb49-313"><a href="#cb49-313"></a><span class="co"># free x</span></span>
<span id="cb49-314"><a href="#cb49-314"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-315"><a href="#cb49-315"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-316"><a href="#cb49-316"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free_x"</span>)</span>
<span id="cb49-317"><a href="#cb49-317"></a><span class="in">```</span></span>
<span id="cb49-318"><a href="#cb49-318"></a></span>
<span id="cb49-319"><a href="#cb49-319"></a></span>
<span id="cb49-320"><a href="#cb49-320"></a><span class="in">```{r, fig.height=8}</span></span>
<span id="cb49-321"><a href="#cb49-321"></a><span class="in"># free x and 3 rows</span></span>
<span id="cb49-322"><a href="#cb49-322"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) +</span></span>
<span id="cb49-323"><a href="#cb49-323"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-324"><a href="#cb49-324"></a><span class="in">  facet_wrap(~Species, scales = "free_y", nrow = 3)</span></span>
<span id="cb49-325"><a href="#cb49-325"></a><span class="in">```</span></span>
<span id="cb49-326"><a href="#cb49-326"></a></span>
<span id="cb49-327"><a href="#cb49-327"></a></span>
<span id="cb49-328"><a href="#cb49-328"></a><span class="in">```{r, fig.height=6}</span></span>
<span id="cb49-329"><a href="#cb49-329"></a><span class="in"># both free and 2 rows</span></span>
<span id="cb49-330"><a href="#cb49-330"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) +</span></span>
<span id="cb49-331"><a href="#cb49-331"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-332"><a href="#cb49-332"></a><span class="in">  facet_wrap(~Species, scales = "free", nrow = 2)</span></span>
<span id="cb49-333"><a href="#cb49-333"></a><span class="in">```</span></span>
<span id="cb49-334"><a href="#cb49-334"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-335"><a href="#cb49-335"></a></span>
<span id="cb49-336"><a href="#cb49-336"></a>Tenga en cuenta que también podemos guardar el componente básico como un objeto **R** y añadir otros componentes más adelante en el código:</span>
<span id="cb49-337"><a href="#cb49-337"></a></span>
<span id="cb49-338"><a href="#cb49-338"></a><span class="in">```{r, fig.height=8}</span></span>
<span id="cb49-339"><a href="#cb49-339"></a></span>
<span id="cb49-340"><a href="#cb49-340"></a><span class="in">p &lt;- ggplot(iris, aes(Sepal.Length, Petal.Length)) +</span></span>
<span id="cb49-341"><a href="#cb49-341"></a><span class="in">  geom_point()</span></span>
<span id="cb49-342"><a href="#cb49-342"></a></span>
<span id="cb49-343"><a href="#cb49-343"></a><span class="in">p + facet_wrap(~Species, scales = "free_x", nrow = 3)</span></span>
<span id="cb49-344"><a href="#cb49-344"></a><span class="in">```</span></span>
<span id="cb49-345"><a href="#cb49-345"></a></span>
<span id="cb49-346"><a href="#cb49-346"></a></span>
<span id="cb49-347"><a href="#cb49-347"></a><span class="fu">## "geoms" adicionales</span></span>
<span id="cb49-348"><a href="#cb49-348"></a></span>
<span id="cb49-349"><a href="#cb49-349"></a><span class="ss">- </span><span class="in">`geom_smooth()`</span> - añade las líneas de mejor ajuste (incluyendo CI)</span>
<span id="cb49-350"><a href="#cb49-350"></a><span class="ss">- </span><span class="in">`geom_boxplot()`</span> - Distribución de frecuencias </span>
<span id="cb49-351"><a href="#cb49-351"></a><span class="ss">- </span><span class="in">`geom_histogram()`</span> &amp; <span class="in">`geom_freqpoly()`</span> - distribuciones de frecuencia</span>
<span id="cb49-352"><a href="#cb49-352"></a><span class="ss">- </span><span class="in">`geom_bar()`</span> - distribución de frecuencias de variables categóricas</span>
<span id="cb49-353"><a href="#cb49-353"></a><span class="ss">- </span><span class="in">`geom_path()`</span> &amp; <span class="in">`geom_line()`</span> - añade líneas a los gráficos de dispersión</span>
<span id="cb49-354"><a href="#cb49-354"></a></span>
<span id="cb49-355"><a href="#cb49-355"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-356"><a href="#cb49-356"></a></span>
<span id="cb49-357"><a href="#cb49-357"></a><span class="fu">### geom_smooth()</span></span>
<span id="cb49-358"><a href="#cb49-358"></a></span>
<span id="cb49-359"><a href="#cb49-359"></a>Las líneas de regresión de mejor ajuste pueden añadirse con <span class="in">`geom_smooth()`</span>:</span>
<span id="cb49-360"><a href="#cb49-360"></a></span>
<span id="cb49-361"><a href="#cb49-361"></a><span class="in">```{r, fig.height=8}</span></span>
<span id="cb49-362"><a href="#cb49-362"></a></span>
<span id="cb49-363"><a href="#cb49-363"></a><span class="in"># con CI</span></span>
<span id="cb49-364"><a href="#cb49-364"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) +</span></span>
<span id="cb49-365"><a href="#cb49-365"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-366"><a href="#cb49-366"></a><span class="in">  geom_smooth(method = "lm") +</span></span>
<span id="cb49-367"><a href="#cb49-367"></a><span class="in">  facet_wrap(~Species, scales = "free", nrow = 3)</span></span>
<span id="cb49-368"><a href="#cb49-368"></a></span>
<span id="cb49-369"><a href="#cb49-369"></a><span class="in"># sin CI</span></span>
<span id="cb49-370"><a href="#cb49-370"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) +</span></span>
<span id="cb49-371"><a href="#cb49-371"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-372"><a href="#cb49-372"></a><span class="in">  geom_smooth(method = "lm", se = FALSE) +</span></span>
<span id="cb49-373"><a href="#cb49-373"></a><span class="in">  facet_wrap(~Species, scales = "free", nrow = 3)</span></span>
<span id="cb49-374"><a href="#cb49-374"></a><span class="in">```</span></span>
<span id="cb49-375"><a href="#cb49-375"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-376"><a href="#cb49-376"></a></span>
<span id="cb49-377"><a href="#cb49-377"></a>&lt;div class="alert alert-info"&gt;</span>
<span id="cb49-378"><a href="#cb49-378"></a></span>
<span id="cb49-379"><a href="#cb49-379"></a>&lt;font size="5"&gt;Ejercicio 2&lt;/font&gt; </span>
<span id="cb49-380"><a href="#cb49-380"></a></span>
<span id="cb49-381"><a href="#cb49-381"></a>Utilizando el conjunto de datos de ejemplo "msleep":</span>
<span id="cb49-382"><a href="#cb49-382"></a></span>
<span id="cb49-383"><a href="#cb49-383"></a>&lt;/br&gt;</span>
<span id="cb49-384"><a href="#cb49-384"></a></span>
<span id="cb49-385"><a href="#cb49-385"></a>2.1 Crear un gráfico de dispersión de peso corporal ("bodywt") frente a peso cerebral ("brainwt")</span>
<span id="cb49-386"><a href="#cb49-386"></a></span>
<span id="cb49-387"><a href="#cb49-387"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-388"><a href="#cb49-388"></a></span>
<span id="cb49-389"><a href="#cb49-389"></a><span class="in">data(msleep)</span></span>
<span id="cb49-390"><a href="#cb49-390"></a><span class="in">ggplot(</span></span>
<span id="cb49-391"><a href="#cb49-391"></a><span class="in">  data = msleep,</span></span>
<span id="cb49-392"><a href="#cb49-392"></a><span class="in">  mapping = aes(x = bodywt, y = brainwt)</span></span>
<span id="cb49-393"><a href="#cb49-393"></a><span class="in">) +</span></span>
<span id="cb49-394"><a href="#cb49-394"></a><span class="in">  geom_point()</span></span>
<span id="cb49-395"><a href="#cb49-395"></a><span class="in">```</span></span>
<span id="cb49-396"><a href="#cb49-396"></a></span>
<span id="cb49-397"><a href="#cb49-397"></a>&lt;/br&gt;</span>
<span id="cb49-398"><a href="#cb49-398"></a></span>
<span id="cb49-399"><a href="#cb49-399"></a>2.2 Añadir orden ("order") como estética del color</span>
<span id="cb49-400"><a href="#cb49-400"></a></span>
<span id="cb49-401"><a href="#cb49-401"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-402"><a href="#cb49-402"></a></span>
<span id="cb49-403"><a href="#cb49-403"></a><span class="in">ggplot(</span></span>
<span id="cb49-404"><a href="#cb49-404"></a><span class="in">  data = msleep,</span></span>
<span id="cb49-405"><a href="#cb49-405"></a><span class="in">  mapping = aes(x = bodywt, y = brainwt, color = order)</span></span>
<span id="cb49-406"><a href="#cb49-406"></a><span class="in">) +</span></span>
<span id="cb49-407"><a href="#cb49-407"></a><span class="in">  geom_point()</span></span>
<span id="cb49-408"><a href="#cb49-408"></a><span class="in">```</span></span>
<span id="cb49-409"><a href="#cb49-409"></a></span>
<span id="cb49-410"><a href="#cb49-410"></a>&lt;/br&gt;</span>
<span id="cb49-411"><a href="#cb49-411"></a></span>
<span id="cb49-412"><a href="#cb49-412"></a>2.3 Añadir un componente "faceta" para dividir los gráficos por orden utilizando escalas libres</span>
<span id="cb49-413"><a href="#cb49-413"></a></span>
<span id="cb49-414"><a href="#cb49-414"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-415"><a href="#cb49-415"></a></span>
<span id="cb49-416"><a href="#cb49-416"></a><span class="in">ggplot(</span></span>
<span id="cb49-417"><a href="#cb49-417"></a><span class="in">  data = msleep,</span></span>
<span id="cb49-418"><a href="#cb49-418"></a><span class="in">  mapping = aes(x = bodywt, y = brainwt)</span></span>
<span id="cb49-419"><a href="#cb49-419"></a><span class="in">) +</span></span>
<span id="cb49-420"><a href="#cb49-420"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-421"><a href="#cb49-421"></a><span class="in">  facet_wrap(~order, scales = "free")</span></span>
<span id="cb49-422"><a href="#cb49-422"></a><span class="in">```</span></span>
<span id="cb49-423"><a href="#cb49-423"></a></span>
<span id="cb49-424"><a href="#cb49-424"></a>&lt;/br&gt;</span>
<span id="cb49-425"><a href="#cb49-425"></a></span>
<span id="cb49-426"><a href="#cb49-426"></a>2.4 Elimine los órdenes con menos de 4 especies en el conjunto de datos y haga un gráfico similar al 2.3</span>
<span id="cb49-427"><a href="#cb49-427"></a></span>
<span id="cb49-428"><a href="#cb49-428"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-429"><a href="#cb49-429"></a></span>
<span id="cb49-430"><a href="#cb49-430"></a><span class="in">tab &lt;- table(msleep$order)</span></span>
<span id="cb49-431"><a href="#cb49-431"></a></span>
<span id="cb49-432"><a href="#cb49-432"></a><span class="in">ms2 &lt;- msleep[msleep$order %in% names(tab)[tab &gt;= 5], ]</span></span>
<span id="cb49-433"><a href="#cb49-433"></a></span>
<span id="cb49-434"><a href="#cb49-434"></a><span class="in">ggplot(</span></span>
<span id="cb49-435"><a href="#cb49-435"></a><span class="in">  data = ms2,</span></span>
<span id="cb49-436"><a href="#cb49-436"></a><span class="in">  mapping = aes(x = bodywt, y = brainwt)</span></span>
<span id="cb49-437"><a href="#cb49-437"></a><span class="in">) +</span></span>
<span id="cb49-438"><a href="#cb49-438"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-439"><a href="#cb49-439"></a><span class="in">  geom_smooth(method = "lm") +</span></span>
<span id="cb49-440"><a href="#cb49-440"></a><span class="in">  facet_wrap(~order, scales = "free")</span></span>
<span id="cb49-441"><a href="#cb49-441"></a><span class="in">```</span></span>
<span id="cb49-442"><a href="#cb49-442"></a></span>
<span id="cb49-443"><a href="#cb49-443"></a>&lt;/br&gt;</span>
<span id="cb49-444"><a href="#cb49-444"></a></span>
<span id="cb49-445"><a href="#cb49-445"></a>2.5 Añadir una línea de mejor ajuste a cada gráfico del panel</span>
<span id="cb49-446"><a href="#cb49-446"></a></span>
<span id="cb49-447"><a href="#cb49-447"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb49-448"><a href="#cb49-448"></a></span>
<span id="cb49-449"><a href="#cb49-449"></a><span class="in">ggplot(data = msleep[msleep$order %in% names(tab)[tab &gt; 3], ], mapping = aes(x = bodywt, y = brainwt)) +</span></span>
<span id="cb49-450"><a href="#cb49-450"></a><span class="in">  geom_point() +</span></span>
<span id="cb49-451"><a href="#cb49-451"></a><span class="in">  geom_smooth() +</span></span>
<span id="cb49-452"><a href="#cb49-452"></a><span class="in">  facet_wrap(~order, scales = "free")</span></span>
<span id="cb49-453"><a href="#cb49-453"></a><span class="in">```</span></span>
<span id="cb49-454"><a href="#cb49-454"></a>&lt;/br&gt;</span>
<span id="cb49-455"><a href="#cb49-455"></a></span>
<span id="cb49-456"><a href="#cb49-456"></a>&lt;/div&gt;</span>
<span id="cb49-457"><a href="#cb49-457"></a></span>
<span id="cb49-458"><a href="#cb49-458"></a></span>
<span id="cb49-459"><a href="#cb49-459"></a><span class="fu">### Boxplots</span></span>
<span id="cb49-460"><a href="#cb49-460"></a></span>
<span id="cb49-461"><a href="#cb49-461"></a>De nuevo, sólo se necesita un nuevo componente "geom" para crear un boxplot:</span>
<span id="cb49-462"><a href="#cb49-462"></a></span>
<span id="cb49-465"><a href="#cb49-465"></a><span class="in">```{r}</span></span>
<span id="cb49-466"><a href="#cb49-466"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-467"><a href="#cb49-467"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb49-468"><a href="#cb49-468"></a><span class="in">```</span></span>
<span id="cb49-469"><a href="#cb49-469"></a></span>
<span id="cb49-470"><a href="#cb49-470"></a>Una alternativa interesante son los gráficos de violines:</span>
<span id="cb49-473"><a href="#cb49-473"></a><span class="in">```{r}</span></span>
<span id="cb49-474"><a href="#cb49-474"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-475"><a href="#cb49-475"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb49-476"><a href="#cb49-476"></a><span class="in">```</span></span>
<span id="cb49-477"><a href="#cb49-477"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-478"><a href="#cb49-478"></a></span>
<span id="cb49-479"><a href="#cb49-479"></a><span class="fu">### Histogramas</span></span>
<span id="cb49-480"><a href="#cb49-480"></a></span>
<span id="cb49-481"><a href="#cb49-481"></a>Lo mismo ocurre con los histrogramas y los gráficos de frecuencias:</span>
<span id="cb49-482"><a href="#cb49-482"></a></span>
<span id="cb49-485"><a href="#cb49-485"></a><span class="in">```{r}</span></span>
<span id="cb49-486"><a href="#cb49-486"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-487"><a href="#cb49-487"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb49-488"><a href="#cb49-488"></a></span>
<span id="cb49-489"><a href="#cb49-489"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-490"><a href="#cb49-490"></a>  <span class="fu">geom_freqpoly</span>()</span>
<span id="cb49-491"><a href="#cb49-491"></a></span>
<span id="cb49-492"><a href="#cb49-492"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-493"><a href="#cb49-493"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb49-494"><a href="#cb49-494"></a>  <span class="fu">geom_freqpoly</span>()</span>
<span id="cb49-495"><a href="#cb49-495"></a><span class="in">```</span></span>
<span id="cb49-496"><a href="#cb49-496"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-497"><a href="#cb49-497"></a></span>
<span id="cb49-498"><a href="#cb49-498"></a>Podemos controlar la anchura de las barras:</span>
<span id="cb49-501"><a href="#cb49-501"></a><span class="in">```{r}</span></span>
<span id="cb49-502"><a href="#cb49-502"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-503"><a href="#cb49-503"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"red2"</span>, <span class="at">alpha.f =</span> <span class="fl">0.3</span>))</span>
<span id="cb49-504"><a href="#cb49-504"></a><span class="in">```</span></span>
<span id="cb49-505"><a href="#cb49-505"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-506"><a href="#cb49-506"></a></span>
<span id="cb49-507"><a href="#cb49-507"></a>Y compara la distribución de los distintos grupos dentro del mismo histograma:</span>
<span id="cb49-510"><a href="#cb49-510"></a><span class="in">```{r}</span></span>
<span id="cb49-511"><a href="#cb49-511"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb49-512"><a href="#cb49-512"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.4</span>)</span>
<span id="cb49-513"><a href="#cb49-513"></a><span class="in">```</span></span>
<span id="cb49-514"><a href="#cb49-514"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-515"><a href="#cb49-515"></a></span>
<span id="cb49-516"><a href="#cb49-516"></a><span class="fu">### Gráfico de barras</span></span>
<span id="cb49-517"><a href="#cb49-517"></a></span>
<span id="cb49-518"><a href="#cb49-518"></a>Muestran la distribución de variables discretas (categóricas):</span>
<span id="cb49-519"><a href="#cb49-519"></a></span>
<span id="cb49-522"><a href="#cb49-522"></a><span class="in">```{r}</span></span>
<span id="cb49-523"><a href="#cb49-523"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(msleep<span class="sc">$</span>order)</span>
<span id="cb49-524"><a href="#cb49-524"></a></span>
<span id="cb49-525"><a href="#cb49-525"></a>df <span class="ot">&lt;-</span></span>
<span id="cb49-526"><a href="#cb49-526"></a>  <span class="fu">as.data.frame</span>(<span class="fu">table</span>(msleep<span class="sc">$</span>order[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">3</span>]]))</span>
<span id="cb49-527"><a href="#cb49-527"></a></span>
<span id="cb49-528"><a href="#cb49-528"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span></span>
<span id="cb49-529"><a href="#cb49-529"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span>
<span id="cb49-530"><a href="#cb49-530"></a><span class="in">```</span></span>
<span id="cb49-531"><a href="#cb49-531"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-532"><a href="#cb49-532"></a></span>
<span id="cb49-533"><a href="#cb49-533"></a></span>
<span id="cb49-534"><a href="#cb49-534"></a><span class="in">```{r, eval=F, echo=F}</span></span>
<span id="cb49-535"><a href="#cb49-535"></a></span>
<span id="cb49-536"><a href="#cb49-536"></a><span class="in"># Calcular el promedio del # de reclutas por estación</span></span>
<span id="cb49-537"><a href="#cb49-537"></a><span class="in">df2 &lt;- aggregate(RECRUITS ~ SEASON, df, mean)</span></span>
<span id="cb49-538"><a href="#cb49-538"></a><span class="in">names(df2) &lt;- c("season", "rec")</span></span>
<span id="cb49-539"><a href="#cb49-539"></a></span>
<span id="cb49-540"><a href="#cb49-540"></a><span class="in"># Gráfico de barras</span></span>
<span id="cb49-541"><a href="#cb49-541"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-542"><a href="#cb49-542"></a><span class="in">  geom_bar(stat = "identity")</span></span>
<span id="cb49-543"><a href="#cb49-543"></a><span class="in">p</span></span>
<span id="cb49-544"><a href="#cb49-544"></a></span>
<span id="cb49-545"><a href="#cb49-545"></a><span class="in"># Cambiar la orientación</span></span>
<span id="cb49-546"><a href="#cb49-546"></a><span class="in">p + coord_flip()</span></span>
<span id="cb49-547"><a href="#cb49-547"></a></span>
<span id="cb49-548"><a href="#cb49-548"></a><span class="in">### Cambiar el ancho y colores de las barras ###</span></span>
<span id="cb49-549"><a href="#cb49-549"></a></span>
<span id="cb49-550"><a href="#cb49-550"></a><span class="in"># Cambiar el ancho de las barras</span></span>
<span id="cb49-551"><a href="#cb49-551"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-552"><a href="#cb49-552"></a><span class="in">  geom_bar(stat = "identity", width = 0.5)</span></span>
<span id="cb49-553"><a href="#cb49-553"></a></span>
<span id="cb49-554"><a href="#cb49-554"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-555"><a href="#cb49-555"></a><span class="in">  geom_bar(stat = "identity", width = 0.2)</span></span>
<span id="cb49-556"><a href="#cb49-556"></a></span>
<span id="cb49-557"><a href="#cb49-557"></a><span class="in"># Cambiar colores</span></span>
<span id="cb49-558"><a href="#cb49-558"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-559"><a href="#cb49-559"></a><span class="in">  geom_bar(stat = "identity", color = "blue", fill = "white")</span></span>
<span id="cb49-560"><a href="#cb49-560"></a></span>
<span id="cb49-561"><a href="#cb49-561"></a><span class="in"># Remover el tema y agregar barras azules</span></span>
<span id="cb49-562"><a href="#cb49-562"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-563"><a href="#cb49-563"></a><span class="in">  geom_bar(stat = "identity", fill = "steelblue") +</span></span>
<span id="cb49-564"><a href="#cb49-564"></a><span class="in">  theme_minimal()</span></span>
<span id="cb49-565"><a href="#cb49-565"></a><span class="in">p</span></span>
<span id="cb49-566"><a href="#cb49-566"></a></span>
<span id="cb49-567"><a href="#cb49-567"></a><span class="in"># Escoger que barras mostrar</span></span>
<span id="cb49-568"><a href="#cb49-568"></a><span class="in">p + scale_x_discrete(limits = c("Spring", "Winter"))</span></span>
<span id="cb49-569"><a href="#cb49-569"></a></span>
<span id="cb49-570"><a href="#cb49-570"></a><span class="in">### Agregar anotaciones ###</span></span>
<span id="cb49-571"><a href="#cb49-571"></a></span>
<span id="cb49-572"><a href="#cb49-572"></a><span class="in">df2$rec &lt;- round(df2$rec, 1)</span></span>
<span id="cb49-573"><a href="#cb49-573"></a></span>
<span id="cb49-574"><a href="#cb49-574"></a><span class="in"># Fuera de las barras</span></span>
<span id="cb49-575"><a href="#cb49-575"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-576"><a href="#cb49-576"></a><span class="in">  geom_bar(stat = "identity", fill = "steelblue") +</span></span>
<span id="cb49-577"><a href="#cb49-577"></a><span class="in">  geom_text(aes(label = rec), vjust = -0.3, size = 3.5) +</span></span>
<span id="cb49-578"><a href="#cb49-578"></a><span class="in">  theme_minimal()</span></span>
<span id="cb49-579"><a href="#cb49-579"></a></span>
<span id="cb49-580"><a href="#cb49-580"></a><span class="in"># Dentro de las barras</span></span>
<span id="cb49-581"><a href="#cb49-581"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb49-582"><a href="#cb49-582"></a><span class="in">  geom_bar(stat = "identity", fill = "yellow") +</span></span>
<span id="cb49-583"><a href="#cb49-583"></a><span class="in">  geom_text(aes(label = rec), vjust = 1.6, size = 3.5) +</span></span>
<span id="cb49-584"><a href="#cb49-584"></a><span class="in">  theme_minimal()</span></span>
<span id="cb49-585"><a href="#cb49-585"></a></span>
<span id="cb49-586"><a href="#cb49-586"></a><span class="in">### Cambiar colores de barras por grupo ###</span></span>
<span id="cb49-587"><a href="#cb49-587"></a></span>
<span id="cb49-588"><a href="#cb49-588"></a><span class="in"># Cambiar el color de las líneas externas por grupo</span></span>
<span id="cb49-589"><a href="#cb49-589"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec, color = season)) +</span></span>
<span id="cb49-590"><a href="#cb49-590"></a><span class="in">  geom_bar(stat = "identity", fill = "white")</span></span>
<span id="cb49-591"><a href="#cb49-591"></a><span class="in">p</span></span>
<span id="cb49-592"><a href="#cb49-592"></a></span>
<span id="cb49-593"><a href="#cb49-593"></a><span class="in">### Cambiar el color manualmente ###</span></span>
<span id="cb49-594"><a href="#cb49-594"></a></span>
<span id="cb49-595"><a href="#cb49-595"></a><span class="in"># Usar "palette" predefinido de colores</span></span>
<span id="cb49-596"><a href="#cb49-596"></a><span class="in">p + scale_color_manual(values = c("red", "blue", "green", "yellow"))</span></span>
<span id="cb49-597"><a href="#cb49-597"></a></span>
<span id="cb49-598"><a href="#cb49-598"></a><span class="in"># Usar "palette brewer"</span></span>
<span id="cb49-599"><a href="#cb49-599"></a><span class="in">p + scale_color_brewer(palette = "Dark2")</span></span>
<span id="cb49-600"><a href="#cb49-600"></a><span class="in">p + scale_color_brewer(palette = 1)</span></span>
<span id="cb49-601"><a href="#cb49-601"></a><span class="in">p + scale_color_brewer(palette = 2)</span></span>
<span id="cb49-602"><a href="#cb49-602"></a></span>
<span id="cb49-603"><a href="#cb49-603"></a><span class="in"># Usar escala de grises</span></span>
<span id="cb49-604"><a href="#cb49-604"></a><span class="in">p + scale_color_grey() + theme_classic()</span></span>
<span id="cb49-605"><a href="#cb49-605"></a></span>
<span id="cb49-606"><a href="#cb49-606"></a><span class="in">### Cambiar colores de relleno de las barras ###</span></span>
<span id="cb49-607"><a href="#cb49-607"></a></span>
<span id="cb49-608"><a href="#cb49-608"></a><span class="in"># Color de relleno</span></span>
<span id="cb49-609"><a href="#cb49-609"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb49-610"><a href="#cb49-610"></a><span class="in">  geom_bar(stat = "identity") +</span></span>
<span id="cb49-611"><a href="#cb49-611"></a><span class="in">  theme_minimal()</span></span>
<span id="cb49-612"><a href="#cb49-612"></a><span class="in">p</span></span>
<span id="cb49-613"><a href="#cb49-613"></a></span>
<span id="cb49-614"><a href="#cb49-614"></a><span class="in">### Cambiar el color de relleno manualmente ###</span></span>
<span id="cb49-615"><a href="#cb49-615"></a></span>
<span id="cb49-616"><a href="#cb49-616"></a><span class="in"># Usar "palette" predefinido de colores</span></span>
<span id="cb49-617"><a href="#cb49-617"></a><span class="in">p + scale_fill_manual(values = c("red", "blue", "green", "yellow"))</span></span>
<span id="cb49-618"><a href="#cb49-618"></a></span>
<span id="cb49-619"><a href="#cb49-619"></a><span class="in"># Usar "palette brewer"</span></span>
<span id="cb49-620"><a href="#cb49-620"></a><span class="in">p + scale_fill_brewer(palette = "Dark2")</span></span>
<span id="cb49-621"><a href="#cb49-621"></a><span class="in">p + scale_fill_brewer(palette = 1)</span></span>
<span id="cb49-622"><a href="#cb49-622"></a><span class="in">p + scale_fill_brewer(palette = 2)</span></span>
<span id="cb49-623"><a href="#cb49-623"></a></span>
<span id="cb49-624"><a href="#cb49-624"></a><span class="in"># Usar escala de grises</span></span>
<span id="cb49-625"><a href="#cb49-625"></a><span class="in">p + scale_fill_grey() + theme_classic()</span></span>
<span id="cb49-626"><a href="#cb49-626"></a></span>
<span id="cb49-627"><a href="#cb49-627"></a><span class="in"># Usar color negro del borde y relleno</span></span>
<span id="cb49-628"><a href="#cb49-628"></a><span class="in">ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb49-629"><a href="#cb49-629"></a><span class="in">  geom_bar(stat = "identity", color = "black") +</span></span>
<span id="cb49-630"><a href="#cb49-630"></a><span class="in">  scale_fill_manual(values = c("red", "blue", "green", "yellow")) +</span></span>
<span id="cb49-631"><a href="#cb49-631"></a><span class="in">  theme_classic()</span></span>
<span id="cb49-632"><a href="#cb49-632"></a></span>
<span id="cb49-633"><a href="#cb49-633"></a><span class="in">### Cambiar la posición de la leyenda ###</span></span>
<span id="cb49-634"><a href="#cb49-634"></a></span>
<span id="cb49-635"><a href="#cb49-635"></a><span class="in"># Cambiar el color de las barras a tonos de azúl</span></span>
<span id="cb49-636"><a href="#cb49-636"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb49-637"><a href="#cb49-637"></a><span class="in">  geom_bar(stat = "identity") +</span></span>
<span id="cb49-638"><a href="#cb49-638"></a><span class="in">  theme_minimal()</span></span>
<span id="cb49-639"><a href="#cb49-639"></a></span>
<span id="cb49-640"><a href="#cb49-640"></a><span class="in">p1 &lt;- p + scale_fill_brewer(palette = "Blues")</span></span>
<span id="cb49-641"><a href="#cb49-641"></a><span class="in">p1 + theme(legend.position = "top")</span></span>
<span id="cb49-642"><a href="#cb49-642"></a><span class="in">p1 + theme(legend.position = "bottom")</span></span>
<span id="cb49-643"><a href="#cb49-643"></a></span>
<span id="cb49-644"><a href="#cb49-644"></a><span class="in"># Remover la leyenda</span></span>
<span id="cb49-645"><a href="#cb49-645"></a><span class="in">p1 + theme(legend.position = "none")</span></span>
<span id="cb49-646"><a href="#cb49-646"></a></span>
<span id="cb49-647"><a href="#cb49-647"></a><span class="in">### Cambiar el órden de los items en una leyenda ###</span></span>
<span id="cb49-648"><a href="#cb49-648"></a></span>
<span id="cb49-649"><a href="#cb49-649"></a><span class="in"># Cambiar órden de grupos</span></span>
<span id="cb49-650"><a href="#cb49-650"></a><span class="in">p1 + scale_x_discrete(limits = c("Summer", "Autumn", "Winter", "Spring"))</span></span>
<span id="cb49-651"><a href="#cb49-651"></a></span>
<span id="cb49-652"><a href="#cb49-652"></a><span class="in">### Editar aún más los elementos de la leyenda ###</span></span>
<span id="cb49-653"><a href="#cb49-653"></a></span>
<span id="cb49-654"><a href="#cb49-654"></a><span class="in"># Cambiar el título de la leyenda y la fuente</span></span>
<span id="cb49-655"><a href="#cb49-655"></a><span class="in">p1 &lt;- ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb49-656"><a href="#cb49-656"></a><span class="in">  geom_bar(stat = "identity", color = "black")</span></span>
<span id="cb49-657"><a href="#cb49-657"></a></span>
<span id="cb49-658"><a href="#cb49-658"></a><span class="in">titulo &lt;- "Estación"</span></span>
<span id="cb49-659"><a href="#cb49-659"></a></span>
<span id="cb49-660"><a href="#cb49-660"></a><span class="in">p2 &lt;- p1 + scale_fill_manual(titulo, values = c("red", "blue", "green", "yellow")) +</span></span>
<span id="cb49-661"><a href="#cb49-661"></a><span class="in">  theme_classic()</span></span>
<span id="cb49-662"><a href="#cb49-662"></a></span>
<span id="cb49-663"><a href="#cb49-663"></a><span class="in">p2 + theme(legend.title = element_text(</span></span>
<span id="cb49-664"><a href="#cb49-664"></a><span class="in">  colour = "blue", size = 10,</span></span>
<span id="cb49-665"><a href="#cb49-665"></a><span class="in">  face = "bold"</span></span>
<span id="cb49-666"><a href="#cb49-666"></a><span class="in">))</span></span>
<span id="cb49-667"><a href="#cb49-667"></a></span>
<span id="cb49-668"><a href="#cb49-668"></a><span class="in">p2 + theme(legend.text = element_text(</span></span>
<span id="cb49-669"><a href="#cb49-669"></a><span class="in">  colour = "blue", size = 10,</span></span>
<span id="cb49-670"><a href="#cb49-670"></a><span class="in">  face = "bold"</span></span>
<span id="cb49-671"><a href="#cb49-671"></a><span class="in">))</span></span>
<span id="cb49-672"><a href="#cb49-672"></a></span>
<span id="cb49-673"><a href="#cb49-673"></a><span class="in"># Cambiar el color del fondo de la leyenda</span></span>
<span id="cb49-674"><a href="#cb49-674"></a><span class="in">p2 + theme(legend.background = element_rect(</span></span>
<span id="cb49-675"><a href="#cb49-675"></a><span class="in">  fill = "lightblue",</span></span>
<span id="cb49-676"><a href="#cb49-676"></a><span class="in">  size = 0.5, linetype = "solid"</span></span>
<span id="cb49-677"><a href="#cb49-677"></a><span class="in">))</span></span>
<span id="cb49-678"><a href="#cb49-678"></a></span>
<span id="cb49-679"><a href="#cb49-679"></a><span class="in">p2 + theme(legend.background = element_rect(</span></span>
<span id="cb49-680"><a href="#cb49-680"></a><span class="in">  fill = "lightblue",</span></span>
<span id="cb49-681"><a href="#cb49-681"></a><span class="in">  size = 0.5, linetype = "solid"</span></span>
<span id="cb49-682"><a href="#cb49-682"></a><span class="in">))</span></span>
<span id="cb49-683"><a href="#cb49-683"></a></span>
<span id="cb49-684"><a href="#cb49-684"></a><span class="in">### Gráfico de barras con múltiples grupos ###</span></span>
<span id="cb49-685"><a href="#cb49-685"></a><span class="in">head(df)</span></span>
<span id="cb49-686"><a href="#cb49-686"></a></span>
<span id="cb49-687"><a href="#cb49-687"></a><span class="in">df.n &lt;- aggregate(RECRUITS ~ SEASON + DENSITY, df, mean)</span></span>
<span id="cb49-688"><a href="#cb49-688"></a><span class="in">names(df.n) &lt;- c("season", "density", "rec")</span></span>
<span id="cb49-689"><a href="#cb49-689"></a></span>
<span id="cb49-690"><a href="#cb49-690"></a><span class="in"># Gráfico 1</span></span>
<span id="cb49-691"><a href="#cb49-691"></a><span class="in">ggplot(df.n, aes(season, rec, fill = density)) +</span></span>
<span id="cb49-692"><a href="#cb49-692"></a><span class="in">  geom_bar(stat = "identity")</span></span>
<span id="cb49-693"><a href="#cb49-693"></a></span>
<span id="cb49-694"><a href="#cb49-694"></a><span class="in"># Gráfico 2</span></span>
<span id="cb49-695"><a href="#cb49-695"></a><span class="in">ggplot(df.n, aes(season, rec, fill = density)) +</span></span>
<span id="cb49-696"><a href="#cb49-696"></a><span class="in">  geom_bar(stat = "identity", position = position_dodge())</span></span>
<span id="cb49-697"><a href="#cb49-697"></a></span>
<span id="cb49-698"><a href="#cb49-698"></a><span class="in"># Cambiar el color manualmente</span></span>
<span id="cb49-699"><a href="#cb49-699"></a><span class="in">p &lt;- ggplot(df.n, aes(season, rec, fill = density)) +</span></span>
<span id="cb49-700"><a href="#cb49-700"></a><span class="in">  geom_bar(stat = "identity", color = "black", position = position_dodge()) +</span></span>
<span id="cb49-701"><a href="#cb49-701"></a><span class="in">  theme_minimal()</span></span>
<span id="cb49-702"><a href="#cb49-702"></a></span>
<span id="cb49-703"><a href="#cb49-703"></a><span class="in">p + theme_classic()</span></span>
<span id="cb49-704"><a href="#cb49-704"></a></span>
<span id="cb49-705"><a href="#cb49-705"></a><span class="in"># Colores manuales</span></span>
<span id="cb49-706"><a href="#cb49-706"></a><span class="in">p + scale_fill_manual(values = c("#999999", "#E69F00")) + theme_classic()</span></span>
<span id="cb49-707"><a href="#cb49-707"></a></span>
<span id="cb49-708"><a href="#cb49-708"></a><span class="in"># Palette de colores</span></span>
<span id="cb49-709"><a href="#cb49-709"></a><span class="in">p + scale_fill_brewer(palette = "Blues") + theme_classic()</span></span>
<span id="cb49-710"><a href="#cb49-710"></a></span>
<span id="cb49-711"><a href="#cb49-711"></a><span class="in">### Gráficos de barras con error ###</span></span>
<span id="cb49-712"><a href="#cb49-712"></a></span>
<span id="cb49-713"><a href="#cb49-713"></a><span class="in"># Calcular promedio +/- SD</span></span>
<span id="cb49-714"><a href="#cb49-714"></a><span class="in">head(df)</span></span>
<span id="cb49-715"><a href="#cb49-715"></a></span>
<span id="cb49-716"><a href="#cb49-716"></a><span class="in">df3 &lt;- aggregate(RECRUITS ~ SEASON + DENSITY, df, FUN = function(x) c(mean = mean(x), sd = sd(x)))</span></span>
<span id="cb49-717"><a href="#cb49-717"></a><span class="in">df4 &lt;- cbind(data.frame(df3[, c(1:2)]), df3$RECRUITS[, 1], df3$RECRUITS[, 2])</span></span>
<span id="cb49-718"><a href="#cb49-718"></a></span>
<span id="cb49-719"><a href="#cb49-719"></a><span class="in">names(df4) &lt;- c("season", "density", "mean", "sd")</span></span>
<span id="cb49-720"><a href="#cb49-720"></a><span class="in">str(df4)</span></span>
<span id="cb49-721"><a href="#cb49-721"></a></span>
<span id="cb49-722"><a href="#cb49-722"></a><span class="in"># Grafico de barras y desviación estándar</span></span>
<span id="cb49-723"><a href="#cb49-723"></a><span class="in">p &lt;- ggplot(df4, aes(season, mean, fill = density)) +</span></span>
<span id="cb49-724"><a href="#cb49-724"></a><span class="in">  geom_bar(stat = "identity", position = position_dodge(), color = "black") +</span></span>
<span id="cb49-725"><a href="#cb49-725"></a><span class="in">  geom_errorbar(aes(ymin = mean, ymax = mean + sd),</span></span>
<span id="cb49-726"><a href="#cb49-726"></a><span class="in">    width = 0.2,</span></span>
<span id="cb49-727"><a href="#cb49-727"></a><span class="in">    position = position_dodge(0.9)</span></span>
<span id="cb49-728"><a href="#cb49-728"></a><span class="in">  )</span></span>
<span id="cb49-729"><a href="#cb49-729"></a></span>
<span id="cb49-730"><a href="#cb49-730"></a><span class="in">p + scale_fill_brewer(palette = "Paired") + theme_minimal()</span></span>
<span id="cb49-731"><a href="#cb49-731"></a><span class="in">p + scale_fill_brewer(palette = "Paired") + theme_classic()</span></span>
<span id="cb49-732"><a href="#cb49-732"></a></span>
<span id="cb49-733"><a href="#cb49-733"></a><span class="in">### Personalizar aún más los gráficos ###</span></span>
<span id="cb49-734"><a href="#cb49-734"></a></span>
<span id="cb49-735"><a href="#cb49-735"></a><span class="in"># Poner títulos de ejes</span></span>
<span id="cb49-736"><a href="#cb49-736"></a><span class="in">p + xlab("Estación") +</span></span>
<span id="cb49-737"><a href="#cb49-737"></a><span class="in">  ylab("Número de reclutas") +</span></span>
<span id="cb49-738"><a href="#cb49-738"></a><span class="in">  theme_classic()</span></span>
<span id="cb49-739"><a href="#cb49-739"></a></span>
<span id="cb49-740"><a href="#cb49-740"></a><span class="in"># Remover títulos de ejes</span></span>
<span id="cb49-741"><a href="#cb49-741"></a><span class="in">p + xlab(NULL) +</span></span>
<span id="cb49-742"><a href="#cb49-742"></a><span class="in">  ylab(NULL) +</span></span>
<span id="cb49-743"><a href="#cb49-743"></a><span class="in">  theme_classic()</span></span>
<span id="cb49-744"><a href="#cb49-744"></a></span>
<span id="cb49-745"><a href="#cb49-745"></a><span class="in"># Otros cambios</span></span>
<span id="cb49-746"><a href="#cb49-746"></a><span class="in">p2 &lt;- p + labs(x = "Estación", y = "Número de reclutas") +</span></span>
<span id="cb49-747"><a href="#cb49-747"></a><span class="in">  scale_fill_manual(values = c("black", "grey50")) +</span></span>
<span id="cb49-748"><a href="#cb49-748"></a><span class="in">  theme_classic()</span></span>
<span id="cb49-749"><a href="#cb49-749"></a><span class="in">p2</span></span>
<span id="cb49-750"><a href="#cb49-750"></a></span>
<span id="cb49-751"><a href="#cb49-751"></a><span class="in"># Cambiar los límites X y Y</span></span>
<span id="cb49-752"><a href="#cb49-752"></a><span class="in">p2 + ylim(0, 100)</span></span>
<span id="cb49-753"><a href="#cb49-753"></a></span>
<span id="cb49-754"><a href="#cb49-754"></a><span class="in"># Cambiar límites con expand_limits</span></span>
<span id="cb49-755"><a href="#cb49-755"></a><span class="in">p2 + expand_limits(x = c(0, 6), y = c(0, 80))</span></span>
<span id="cb49-756"><a href="#cb49-756"></a><span class="in">```</span></span>
<span id="cb49-757"><a href="#cb49-757"></a></span>
<span id="cb49-758"><a href="#cb49-758"></a><span class="fu">## Personalización de ggplots</span></span>
<span id="cb49-759"><a href="#cb49-759"></a></span>
<span id="cb49-760"><a href="#cb49-760"></a>Además de las funciones básicas (por ejemplo, componentes) descritas anteriormente, ggplot tiene muchas otras herramientas (tanto argumentos como funciones adicionales) para personalizar aún más los gráficos. Prácticamente todo se puede modificar. Aquí vemos algunas de las herramientas más comunes.</span>
<span id="cb49-761"><a href="#cb49-761"></a></span>
<span id="cb49-762"><a href="#cb49-762"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-763"><a href="#cb49-763"></a></span>
<span id="cb49-764"><a href="#cb49-764"></a><span class="fu">### Temas</span></span>
<span id="cb49-765"><a href="#cb49-765"></a></span>
<span id="cb49-766"><a href="#cb49-766"></a>ggplot2 viene con algunos temas por defecto que se pueden aplicar fácilmente para modificar el aspecto de nuestros gráficos:</span>
<span id="cb49-767"><a href="#cb49-767"></a></span>
<span id="cb49-770"><a href="#cb49-770"></a><span class="in">```{r}</span></span>
<span id="cb49-771"><a href="#cb49-771"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-772"><a href="#cb49-772"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb49-773"><a href="#cb49-773"></a></span>
<span id="cb49-774"><a href="#cb49-774"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb49-775"><a href="#cb49-775"></a></span>
<span id="cb49-776"><a href="#cb49-776"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb49-777"><a href="#cb49-777"></a></span>
<span id="cb49-778"><a href="#cb49-778"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb49-779"><a href="#cb49-779"></a><span class="in">```</span></span>
<span id="cb49-780"><a href="#cb49-780"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-781"><a href="#cb49-781"></a></span>
<span id="cb49-782"><a href="#cb49-782"></a>La mayoría de los temas difieren en el uso de cuadrículas, líneas de borde y patrones de etiquetado de ejes.</span>
<span id="cb49-783"><a href="#cb49-783"></a></span>
<span id="cb49-784"><a href="#cb49-784"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-785"><a href="#cb49-785"></a></span>
<span id="cb49-786"><a href="#cb49-786"></a><span class="fu">### Personalización de ejes</span></span>
<span id="cb49-787"><a href="#cb49-787"></a></span>
<span id="cb49-788"><a href="#cb49-788"></a>Los límites de los ejes pueden modificarse como sigue:</span>
<span id="cb49-789"><a href="#cb49-789"></a></span>
<span id="cb49-792"><a href="#cb49-792"></a><span class="in">```{r}</span></span>
<span id="cb49-793"><a href="#cb49-793"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span></span>
<span id="cb49-794"><a href="#cb49-794"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-795"><a href="#cb49-795"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb49-796"><a href="#cb49-796"></a></span>
<span id="cb49-797"><a href="#cb49-797"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb49-798"><a href="#cb49-798"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-799"><a href="#cb49-799"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb49-800"><a href="#cb49-800"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>))</span>
<span id="cb49-801"><a href="#cb49-801"></a><span class="in">```</span></span>
<span id="cb49-802"><a href="#cb49-802"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-803"><a href="#cb49-803"></a></span>
<span id="cb49-804"><a href="#cb49-804"></a>Los ejes también pueden transformarse:</span>
<span id="cb49-805"><a href="#cb49-805"></a></span>
<span id="cb49-808"><a href="#cb49-808"></a><span class="in">```{r}</span></span>
<span id="cb49-809"><a href="#cb49-809"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb49-810"><a href="#cb49-810"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-811"><a href="#cb49-811"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log"</span>) <span class="sc">+</span></span>
<span id="cb49-812"><a href="#cb49-812"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span>
<span id="cb49-813"><a href="#cb49-813"></a><span class="in">```</span></span>
<span id="cb49-814"><a href="#cb49-814"></a></span>
<span id="cb49-815"><a href="#cb49-815"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-816"><a href="#cb49-816"></a></span>
<span id="cb49-817"><a href="#cb49-817"></a>o invertidos:</span>
<span id="cb49-818"><a href="#cb49-818"></a></span>
<span id="cb49-821"><a href="#cb49-821"></a><span class="in">```{r}</span></span>
<span id="cb49-822"><a href="#cb49-822"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb49-823"><a href="#cb49-823"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-824"><a href="#cb49-824"></a>  <span class="fu">scale_y_reverse</span>()</span>
<span id="cb49-825"><a href="#cb49-825"></a><span class="in">```</span></span>
<span id="cb49-826"><a href="#cb49-826"></a></span>
<span id="cb49-827"><a href="#cb49-827"></a></span>
<span id="cb49-828"><a href="#cb49-828"></a></span>
<span id="cb49-829"><a href="#cb49-829"></a><span class="fu">### Guardar ggplots</span></span>
<span id="cb49-830"><a href="#cb49-830"></a></span>
<span id="cb49-831"><a href="#cb49-831"></a>Los ggplots pueden exportarse como archivos de imagen utilizando la función <span class="in">`ggsave`</span>:</span>
<span id="cb49-832"><a href="#cb49-832"></a></span>
<span id="cb49-835"><a href="#cb49-835"></a><span class="in">```{r}</span></span>
<span id="cb49-836"><a href="#cb49-836"></a><span class="fu">ggplot</span>(</span>
<span id="cb49-837"><a href="#cb49-837"></a>  <span class="at">data =</span> msleep[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">5</span>], ],</span>
<span id="cb49-838"><a href="#cb49-838"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bodywt, <span class="at">y =</span> brainwt)</span>
<span id="cb49-839"><a href="#cb49-839"></a>) <span class="sc">+</span></span>
<span id="cb49-840"><a href="#cb49-840"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-841"><a href="#cb49-841"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>order, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb49-842"><a href="#cb49-842"></a></span>
<span id="cb49-843"><a href="#cb49-843"></a><span class="co"># Export</span></span>
<span id="cb49-844"><a href="#cb49-844"></a><span class="fu">ggsave</span>(<span class="st">"plot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb49-845"><a href="#cb49-845"></a><span class="in">```</span></span>
<span id="cb49-846"><a href="#cb49-846"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-847"><a href="#cb49-847"></a></span>
<span id="cb49-848"><a href="#cb49-848"></a></span>
<span id="cb49-849"><a href="#cb49-849"></a>El tipo de archivo de imagen se identificará por la extensión en el nombre del archivo</span>
<span id="cb49-850"><a href="#cb49-850"></a></span>
<span id="cb49-851"><a href="#cb49-851"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-852"><a href="#cb49-852"></a></span>
<span id="cb49-853"><a href="#cb49-853"></a></span>
<span id="cb49-854"><a href="#cb49-854"></a>Personalización adicional del eje:</span>
<span id="cb49-855"><a href="#cb49-855"></a></span>
<span id="cb49-858"><a href="#cb49-858"></a><span class="in">```{r}</span></span>
<span id="cb49-859"><a href="#cb49-859"></a><span class="co"># Log2 scaling of the y axis (with visually-equal spacing)</span></span>
<span id="cb49-860"><a href="#cb49-860"></a><span class="fu">require</span>(scales)</span>
<span id="cb49-861"><a href="#cb49-861"></a></span>
<span id="cb49-862"><a href="#cb49-862"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="fu">log2_trans</span>())</span>
<span id="cb49-863"><a href="#cb49-863"></a></span>
<span id="cb49-864"><a href="#cb49-864"></a><span class="co"># show exponents</span></span>
<span id="cb49-865"><a href="#cb49-865"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(</span>
<span id="cb49-866"><a href="#cb49-866"></a>  <span class="at">trans =</span> <span class="fu">log2_trans</span>(),</span>
<span id="cb49-867"><a href="#cb49-867"></a>  <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log2"</span>, <span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">^</span>x),</span>
<span id="cb49-868"><a href="#cb49-868"></a>  <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log2"</span>, <span class="fu">math_format</span>(<span class="dv">2</span><span class="sc">^</span>.x))</span>
<span id="cb49-869"><a href="#cb49-869"></a>)</span>
<span id="cb49-870"><a href="#cb49-870"></a></span>
<span id="cb49-871"><a href="#cb49-871"></a><span class="co"># Percent</span></span>
<span id="cb49-872"><a href="#cb49-872"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent)</span>
<span id="cb49-873"><a href="#cb49-873"></a></span>
<span id="cb49-874"><a href="#cb49-874"></a><span class="co"># dollar</span></span>
<span id="cb49-875"><a href="#cb49-875"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar)</span>
<span id="cb49-876"><a href="#cb49-876"></a></span>
<span id="cb49-877"><a href="#cb49-877"></a><span class="co"># scientific</span></span>
<span id="cb49-878"><a href="#cb49-878"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific)</span>
<span id="cb49-879"><a href="#cb49-879"></a></span>
<span id="cb49-880"><a href="#cb49-880"></a><span class="do">### Agregar "tick marks" </span><span class="al">###</span></span>
<span id="cb49-881"><a href="#cb49-881"></a></span>
<span id="cb49-882"><a href="#cb49-882"></a><span class="co"># Cargar librerías</span></span>
<span id="cb49-883"><a href="#cb49-883"></a><span class="fu">library</span>(MASS)</span>
<span id="cb49-884"><a href="#cb49-884"></a></span>
<span id="cb49-885"><a href="#cb49-885"></a><span class="fu">data</span>(Animals)</span>
<span id="cb49-886"><a href="#cb49-886"></a></span>
<span id="cb49-887"><a href="#cb49-887"></a><span class="co"># x and y axis are transformed and formatted</span></span>
<span id="cb49-888"><a href="#cb49-888"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Animals, <span class="fu">aes</span>(<span class="at">x =</span> body, <span class="at">y =</span> brain)) <span class="sc">+</span></span>
<span id="cb49-889"><a href="#cb49-889"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb49-890"><a href="#cb49-890"></a>  <span class="fu">scale_x_log10</span>(</span>
<span id="cb49-891"><a href="#cb49-891"></a>    <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb49-892"><a href="#cb49-892"></a>    <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))</span>
<span id="cb49-893"><a href="#cb49-893"></a>  ) <span class="sc">+</span></span>
<span id="cb49-894"><a href="#cb49-894"></a>  <span class="fu">scale_y_log10</span>(</span>
<span id="cb49-895"><a href="#cb49-895"></a>    <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb49-896"><a href="#cb49-896"></a>    <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))</span>
<span id="cb49-897"><a href="#cb49-897"></a>  ) <span class="sc">+</span></span>
<span id="cb49-898"><a href="#cb49-898"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb49-899"><a href="#cb49-899"></a></span>
<span id="cb49-900"><a href="#cb49-900"></a><span class="co"># log-log plot without log tick marks</span></span>
<span id="cb49-901"><a href="#cb49-901"></a>p2</span>
<span id="cb49-902"><a href="#cb49-902"></a></span>
<span id="cb49-903"><a href="#cb49-903"></a><span class="co"># Show log tick marks</span></span>
<span id="cb49-904"><a href="#cb49-904"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>()</span>
<span id="cb49-905"><a href="#cb49-905"></a></span>
<span id="cb49-906"><a href="#cb49-906"></a><span class="co"># # Log ticks on left and right</span></span>
<span id="cb49-907"><a href="#cb49-907"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"lr"</span>)</span>
<span id="cb49-908"><a href="#cb49-908"></a></span>
<span id="cb49-909"><a href="#cb49-909"></a><span class="co"># All sides</span></span>
<span id="cb49-910"><a href="#cb49-910"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"trbl"</span>)</span>
<span id="cb49-911"><a href="#cb49-911"></a><span class="in">```</span></span>
<span id="cb49-912"><a href="#cb49-912"></a></span>
<span id="cb49-913"><a href="#cb49-913"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-914"><a href="#cb49-914"></a></span>
<span id="cb49-915"><a href="#cb49-915"></a><span class="fu">### Otros gráficos </span></span>
<span id="cb49-916"><a href="#cb49-916"></a></span>
<span id="cb49-917"><a href="#cb49-917"></a>Se pueden generar muchos otros tipos de gráficos. Aquí muestro un ejemplo de gráficos de contorno y de "mapa de calor":</span>
<span id="cb49-918"><a href="#cb49-918"></a></span>
<span id="cb49-921"><a href="#cb49-921"></a><span class="in">```{r}</span></span>
<span id="cb49-922"><a href="#cb49-922"></a><span class="fu">head</span>(faithful)</span>
<span id="cb49-923"><a href="#cb49-923"></a></span>
<span id="cb49-924"><a href="#cb49-924"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span></span>
<span id="cb49-925"><a href="#cb49-925"></a>  <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> density, <span class="at">colour =</span> <span class="fu">after_stat</span>(level)))</span>
<span id="cb49-926"><a href="#cb49-926"></a></span>
<span id="cb49-927"><a href="#cb49-927"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span></span>
<span id="cb49-928"><a href="#cb49-928"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density))</span>
<span id="cb49-929"><a href="#cb49-929"></a><span class="in">```</span></span>
<span id="cb49-930"><a href="#cb49-930"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-931"><a href="#cb49-931"></a></span>
<span id="cb49-932"><a href="#cb49-932"></a></span>
<span id="cb49-933"><a href="#cb49-933"></a><span class="fu">## Otros paquetes de gráficos en R</span></span>
<span id="cb49-934"><a href="#cb49-934"></a></span>
<span id="cb49-935"><a href="#cb49-935"></a><span class="ss">- </span>**ggvis** (ggplots interactivos)</span>
<span id="cb49-936"><a href="#cb49-936"></a><span class="ss">- </span>**vcd** (Warnes 2015)</span>
<span id="cb49-937"><a href="#cb49-937"></a><span class="ss">- </span>**plotrix** (Lemon et al. 2006)</span>
<span id="cb49-938"><a href="#cb49-938"></a><span class="ss">- </span>**gplots** (Warnes 2015)</span>
<span id="cb49-939"><a href="#cb49-939"></a></span>
<span id="cb49-940"><a href="#cb49-940"></a>Consulte la <span class="co">[</span><span class="ot">CRAN Graphics Task View</span><span class="co">](http://cran.r-project.org/web/views/Graphics.html)</span> para obtener una lista más completa de herramientas gráficas en **R**.</span>
<span id="cb49-941"><a href="#cb49-941"></a></span>
<span id="cb49-942"><a href="#cb49-942"></a>---</span>
<span id="cb49-943"><a href="#cb49-943"></a></span>
<span id="cb49-944"><a href="#cb49-944"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb49-945"><a href="#cb49-945"></a></span>
<span id="cb49-946"><a href="#cb49-946"></a><span class="fu">## References </span></span>
<span id="cb49-947"><a href="#cb49-947"></a></span>
<span id="cb49-948"><a href="#cb49-948"></a><span class="ss">- </span>Lemon J (2006) Plotrix: a package in the red light district of R. R-News</span>
<span id="cb49-949"><a href="#cb49-949"></a>6(4):8–12</span>
<span id="cb49-950"><a href="#cb49-950"></a><span class="ss">- </span>Warnes GR, Bolker B, Bonebakker L, Gentleman R, Liaw WHA, Lumley</span>
<span id="cb49-951"><a href="#cb49-951"></a>T, Maechler M, Magnusson A, Moeller S, Schwartz M, Venables B (2015) gplots: various R programming tools for plotting data. R package version 2.17.0. https://CRAN.R-project.org/package=gplots</span>
<span id="cb49-952"><a href="#cb49-952"></a><span class="ss">- </span>Wickham H (2010) A layered grammar of graphics. J Comput Graph Stat 19(1):3–28</span>
<span id="cb49-953"><a href="#cb49-953"></a><span class="ss">- </span>Wilkinson L (2005) The grammar of graphics. Statistics and computing, 2nd edn. Springer, New York</span>
<span id="cb49-954"><a href="#cb49-954"></a></span>
<span id="cb49-955"><a href="#cb49-955"></a>---</span>
<span id="cb49-956"><a href="#cb49-956"></a></span>
<span id="cb49-957"><a href="#cb49-957"></a>---</span>
<span id="cb49-958"><a href="#cb49-958"></a></span>
<span id="cb49-959"><a href="#cb49-959"></a>&lt;font size="4"&gt;Información de la sesión&lt;/font&gt;</span>
<span id="cb49-960"><a href="#cb49-960"></a></span>
<span id="cb49-961"><a href="#cb49-961"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb49-962"><a href="#cb49-962"></a></span>
<span id="cb49-963"><a href="#cb49-963"></a><span class="in">sessionInfo()</span></span>
<span id="cb49-964"><a href="#cb49-964"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2023 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>