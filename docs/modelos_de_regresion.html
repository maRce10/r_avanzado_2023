<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R avanzado 2023 - Modelos de regresión</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R avanzado 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-manuales" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Manuales</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-manuales">    
        <li>
    <a class="dropdown-item" href="./fundamentos_de_r.html" rel="" target="">
 <span class="dropdown-text">Fundamentos de R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./reportes_dinamicos.html" rel="" target="">
 <span class="dropdown-text">Reportes dinámicos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./funciones.html" rel="" target="">
 <span class="dropdown-text">Funciones</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./bucles.html" rel="" target="">
 <span class="dropdown-text">Bucles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./modelos_de_regresion.html" rel="" target="">
 <span class="dropdown-text">Modelos de regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./estadistica_tradicional_regresion.html" rel="" target="">
 <span class="dropdown-text">Estadística tradicional como regresión</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ggplot2.html" rel="" target="">
 <span class="dropdown-text">Gráficos con ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tareas" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tareas</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tareas">    
        <li>
    <a class="dropdown-item" href="./tarea4.html" rel="" target="">
 <span class="dropdown-text">Tarea 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tarea5.html" rel="" target="">
 <span class="dropdown-text">Tarea 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./respuestas_tarea5.html" rel="" target="">
 <span class="dropdown-text">Solución Tarea 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./preparacion_curso.html" rel="" target="">
 <span class="menu-text">Preparación para el curso</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://codefile.io/f/inMsojTFoN" rel="" target="">
 <span class="menu-text">Compartir código</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html" rel="" target="">
 <span class="menu-text">Instructor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maRce10/R_avanzado_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul class="collapse">
  <li><a href="#modelos-lineales-como-marco-unificador" id="toc-modelos-lineales-como-marco-unificador" class="nav-link active" data-scroll-target="#modelos-lineales-como-marco-unificador"><span class="header-section-number">1</span> Modelos lineales como marco unificador</a></li>
  <li><a href="#objetivo-del-manual" id="toc-objetivo-del-manual" class="nav-link" data-scroll-target="#objetivo-del-manual"><span class="header-section-number">2</span> Objetivo del manual</a></li>
  <li><a href="#cómo-simular-datos" id="toc-cómo-simular-datos" class="nav-link" data-scroll-target="#cómo-simular-datos"><span class="header-section-number">3</span> Cómo simular datos</a>
  <ul class="collapse">
  <li><a href="#generación-de-números-aleatorios-en-r" id="toc-generación-de-números-aleatorios-en-r" class="nav-link" data-scroll-target="#generación-de-números-aleatorios-en-r"><span class="header-section-number">3.1</span> Generación de números aleatorios en R</a></li>
  <li><a href="#generación-de-variables-categóricas" id="toc-generación-de-variables-categóricas" class="nav-link" data-scroll-target="#generación-de-variables-categóricas"><span class="header-section-number">3.2</span> Generación de variables categóricas</a></li>
  <li><a href="#muestreo-aleatorio" id="toc-muestreo-aleatorio" class="nav-link" data-scroll-target="#muestreo-aleatorio"><span class="header-section-number">3.3</span> Muestreo aleatorio</a></li>
  <li><a href="#iterar-un-proceso" id="toc-iterar-un-proceso" class="nav-link" data-scroll-target="#iterar-un-proceso"><span class="header-section-number">3.4</span> Iterar un proceso</a></li>
  <li><a href="#hacer-que-las-simulaciones-sean-reproducibles" id="toc-hacer-que-las-simulaciones-sean-reproducibles" class="nav-link" data-scroll-target="#hacer-que-las-simulaciones-sean-reproducibles"><span class="header-section-number">3.5</span> Hacer que las simulaciones sean reproducibles</a></li>
  </ul></li>
  <li><a href="#crear-juegos-de-datos" id="toc-crear-juegos-de-datos" class="nav-link" data-scroll-target="#crear-juegos-de-datos"><span class="header-section-number">4</span> Crear juegos de datos</a>
  <ul class="collapse">
  <li><a href="#juegos-de-datos-con-variables-numéricas-y-categóricas" id="toc-juegos-de-datos-con-variables-numéricas-y-categóricas" class="nav-link" data-scroll-target="#juegos-de-datos-con-variables-numéricas-y-categóricas"><span class="header-section-number">4.1</span> Juegos de datos con variables numéricas y categóricas</a></li>
  </ul></li>
  <li><a href="#cómo-utilizar-datos-simulados-para-entender-el-comportamiento-de-las-herramientas-estadísticas" id="toc-cómo-utilizar-datos-simulados-para-entender-el-comportamiento-de-las-herramientas-estadísticas" class="nav-link" data-scroll-target="#cómo-utilizar-datos-simulados-para-entender-el-comportamiento-de-las-herramientas-estadísticas"><span class="header-section-number">5</span> Cómo utilizar datos simulados para entender el comportamiento de las herramientas estadísticas</a>
  <ul class="collapse">
  <li><a href="#prueba-de-concepto-el-teorema-central-del-límite" id="toc-prueba-de-concepto-el-teorema-central-del-límite" class="nav-link" data-scroll-target="#prueba-de-concepto-el-teorema-central-del-límite"><span class="header-section-number">5.1</span> Prueba de concepto: <em>el Teorema Central del Límite</em></a></li>
  </ul></li>
  <li><a href="#regresión-lineal-en-r" id="toc-regresión-lineal-en-r" class="nav-link" data-scroll-target="#regresión-lineal-en-r"><span class="header-section-number">6</span> Regresión lineal en R</a>
  <ul class="collapse">
  <li><a href="#modelo-solo-con-intercepto" id="toc-modelo-solo-con-intercepto" class="nav-link" data-scroll-target="#modelo-solo-con-intercepto"><span class="header-section-number">6.1</span> Modelo solo con intercepto</a></li>
  <li><a href="#añadir-un-predictor-no-asociado" id="toc-añadir-un-predictor-no-asociado" class="nav-link" data-scroll-target="#añadir-un-predictor-no-asociado"><span class="header-section-number">6.2</span> Añadir un predictor no asociado</a></li>
  <li><a href="#simular-un-predictor-asociado" id="toc-simular-un-predictor-asociado" class="nav-link" data-scroll-target="#simular-un-predictor-asociado"><span class="header-section-number">6.3</span> Simular un predictor asociado</a></li>
  <li><a href="#varios-predictores-regresión-múltiple" id="toc-varios-predictores-regresión-múltiple" class="nav-link" data-scroll-target="#varios-predictores-regresión-múltiple"><span class="header-section-number">6.4</span> Varios predictores: regresión múltiple</a></li>
  <li><a href="#añadir-un-predictor-categórico" id="toc-añadir-un-predictor-categórico" class="nav-link" data-scroll-target="#añadir-un-predictor-categórico"><span class="header-section-number">6.5</span> Añadir un predictor categórico</a></li>
  <li><a href="#interacciones" id="toc-interacciones" class="nav-link" data-scroll-target="#interacciones"><span class="header-section-number">6.6</span> Interacciones</a></li>
  </ul></li>
  <li><a href="#extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas" id="toc-extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas" class="nav-link" data-scroll-target="#extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas"><span class="header-section-number">7</span> Extender los modelos lineales a estructuras de datos más complejas</a>
  <ul class="collapse">
  <li><a href="#modelos-lineales-generalizados-glm" id="toc-modelos-lineales-generalizados-glm" class="nav-link" data-scroll-target="#modelos-lineales-generalizados-glm"><span class="header-section-number">7.1</span> Modelos lineales generalizados (GLM)</a></li>
  <li><a href="#modelos-de-efectos-variables-modelos-mixtos" id="toc-modelos-de-efectos-variables-modelos-mixtos" class="nav-link" data-scroll-target="#modelos-de-efectos-variables-modelos-mixtos"><span class="header-section-number">7.2</span> Modelos de efectos variables (modelos mixtos)</a></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias"><span class="header-section-number">7.3</span> Referencias</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><font size="7"><b>Modelos de regresión</b></font></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">12 de noviembre de 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<section id="objetivos-del-manual" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Objetivos del manual</h1>
<ul>
<li><p>Familiarizarse con el formato para reportes dinámicos Rmarkdown/quarto</p></li>
<li><p>Ser capaz de documentar el manejo y análisis de datos en R usando Rmarkdown/quarto</p></li>
</ul>
</section>
<p>&nbsp;</p>
<style>
body
  { counter-reset: source-line 0; }
pre.numberSource code
  { counter-reset: none; }
</style>
<p>&nbsp;</p>
<section id="modelos-lineales-como-marco-unificador" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Modelos lineales como marco unificador</h1>
<p>Tradicionalmente, los modelos estadísticos se han enseñado como herramientas desconectadas sin una relación clara entre ellas. Sólo hace falta darle un vistazo a un libro clásico de estadística para biólogos (Sokal &amp; Rolhf):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/sokal_rohlf.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Sin embargo, la mayoría de esos modelos estadísticos comunes no son más que casos especiales de modelos lineales. Por lo tanto, aprenderlos como tales puede simplificar mucho las cosas. Este enfoque tiene varias ventajas:</p>
<ul>
<li><p>En primer lugar, <strong>todo se reduce a <em>y=a⋅x+b</em></strong>, lo que simplifica en gran medida el aprendizaje</p></li>
<li><p>Esto también significa que no hay <strong>necesidad de aprender sobre los parámetros, las hipótesis y la interpretación de los resultados para cada caso especial</strong>.</p></li>
<li><p>Los modelos lineales se han ampliado para <strong>tener en cuenta distribuciones y estructuras de datos complejas</strong> (por ejemplo, modelos mixtos, modelos lineales generalizados, modelos cero-inflados, etc.) proporcionando una <strong>plataforma más flexible</strong>.</p></li>
<li><p>Los modelos lineales se <strong>aplican en todos los paradigmas estadísticos</strong> (por ejemplo, frecuentista, bayesiano)</p></li>
</ul>
<p>&nbsp;</p>
</section>
<section id="objetivo-del-manual" class="level1 alert alert-info" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Objetivo del manual</h1>
<p>&nbsp; - Comprender la inferencia estadística a través de una única herramienta de modelaje (modelos lineales en sentido amplio)</p>
<ul>
<li><p>Familiarizarse con la construcción de modelos lineales</p></li>
<li><p>Extender los modelos lineales a diferentes estructuras de datos</p></li>
</ul>
</section>
<p>&nbsp;</p>
<hr>
<p>Paquetes a utilizar en este manual:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># instalar/cargar paquetes</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">c</span>(<span class="st">"ggplot2"</span>, </span>
<span id="cb1-5"><a href="#cb1-5"></a>    <span class="st">"viridis"</span>, </span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="st">"lmerTest"</span>, </span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="st">"sjPlot"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<hr>
<section id="cómo-simular-datos" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Cómo simular datos</h1>
<section id="generación-de-números-aleatorios-en-r" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="generación-de-números-aleatorios-en-r"><span class="header-section-number">3.1</span> Generación de números aleatorios en R</h2>
<p>La estadística nos permite inferir patrones en los datos. Solemos utilizar conjuntos de datos reales para enseñar estadística. Sin embargo, puede ser circular entender el funcionamiento interno de una herramienta estadística probando su capacidad para inferir un patrón que no estamos seguros de encontrar en los datos (y no tenemos idea del mecanismo que produjo ese patrón). <strong>Las simulaciones nos permiten crear escenarios controlados en los que conocemos con seguridad los patrones</strong> presentes en los datos y los procesos subyacentes que los han generado.</p>
<p>R ofrece algunas funciones básicas para la simulación de datos. Las más utilizadas son las funciones generadoras de números aleatorios. Los nombres de estas funciones comienzan con <em>r</em> (<code>r____()</code>). Por ejemplo, <code>runif()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># simular variable uniforme</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>unif_var <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>El resultado es un vector numérico de longitud 100 (<code>n = 100</code>):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># imprimir variable</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>unif_var</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 9.889093 3.977455 1.156978 0.697487 2.437494 7.920104 3.400624 9.720625
  [9] 1.658555 4.591037 1.717481 2.314771 7.728119 0.963015 4.534478 0.847007
 [17] 5.606659 0.087046 9.857371 3.165848 6.394489 2.952232 9.967037 9.060213
 [25] 9.887391 0.656457 6.270388 4.904750 9.710244 3.622208 6.799935 2.637199
 [33] 1.857143 1.851432 3.792967 8.470244 4.980761 7.905856 8.384639 4.569039
 [41] 7.994758 3.819431 7.597012 4.367756 9.042177 3.195349 0.825691 8.162891
 [49] 8.984762 9.664964 5.730689 7.200795 7.740586 6.277608 7.229893 3.868313
 [57] 1.627908 1.872283 3.912495 2.739012 1.919177 5.043918 7.638404 6.936689
 [65] 5.440542 6.590872 4.687284 4.818055 3.370636 4.245263 2.870151 6.011915
 [73] 8.407423 6.208370 1.345516 5.677224 4.434263 4.379754 6.236172 9.326533
 [81] 8.884926 8.785406 2.421769 7.414538 3.876563 0.789517 0.948356 7.621427
 [89] 3.478940 4.167667 3.440162 0.084109 9.115750 1.822054 7.228034 5.719633
 [97] 5.400364 3.549474 8.240918 1.861368</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos explorar el resultado graficando un histograma:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># crear histograma</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(unif_var), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> unif_var)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Muestra una distribución uniforme que va de 0 a 10.</p>
<p>También podemos simular números aleatorios procedentes de una distribución normal utilizando <code>rnorm()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># crear una variable normal</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>norm_var <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># graficar histograma</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(norm_var), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> norm_var)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Tenga en cuenta que todas las funciones generadoras de números aleatorios tienen el argumento ‘n’, que determina la longitud del vector generado (es decir, el número de números aleatorios), además de algunos argumentos adicionales relacionados con parámetros específicos de la distribución.</p>
<p>Las variables continuas (es decir, los vectores numéricos) pueden convertirse en variables discretas (es decir, números enteros) simplemente redondeándolas:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>v1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.4269  8.5450 15.1387  8.9203  9.3693</code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">round</span>(<span class="at">x =</span> v1, <span class="at">digits =</span> <span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15  9 15  9  9</code></pre>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 1</font></p>
<ul>
<li><p>¿Qué hacen las funciones <code>rbinom()</code> y <code>rexp()</code>?</p></li>
<li><p>Ejecutela y haga histogramas de sus resultados</p></li>
<li><p>¿Qué hacen los argumentos ‘mean’ y ‘sd’ en <code>rnorm()</code>? Juege con diferentes valores y comprueba el histograma para hacerse una idea de su efecto en la simulación</p></li>
</ul>
</div>
<p>&nbsp;</p>
</section>
<section id="generación-de-variables-categóricas" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="generación-de-variables-categóricas"><span class="header-section-number">3.2</span> Generación de variables categóricas</h2>
<p>La forma más sencilla de generar variables categóricas es utilizar el vector de ejemplo <code>letters' (o</code>LETTERS’) para asignar niveles de categoría. Podemos hacerlo utilizando la función <code>rep()</code>. Por ejemplo, el siguiente código crea un vector categórico (caracteres) con dos niveles, cada uno con 4 observaciones:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "a" "a" "a" "b" "b" "b" "b"</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>También podemos replicar este patrón utilizando el argumento ‘times’. Este código replica el vector anterior 2 veces:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">4</span>, <span class="at">times =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "a" "a" "a" "a" "b" "b" "b" "b" "a" "a" "a" "a" "b" "b" "b" "b"</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Otra opción es simular una variable a partir de una distribución binomial y luego convertirla en un factor:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># correr rbinom</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>binom_var <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>binom_var</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 0 0 1 1 0 0 0 0 0 0 0 1 1 1 0 0 1 0 1 0 0 0 0 0 0 0 1 0 1 1 1 0 0 0 1 0 0
[39] 1 1 0 0 0 0 0 1 0 1 1 1</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># convertir a factor</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>categ_var <span class="ot">&lt;-</span> <span class="fu">factor</span>(binom_var, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a>categ_var</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] b a a b b a a a a a a a b b b a a b a b a a a a a a a b a b b b a a a b a a
[39] b b a a a a a b a b b b
Levels: a b</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="muestreo-aleatorio" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="muestreo-aleatorio"><span class="header-section-number">3.3</span> Muestreo aleatorio</h2>
<p>La otra herramienta importante de R para jugar con datos simulados es <code>sample()</code>. Esta función permite tomar muestras de tamaños específicos de vectores. Por ejemplo, tomemos el ejemplo del vector ‘letters’:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>letters</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n" "o" "p" "q" "r" "s"
[20] "t" "u" "v" "w" "x" "y" "z"</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos tomar una muestra de este vector como es:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># tomar muestra</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">sample</span>(<span class="at">x =</span> letters, <span class="at">size =</span> <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "i" "r" "q" "a" "c" "m" "y" "z" "u" "v"</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>El argumento ‘size’ nos permite determinar el tamaño de la muestra. Tenga en cuenta que obtendremos un error si el tamaño es mayor que el propio vector:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">sample</span>(<span class="at">x =</span> letters, <span class="at">size =</span> <span class="dv">30</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in sample.int(length(x), size, replace, prob): cannot take a sample larger than the population when 'replace = FALSE'</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Esto sólo puede hacerse cuando el muestreo es con reemplazo (replacement). El muestreo con reemplazo puede aplicarse estableciendo el argumento <code>replace = TRUE</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">sample</span>(<span class="at">x =</span> letters, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "j" "i" "h" "i" "k" "u" "n" "i" "w" "k" "c" "t" "m" "p" "i" "h" "d" "w" "c"
[20] "q" "j" "e" "e" "j" "k" "c" "l" "t" "r" "h"</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="iterar-un-proceso" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="iterar-un-proceso"><span class="header-section-number">3.4</span> Iterar un proceso</h2>
<p>A menudo, las simulaciones deben repetirse varias veces para descartar resultados espurios debidos al azar o simplemente para probar diferentes parámetros. Las funciones de simulación de datos mencionadas anteriormente pueden ejecutarse varias veces (por ejemplo, iteradas) utilizando la función <code>replicate()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># replicar</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>repl_rnorm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co"># ver clase</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="fu">class</span>(repl_rnorm)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># imprimir</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>repl_rnorm</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1]  1.19184 -0.33992

[[2]]
[1]  0.78911 -0.63213

[[3]]
[1] -1.49312 -0.13441</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="hacer-que-las-simulaciones-sean-reproducibles" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="hacer-que-las-simulaciones-sean-reproducibles"><span class="header-section-number">3.5</span> Hacer que las simulaciones sean reproducibles</h2>
<p>El último truco que necesitamos para ejecutar simulaciones en R es la capacidad de reproducir una simulación (es decir, obtener exactamente los mismos datos y resultados simulados). Esto puede ser útil para que otros investigadores puedan ejecutar nuestros análisis exactamente de la misma manera. Esto puede hacerse fácilmente con la función <code>set.seed()</code>. Pruebe a ejecutar el siguiente código. Debería obtener la misma salida:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># definir semilla</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="co"># crear variable uniforme</span></span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.50748 0.30677</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="crear-juegos-de-datos" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Crear juegos de datos</h1>
<section id="juegos-de-datos-con-variables-numéricas-y-categóricas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="juegos-de-datos-con-variables-numéricas-y-categóricas"><span class="header-section-number">4.1</span> Juegos de datos con variables numéricas y categóricas</h2>
<p>Ahora que sabemos cómo simular variables continuas y categóricas. Podemos juntarlas para crear conjuntos de datos simulados. Esto se puede hacer utilizando la función <code>data.frame()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># crear variable categorica</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>grupo <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># crear variable continuaa</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>size <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co"># poner juntas en un data frame</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(grupo, size)</span>
<span id="cb33-9"><a href="#cb33-9"></a></span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co"># imprimir</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>df</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">grupo</th>
<th style="text-align: right;">size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">4.8158</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">3.6287</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">4.4008</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">5.2946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">5.3898</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">3.7919</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Por supuesto, podríamos añadir más variables a este cuadro de datos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># crear variable categorica</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>grupo <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb34-3"><a href="#cb34-3"></a>individuo <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="co"># crear variables continuas</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>size <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb34-7"><a href="#cb34-7"></a>weight <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb34-8"><a href="#cb34-8"></a></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="co"># poner todo en un data frame</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(grupo, individuo, size, weight)</span>
<span id="cb34-11"><a href="#cb34-11"></a></span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="co"># imprimir</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>df</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">grupo</th>
<th style="text-align: left;">individuo</th>
<th style="text-align: right;">size</th>
<th style="text-align: right;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">4.6363</td>
<td style="text-align: right;">109.874</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">3.3733</td>
<td style="text-align: right;">107.414</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">4.7435</td>
<td style="text-align: right;">100.893</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">6.1018</td>
<td style="text-align: right;">90.451</td>
</tr>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">5.7558</td>
<td style="text-align: right;">98.049</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">4.7618</td>
<td style="text-align: right;">109.255</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Y eso es un juego de datos simulados en su forma más básica. Se parece mucho al tipo de datos con los que trabajamos en biología.</p>
<hr>
</section>
</section>
<section id="cómo-utilizar-datos-simulados-para-entender-el-comportamiento-de-las-herramientas-estadísticas" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Cómo utilizar datos simulados para entender el comportamiento de las herramientas estadísticas</h1>
<p>&nbsp;</p>
<section id="prueba-de-concepto-el-teorema-central-del-límite" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="prueba-de-concepto-el-teorema-central-del-límite"><span class="header-section-number">5.1</span> Prueba de concepto: <em>el Teorema Central del Límite</em></h2>
<p>El <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Teorema del Límite Central</a> afirma que, si tomamos muestras aleatorias de una población, los promedios de esas muestras seguirán una distribución normal, aunque la población no esté distribuida normalmente. Además, la distribución normal resultante debe tener un promedio cercano al promedio de la población. El teorema es un concepto clave para la estadística inferencial, ya que implica que los métodos estadísticos que funcionan para las distribuciones normales pueden ser aplicables a muchos problemas que implican otros tipos de distribuciones. No obstante, el objetivo aquí es sólo mostrar cómo se pueden utilizar las simulaciones para entender el comportamiento de los métodos estadísticos.</p>
<p>Para comprobar si esas afirmaciones básicas sobre el Teorema del Límite Central son ciertas, podemos utilizar datos simulados en R. Vamos a simular una población de 1000 observaciones con una distribución uniforme:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># simular popublacion uniforme</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>unif_pop <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="co"># ver histograma</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(unif_pop), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> unif_pop)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos tomar muestras aleatorias usando <code>sample()</code> así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">sample</span>(<span class="at">x =</span> unif_pop, <span class="at">size =</span> <span class="dv">30</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 9.28420 1.02626 2.57517 3.32485 6.89990 2.29404 0.33737 8.21366 3.30364
[10] 8.03793 2.59174 7.81770 5.65426 0.63831 2.83470 4.20434 4.76330 4.42193
[19] 6.97830 7.92625 0.68121 3.52323 6.51103 5.38289 7.97210 1.80062 4.21282
[28] 3.33866 8.91223 4.71163</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Este proceso puede ser replicado varias veces con <code>replicate()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># replicar</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> unif_pop, <span class="at">size =</span> <span class="dv">30</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>El código anterior toma 100 muestras con 30 valores cada una. Ahora podemos comprobar la distribución de las muestras:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># ver distribucion/ histograma</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(samples), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>… asi como el promedio:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">mean</span>(samples)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.0212</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Como era de esperar, las muestras siguen una distribución normal con una media cercana a la media de la población, que es:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">mean</span>(unif_pop)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.0527</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Probemos con una distribución más compleja. Por ejemplo, una distribución bimodal:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># usar semilla</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co"># simular variables</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>norm1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a>norm2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb44-7"><a href="#cb44-7"></a></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co"># juntar en una sola variable</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>bimod_pop <span class="ot">&lt;-</span> <span class="fu">c</span>(norm1, norm2)</span>
<span id="cb44-10"><a href="#cb44-10"></a></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="co"># ver histograma</span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(bimod_pop), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bimod_pop)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># replicar muestreo</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(bimod_pop, <span class="dv">10</span>)))</span>
<span id="cb45-3"><a href="#cb45-3"></a></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="co"># ver histograma</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(samples), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># ver promedios</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">mean</span>(samples)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.231</code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">mean</span>(bimod_pop)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.088</code></pre>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 2</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Intenta explorar el Teorema del Límite Central como en el caso anterior, pero esta vez utilizando:</p>
<ol type="1">
<li>Una distribución exponencial (<code>rexp()</code>)</li>
<li>Una distribución binomial (<code>rbinom()</code>)</li>
</ol></li>
</ul>
<p>&nbsp;</p>
<ul>
<li>Para cada distribución: grafique un histograma y compare los promedios de la población y de las muestras</li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
<div class="alert alert-warning">
<p><font size="6"></font></p><font size="6">
<center>
Regresión lineal simple
</center>
</font><p><font size="6"></font></p>
<p>Las regresiones lineales se basan en la ecuación lineal <em>a = mx + b</em> que aprendimos en el colegio. La representación formal tiene este aspecto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<ul>
<li><p><span class="math inline">\(\hat{Y}\)</span>: variable respuesta</p></li>
<li><p><span class="math inline">\(\beta_{o}\)</span>: intercepto</p></li>
<li><p><span class="math inline">\(\beta_{1}\)</span>: estimado de la magnitud del efecto de <span class="math inline">\(x_{1}\)</span> en <span class="math inline">\(\hat{Y}\)</span> (también conocido como tamaño de efecto, coeficiente o simplemente “estimado”)</p></li>
<li><p><span class="math inline">\(x_{1}\)</span>: variable predictora</p></li>
</ul>
<p>&nbsp;</p>
<p>El objetivo más común de una regresión lineal es la estimación de los valores de <span class="math inline">\(\beta_{*}\)</span>. Esto se consigue encontrando la línea recta que mejor se ajusta y que representa la asociación entre un predictor y la respuesta:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/regression.jpg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Estos <span class="math inline">\(\beta_{*}\)</span> son el tamaño de efecto estimado del predictor correspondiente (por ejemplo, <span class="math inline">\(\beta_{1}\)</span> es el tamaño de efecto <span class="math inline">\(x_{1}\)</span>). Su valor representa el cambio medio en <span class="math inline">\(\hat{Y}\)</span> (en unidades <span class="math inline">\(\hat{Y}\)</span>) para una unidad de cambio en <span class="math inline">\(\beta_{*}\)</span>. Por lo tanto, la hipótesis nula es que esos <span class="math inline">\(\beta_{*}\)</span> no son diferentes de 0:</p>
<center>
<font size="6"><span class="math inline">\(\qquad \mathcal{H}_0: \hat{Y} = \beta_0 + 0 * x_{1}\)</span></font>
</center>
<p>lo que equivale a esto:</p>
<center>
<font size="6"><span class="math inline">\(\qquad \mathcal{H}_0: \hat{Y} = \beta_0\)</span></font>
</center>
<p>&nbsp;</p>
<p>Por ejemplo, un modelo de regresión con este resultado:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/model_betas_esp.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<hr>
</section>
</section>
<section id="regresión-lineal-en-r" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Regresión lineal en R</h1>
<p>Para sacar el máximo provecho de los modelos lineales necesitamos sentirnos cómodos con ellos. Empezaremos explorando la función de regresión lineal de R <code>lm()</code>. En R la mayoría de los modelos lineales y sus extensiones comparten formatos comunes de entrada de datos y resultados, lo que facilita su aplicación una vez que entendemos sus fundamentos.</p>
<p>Utilizaremos el juego de datos ‘trees’ que viene por defecto con R. ‘trees’ proporciona medidas del <strong>diámetro</strong> (etiquetado como ‘Girth’), <strong>altura</strong> y <strong>volumen</strong> de 31 cerezos talados:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">head</span>(trees)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Girth</th>
<th style="text-align: right;">Height</th>
<th style="text-align: right;">Volume</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">10.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.6</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">10.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.8</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">10.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">16.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10.7</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">18.8</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.8</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">19.7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>La función básica de R para construir un modelo lineal es <code>lm()</code>. Veamos los componentes básicos de un modelo de regresión utilizando <code>lm()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lm.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos correr este modelo para ver el resultado:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>reg_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Height <span class="sc">~</span> Girth, <span class="at">data =</span> trees)</span>
<span id="cb51-2"><a href="#cb51-2"></a></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="fu">summary</span>(reg_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Height ~ Girth, data = trees)

Residuals:
    Min      1Q  Median      3Q     Max 
-12.582  -2.769   0.316   2.473   9.946 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   62.031      4.383   14.15  1.5e-14 ***
Girth          1.054      0.322    3.27   0.0028 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.54 on 29 degrees of freedom
Multiple R-squared:  0.27,  Adjusted R-squared:  0.244 
F-statistic: 10.7 on 1 and 29 DF,  p-value: 0.00276</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Esto es lo que significan los elementos de la salida:</p>
<ul>
<li><p><strong>Llamada</strong> (call): la función y los parámetros que se utilizaron para crear el modelo</p></li>
<li><p><strong>Residuales</strong> (residuals): distribución de los residuales. Los residuales son la diferencia entre lo que predijo el modelo y el valor real de <em>y</em>. Esta es una representación gráfica de los residuales:</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><p><strong>Coeficientes</strong> (coefficients): contiene los tamaños de efecto (‘Estimates’), una medida de su incertidumbre (‘Standar error’), la estadística asociada (‘t value’) y el valor p (‘Pr(&gt;|t|)’). Los tamaño de efecto o estimados se dan como el cambio promedio en <em>y</em> por cada aumento de 1 unidad en <em>x</em>. Para este ejemplo el estimado es de 1,0544 <span class="math inline">\(in / in\)</span>. A pesar de que las unidades se anulan (`1,0544 <span class="math inline">\(in / in\)</span> = 1,0544) tenerlas en cuenta sigue siendo biológicamente significativo. Significan que, en promedio, y un aumento de 1 pulgada en la circunferencia que se espera un aumento de 1,0544 pulgadas en la altura.</p></li>
<li><p><strong>Error estándar de los residuales</strong> (residual standard error): se explica por sí mismo. El error estándar de los residuales</p></li>
<li><p><strong>R-cuadrado múltiple</strong> (multiple R-squared): el coeficiente de determinación, que pretende ser una medida de lo bien que su modelo se ajusta a los datos</p></li>
<li><p><strong>R-cuadrado ajustado</strong> (adjusted R-squared): similar al ‘R-cuadrado múltiple’ pero penalizado por el número de parámetros</p></li>
<li><p><strong>Estadístico F</strong> (F-statistic): estadístico para una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</p></li>
<li><p><strong>Valor de p</strong>: probabilidad de una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</p></li>
</ul>
<p>&nbsp;</p>
<p>Utilizaremos <code>lm()</code> para mostrar la flexibilidad de los modelos de regresión. Los componentes de regresión se añadirán gradualmente para que podamos tomarnos el tiempo de entender cada uno de ellos así como los correspondientes cambios en la salida de la regresión.</p>
<hr>
<section id="modelo-solo-con-intercepto" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="modelo-solo-con-intercepto"><span class="header-section-number">6.1</span> Modelo solo con intercepto</h2>
<p>Primero vamos a crear una variable numérica de respuesta:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># definir semilla</span></span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-3"><a href="#cb54-3"></a></span>
<span id="cb54-4"><a href="#cb54-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb54-6"><a href="#cb54-6"></a></span>
<span id="cb54-7"><a href="#cb54-7"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb54-8"><a href="#cb54-8"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb54-9"><a href="#cb54-9"></a></span>
<span id="cb54-10"><a href="#cb54-10"></a><span class="co"># put it in a data frame</span></span>
<span id="cb54-11"><a href="#cb54-11"></a>y_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Esta única variable puede introducirse en un <strong>modelo de regresión sólo con intercepto</strong>. Para ello, debemos suministrar la fórmula del modelo y los datos a <code>lm()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># run model</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> y_data)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Lo que equivale a:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Podemos obtener el resumen por defecto de los resultados del modelo ejecutando <code>summary()</code> en el objeto de salida ‘y_mod’:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">summary</span>(y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ 1, data = y_data)

Residuals:
   Min     1Q Median     3Q    Max 
-2.001 -0.594 -0.107  0.664  2.135 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0344     0.1309    0.26     0.79

Residual standard error: 0.926 on 49 degrees of freedom</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Puede ser bastante informativo graficar los tamaños de efecto (aunque en este caso sólo tenemos uno):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(y_mod<span class="sc">$</span>coefficients), </span>
<span id="cb58-2"><a href="#cb58-2"></a>                    <span class="at">est =</span> y_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(y_mod))</span>
<span id="cb58-3"><a href="#cb58-3"></a></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb58-8"><a href="#cb58-8"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Para evaluar la importancia de la asociación nos centramos en la tabla de coeficientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 0.034404    0.13094 0.26275  0.79385</code></pre>
</div>
</div>
<ul>
<li><p>En este ejemplo no hay predictores en el modelo, por lo que sólo tenemos una estimación para el intercepto (<span class="math inline">\(\beta_0\)</span>)</p></li>
<li><p>El modelo nos dice que el intercepto se estima en 0.0344 y que este valor no es significativamente diferente de 0 (valor p = 0.79385)</p></li>
<li><p>En este caso el intercepto es simplemente la media de la variable de respuesta</p></li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">mean</span>(y_data<span class="sc">$</span>y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.034404</code></pre>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li>Rara vez tenemos predicciones sobre el intercepto, por lo que tendemos a ignorar esta estimación.</li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Ruhs, E. C., Martin, L. B., &amp; Downs, C. J. (2020). <a href="https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.0655?download=true"><strong>The impacts of body mass on immune cell concentrations in birds</strong></a>. <em>Proceedings of the Royal Society B</em>, 287(1934), 20200655.</li>
</ul>
<p>“<em>Encontramos que un modelo sólo con intercepto (intercept-only model) explicaba mejor las concentraciones de linfocitos y eosinófilos en las aves, indicando que las concentraciones de estos tipos de células eran independientes de la masa corporal.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/leukocytes.png" class="img-fluid figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 3</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Cambie el argumento ‘mean’ en la llamada de la función “rnorm()` (<a href="#cb53-8">línea 130</a>) por un valor distinto de 0 y observe cómo cambian los valores en la tabla de coeficientes</p></li>
<li><p>Cambia el argumento <code>sd</code> en la llamada a la función <code>rnorm()</code> (<a href="#cb53-8">línea 130</a>) por un valor más alto y observe cómo cambian los valores en la tabla de coeficientes</p></li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="añadir-un-predictor-no-asociado" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="añadir-un-predictor-no-asociado"><span class="header-section-number">6.2</span> Añadir un predictor no asociado</h2>
<p>Podemos crear 2 variables numéricas no relacionadas así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># definir semilla</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a></span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb62-6"><a href="#cb62-6"></a></span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>y <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb62-9"><a href="#cb62-9"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb62-10"><a href="#cb62-10"></a></span>
<span id="cb62-11"><a href="#cb62-11"></a><span class="co"># crear data frame</span></span>
<span id="cb62-12"><a href="#cb62-12"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Estas dos variables pueden introducirse en un modelo de regresión para evaluar la asociación entre ellas:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># construir model</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb63-3"><a href="#cb63-3"></a></span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="co"># graficar</span></span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="fu">ggplot</span>(xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb63-7"><a href="#cb63-7"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Que es equivalente a esto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Imprimamos el resumen de este modelo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">summary</span>(xy_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos)

Residuals:
   Min     1Q Median     3Q    Max 
-2.004 -0.624 -0.123  0.687  2.106 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   0.0398     0.1340    0.30     0.77
x1           -0.0367     0.1475   -0.25     0.80

Residual standard error: 0.935 on 48 degrees of freedom
Multiple R-squared:  0.00129,   Adjusted R-squared:  -0.0195 
F-statistic: 0.0618 on 1 and 48 DF,  p-value: 0.805</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>… y graficar los tamaños de efecto:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod<span class="sc">$</span>coefficients), </span>
<span id="cb67-2"><a href="#cb67-2"></a>                    <span class="at">est =</span> xy_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod))</span>
<span id="cb67-3"><a href="#cb67-3"></a></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb67-5"><a href="#cb67-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb67-8"><a href="#cb67-8"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Deberíamos “diagnosticar” la idoneidad del modelo inspeccionando más de cerca la distribución de los residuales. La función <code>plot_model()</code> del paquete <code>sjPlot</code> hace un buen trabajo para crear gráficos de diagnóstico para modelos lineales:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">plot_model</span>(xy_mod, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-54-2.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-54-3.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con coeficientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error  t value Pr(&gt;|t|)
(Intercept)  0.039774    0.13396  0.29690  0.76782
x1          -0.036679    0.14750 -0.24867  0.80467</code></pre>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><p>En este ejemplo hemos añadido un predictor al modelo, por lo que hemos obtenido una estimado adicional (y una fila extra, ‘x1’)</p></li>
<li><p>El modelo nos dice que la estimación de ‘x1’ es -0.03668 y que no es significativamente diferente de 0 (p = 0.80467)</p></li>
</ul>
</div>
<hr>
<p>&nbsp;</p>
</section>
<section id="simular-un-predictor-asociado" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="simular-un-predictor-asociado"><span class="header-section-number">6.3</span> Simular un predictor asociado</h2>
<p>Podemos utilizar la fórmula del modelo lineal anterior para simular dos variables continuas asociadas así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># definir semilla</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb75-3"><a href="#cb75-3"></a></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb75-6"><a href="#cb75-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb75-7"><a href="#cb75-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="co"># variables aleatorias</span></span>
<span id="cb75-11"><a href="#cb75-11"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb75-12"><a href="#cb75-12"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb75-13"><a href="#cb75-13"></a></span>
<span id="cb75-14"><a href="#cb75-14"></a><span class="co"># crear data frame</span></span>
<span id="cb75-15"><a href="#cb75-15"></a>xy_datos2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Note que <strong>también hemos añadido un término de error</strong>, por lo que la asociación no es perfecta. Vamos a correr el modelo y graficar la asociación entre las dos variables:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co"># construir model</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>xy_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos2)</span>
<span id="cb76-3"><a href="#cb76-3"></a></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="co"># graficar</span></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="fu">ggplot</span>(xy_datos2, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb76-7"><a href="#cb76-7"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>La fórmula es la misma que la del modelo anterior:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Este es el resumen del modelo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="fu">summary</span>(xy_mod2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos2)

Residuals:
   Min     1Q Median     3Q    Max 
 -6.01  -1.87  -0.37   2.06   6.32 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -3.881      0.402   -9.66  7.9e-13 ***
x1             2.890      0.442    6.53  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.8 on 48 degrees of freedom
Multiple R-squared:  0.471, Adjusted R-squared:  0.459 
F-statistic: 42.7 on 1 and 48 DF,  p-value: 3.85e-08</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>.. el gráfico con los tamaños de efecto:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod2<span class="sc">$</span>coefficients), </span>
<span id="cb80-2"><a href="#cb80-2"></a>                    <span class="at">est =</span> xy_mod2<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod2))</span>
<span id="cb80-3"><a href="#cb80-3"></a></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb80-5"><a href="#cb80-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb80-7"><a href="#cb80-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb80-8"><a href="#cb80-8"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>… y los gráficos diagnósticos del modelo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">plot_model</span>(xy_mod2, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-60-2.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-60-3.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -3.8807    0.40188 -9.6562 7.8616e-13
x1            2.8900    0.44249  6.5311 3.8537e-08</code></pre>
</div>
</div>
<ul>
<li><p>El modelo nos dice que <span class="math inline">\(beta_1\)</span> (el tamaño de efecto de ‘x1’) es 2.88996 y que es significativamente diferente de 0 (p = 3.85365^{-8})</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> (the effect size of ‘x1’) was set to 3 and was estimated as 2.89 by the model</li>
</ul></li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Keenan EL, Odom KJ, Araya-Salas M, Horton KG, Strimas-Mackey M, Meatte MA, Mann NI, Slater PJ, Price JJ, and Templeton CN. 2020. <a href="https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.2482"><strong>Breeding season length predicts duet coordination and consistency in Neotropical wrens (Troglodytidae)</strong></a>. <em>Proceeding of the Royal Society B</em>. 20202482</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/duets.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>“<em>… la coordinación y la consistencia de los duetos son mayores en las especies con temporadas de apareamiento especialmente largas.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/duet_reg.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 4</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Aumente el tamaño de la muestra (<code>n</code>) a 1000 o más</p></li>
<li><p>¿Cómo cambiaron los estimados del tamaño de efecto (<span class="math inline">\(\beta\)</span>)?</p></li>
<li><p>¿Cómo cambió el error estándar del tamaño de efecto?</p></li>
<li><p>Ahora cambie <code>n</code> a 15 y compruebe de nuevo las estimaciones del modelo (esta vez compruebe también el valor p)</p></li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="varios-predictores-regresión-múltiple" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="varios-predictores-regresión-múltiple"><span class="header-section-number">6.4</span> Varios predictores: regresión múltiple</h2>
<p>La regresión lineal múltiple es una extensión del modelo de regresión lineal simple que puede tomar varios predictores:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}\)</span></font>
</center>
<p>&nbsp;</p>
<p>La fórmula parece compleja, pero sólo quiere decir que cualquier parámetro adicional tendrá su propia estimación (<span class="math inline">\(\beta\)</span>). La fórmula para una regresión lineal de dos predictores se ve así:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}\)</span></font>
</center>
<p>&nbsp;</p>
<p>… y se puede simular así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co"># semila</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb88-3"><a href="#cb88-3"></a></span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb88-5"><a href="#cb88-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb88-6"><a href="#cb88-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb88-7"><a href="#cb88-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb88-8"><a href="#cb88-8"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb88-9"><a href="#cb88-9"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb88-10"><a href="#cb88-10"></a></span>
<span id="cb88-11"><a href="#cb88-11"></a><span class="co"># variables aleatorias</span></span>
<span id="cb88-12"><a href="#cb88-12"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb88-13"><a href="#cb88-13"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb88-14"><a href="#cb88-14"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb88-15"><a href="#cb88-15"></a></span>
<span id="cb88-16"><a href="#cb88-16"></a><span class="co"># crear un data frame</span></span>
<span id="cb88-17"><a href="#cb88-17"></a>xy_datos_multp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb88-18"><a href="#cb88-18"></a></span>
<span id="cb88-19"><a href="#cb88-19"></a><span class="co"># construir el modelo</span></span>
<span id="cb88-20"><a href="#cb88-20"></a>xy_mod_multp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_multp)</span>
<span id="cb88-21"><a href="#cb88-21"></a></span>
<span id="cb88-22"><a href="#cb88-22"></a><span class="fu">summary</span>(xy_mod_multp)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2, data = xy_datos_multp)

Residuals:
   Min     1Q Median     3Q    Max 
-5.986 -1.893 -0.363  2.002  6.413 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -3.865      0.417   -9.27  3.5e-12 ***
x1             2.901      0.453    6.41  6.4e-08 ***
x2            -1.932      0.414   -4.67  2.6e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.83 on 47 degrees of freedom
Multiple R-squared:  0.612, Adjusted R-squared:  0.595 
F-statistic:   37 on 2 and 47 DF,  p-value: 2.23e-10</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>… graficar los tamaños de efecto:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_multp<span class="sc">$</span>coefficients), </span>
<span id="cb90-2"><a href="#cb90-2"></a>                    <span class="at">est =</span> xy_mod_multp<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_multp))</span>
<span id="cb90-3"><a href="#cb90-3"></a></span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb90-5"><a href="#cb90-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb90-7"><a href="#cb90-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb90-8"><a href="#cb90-8"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>… y los gráficos diagnósticos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">plot_model</span>(xy_mod_multp, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-66-3.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -3.8652    0.41695 -9.2702 3.4856e-12
x1            2.9015    0.45260  6.4108 6.4137e-08
x2           -1.9324    0.41422 -4.6650 2.5851e-05</code></pre>
</div>
</div>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 2.9015 y que es significativamente diferente de 0 (p = 6.41368^{-8}). Este es el efecto de ‘x1’ sobre ‘y’ una vez removida la variación explicada por ‘x2’.</p></li>
<li><p>También se encontró que el <span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) es -1.93235 y que también es significativamente diferente de 0 (p = 2.58513^{-5}). Este es el efecto de ‘x2’ sobre ‘y’ una vez removida la variación explicada por ‘x1’.</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span> se fijó en 3 y se estimó como 2.901.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) se fijó en -2 y se estimó como -1.932.</p></li>
</ul></li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <a href="https://www.nature.com/articles/s41598-018-20441-x"><strong>Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird</strong></a>. <em>Scientific Reports</em>. 13, e0189969</li>
</ul>
<p>“<em>La memoria espacial, el tamaño corporal y el largo de la punta del pico … predijeron positivamente la probabilidad de adquirir y defender un territorio.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lbh_cognition.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<p>Hay un punto importante que es necesario enfatizar aquí: <strong>la regresión múltiple estima el efecto de un predictor después de tener en cuenta el efecto de los demás predictores del modelo</strong>. En otras palabras, los nuevos predictores del modelo tratarán de explicar la variación de los datos que no fue explicada por los otros predictores. Así que <strong>el resultado de la regresión múltiple no es equivalente a los resultados de las regresiones lineales simples</strong> sobre los mismos predictores. Esto puede demostrarse fácilmente corriendo esas regresiones:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co"># construir modelos</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb98-3"><a href="#cb98-3"></a>x2y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb98-4"><a href="#cb98-4"></a></span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="co"># atajo a los coeficientes</span></span>
<span id="cb98-6"><a href="#cb98-6"></a><span class="fu">coef</span>(xy_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1 
   0.039774   -0.036679 </code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">coef</span>(x1y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1 
   0.039774   -0.036679 </code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">coef</span>(x2y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x2 
   0.041320    0.027239 </code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Las estimaciones de las mismas variables varían considerablemente entre la regresión múltiple y las regresiones de un solo predictor.</p>
<p>Este punto se demuestra además por el hecho de que, si uno de los predictores no tiene ninguna influencia en la respuesta, el efecto del predictor adicional convergerá a su efecto en una regresión lineal simple. Para simular este escenario, fijamos b2 en 0:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># definir semilla</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb104-3"><a href="#cb104-3"></a></span>
<span id="cb104-4"><a href="#cb104-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb104-5"><a href="#cb104-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb104-6"><a href="#cb104-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb104-7"><a href="#cb104-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb104-8"><a href="#cb104-8"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-9"><a href="#cb104-9"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb104-10"><a href="#cb104-10"></a></span>
<span id="cb104-11"><a href="#cb104-11"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb104-12"><a href="#cb104-12"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb104-13"><a href="#cb104-13"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb104-14"><a href="#cb104-14"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb104-15"><a href="#cb104-15"></a></span>
<span id="cb104-16"><a href="#cb104-16"></a><span class="co"># crear data frame</span></span>
<span id="cb104-17"><a href="#cb104-17"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb104-18"><a href="#cb104-18"></a></span>
<span id="cb104-19"><a href="#cb104-19"></a><span class="co"># construir modelos</span></span>
<span id="cb104-20"><a href="#cb104-20"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb104-21"><a href="#cb104-21"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb104-22"><a href="#cb104-22"></a></span>
<span id="cb104-23"><a href="#cb104-23"></a><span class="co"># shortcut to coefficients</span></span>
<span id="cb104-24"><a href="#cb104-24"></a><span class="fu">coef</span>(xy_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2 
  -3.955064    2.967166    0.022549 </code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">coef</span>(x1y_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1 
    -3.9602      2.9633 </code></pre>
</div>
</div>
<p>El estimado de <span class="math inline">\(\beta_1\)</span> fue casi el mismo en la regresión múltiple (2.96717) y en la regresión de un solo predictor (2.96332)</p>
<p>Por comodidad, hemos utilizado <code>coef()</code> para extraer sólo los estimado de la regresión, pero los valores son los mismos que obtenemos con <code>summary(model)</code>.</p>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 5</font></p>
<p>&nbsp;</p>
<p>La siguiente simulación genera un par de predictores continuos altamente colineales:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="co"># definir semilla</span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb108-3"><a href="#cb108-3"></a></span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb108-5"><a href="#cb108-5"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb108-6"><a href="#cb108-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb108-7"><a href="#cb108-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb108-8"><a href="#cb108-8"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb108-9"><a href="#cb108-9"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb108-10"><a href="#cb108-10"></a></span>
<span id="cb108-11"><a href="#cb108-11"></a><span class="co">#  variables aleatorias colineales</span></span>
<span id="cb108-12"><a href="#cb108-12"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb108-13"><a href="#cb108-13"></a>x2 <span class="ot">&lt;-</span>  x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>) <span class="co"># hacer x2 colineal con x1</span></span>
<span id="cb108-14"><a href="#cb108-14"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb108-15"><a href="#cb108-15"></a></span>
<span id="cb108-16"><a href="#cb108-16"></a><span class="co"># crear data frame</span></span>
<span id="cb108-17"><a href="#cb108-17"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb108-18"><a href="#cb108-18"></a></span>
<span id="cb108-19"><a href="#cb108-19"></a><span class="fu">cor</span>(x1, x2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.97812</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="co"># graficar</span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2)) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>Construya un modelo lineal multiple (con <code>lm()</code>) con ‘y’ como respuesta y ‘x1’ y ‘x2’ como predictores</p></li>
<li><p>Compare los betas estimados por el modelo con los usados para generar los datos. ¿Es una buena estimación?. También observe los valores de p.&nbsp;¿Esperaría que fueran significativos?</p></li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="añadir-un-predictor-categórico" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="añadir-un-predictor-categórico"><span class="header-section-number">6.5</span> Añadir un predictor categórico</h2>
<p>Para los predictores categóricos podemos crear primero una variable binaria (0, 1) y luego añadir etiquetas a cada valor:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co"># definir semilla</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb111-3"><a href="#cb111-3"></a></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb111-5"><a href="#cb111-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb111-6"><a href="#cb111-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb111-7"><a href="#cb111-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb111-8"><a href="#cb111-8"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb111-9"><a href="#cb111-9"></a></span>
<span id="cb111-10"><a href="#cb111-10"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb111-11"><a href="#cb111-11"></a>x1_num <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb111-12"><a href="#cb111-12"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1_num <span class="sc">+</span> error</span>
<span id="cb111-13"><a href="#cb111-13"></a></span>
<span id="cb111-14"><a href="#cb111-14"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1_num, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb111-15"><a href="#cb111-15"></a></span>
<span id="cb111-16"><a href="#cb111-16"></a><span class="co"># crear data frame</span></span>
<span id="cb111-17"><a href="#cb111-17"></a>xy_datos_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x1_num, y)</span>
<span id="cb111-18"><a href="#cb111-18"></a></span>
<span id="cb111-19"><a href="#cb111-19"></a><span class="fu">head</span>(xy_datos_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x1</th>
<th style="text-align: right;">x1_num</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.66298</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-3.84082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.32549</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.43804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.42758</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1.75342</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Y así es como se escribe formalmente:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Lo mismo que con los predictores continuos.</p>
<p>Podemos explorar el patrón de los datos utilizando un diagrama de cajas (boxplot):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># graficar</span></span>
<span id="cb112-2"><a href="#cb112-2"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="#cb112-3"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>… y obtener los estimados del modelo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="co"># construir modelos</span></span>
<span id="cb113-2"><a href="#cb113-2"></a>xy_mod_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb113-3"><a href="#cb113-3"></a></span>
<span id="cb113-4"><a href="#cb113-4"></a><span class="fu">summary</span>(xy_mod_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos_cat)

Residuals:
   Min     1Q Median     3Q    Max 
-5.898 -1.909 -0.094  1.809  5.506 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -2.997      0.558   -5.37  2.3e-06 ***
x1b            1.814      0.842    2.16    0.036 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.95 on 48 degrees of freedom
Multiple R-squared:  0.0882,    Adjusted R-squared:  0.0693 
F-statistic: 4.65 on 1 and 48 DF,  p-value: 0.0362</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>… graficar los tamaños de efecto:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_cat<span class="sc">$</span>coefficients), </span>
<span id="cb115-2"><a href="#cb115-2"></a>                    <span class="at">est =</span> xy_mod_cat<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_cat))</span>
<span id="cb115-3"><a href="#cb115-3"></a></span>
<span id="cb115-4"><a href="#cb115-4"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb115-5"><a href="#cb115-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-6"><a href="#cb115-6"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb115-7"><a href="#cb115-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb115-8"><a href="#cb115-8"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>… y los gráficos diagnósticos del modelo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="fu">plot_model</span>(xy_mod_cat, <span class="at">type =</span> <span class="st">"diag"</span>)[[<span class="dv">2</span>]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -2.9974    0.55825 -5.3693 2.2677e-06
x1b           1.8140    0.84160  2.1554 3.6172e-02</code></pre>
</div>
</div>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 1.814 y que es significativamente diferente de 0 (p = 0.03617)</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> se fijó en 2 y se estimó como 1.814.</li>
</ul></li>
<li><p>Tenga en cuenta que en este caso el intercepto se refiere a la estimación del nivel ‘a’ en el predictor categórico, que se utilizó como base:</p></li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="co"># graficar</span></span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb119-3"><a href="#cb119-3"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> xy_mod_cat<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Por lo tanto, el intercepto es el mismo que la media de <em>y</em> para la categoría ‘a’:</li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="fu">mean</span>(xy_datos_cat<span class="sc">$</span>y[xy_datos_cat<span class="sc">$</span>x1 <span class="sc">==</span> <span class="st">"a"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.9974</code></pre>
</div>
</div>
<ul>
<li>Observe también que la etiqueta del estimado es ‘x1b’, no ‘x1’ como en los predictores continuos. Esto se debe a que en este caso el estimado se refiere a la diferencia entre los dos niveles de la variable categórica (‘a’ y ‘b’). Más concretamente, nos dice que en promedio las observaciones de la categoría ‘b’ son 1.814 más altas que las observaciones de la categoría ‘a’.</li>
</ul>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Rico-Guevara A, &amp; M Araya-Salas. 2015. <a href="https://academic.oup.com/beheco/article/26/1/21/2262689"><strong>Bills as daggers? A test for sexually dimorphic weapons in a lekking hummingbird species</strong></a>. <em>Behavioral Ecology</em>. 26 (1): 21-29.</li>
</ul>
<p>“<em>Los machos con puntas de pico más grandes y puntiagudas tuvieron más éxito en ganar control de territorios en el lek.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/daggers_lbh.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 6</font></p>
<p>&nbsp;</p>
<ul>
<li>Los datos desbalanceados cuando hay categorías (es decir, algunas categorías tienen muchas más observaciones que otras) pueden ser problemáticos para la inferencia estadística. Modifique el código <a href="#cb99-1">arriba</a> para simular un juego de datos muy desbalanceado y compruebe la precisión del modelo.</li>
</ul>
</div>
<hr>
<div class="alert alert-warning">
<p><font size="6"></font></p><font size="6">
<center>
Variables indicadoras (Dummy variables)
</center>
</font><p><font size="6"></font></p>
<p>En un modelo de regresión, los predictores categóricos también se representan como vectores numéricos. Más concretamente, los predictores categóricos se codifican como 0s y 1s, en los que 1 significa “pertenece a la misma categoría” y 0 “pertenece a una categoría diferente”. Mantuvimos el vector numérico original (‘x1_num’) al simular el juego de datos con el predictor categórico:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="fu">head</span>(xy_datos_cat)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x1</th>
<th style="text-align: right;">x1_num</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.66298</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-3.84082</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2.32549</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.43804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.42758</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1.75342</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Observe que las “b” de la columna “x1” se convierten en 1 en la columna “x1_num” y las “a” se convierten en 0. Esto se denomina variable indicadora y el proceso se conoce como ‘codificación indicadora’ (dummy coding).</p>
<p>En realidad, podemos utilizar el vector numérico en el modelo de regresión y obtener exactamente los mismos resultados:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="co"># summary model with categorical variable</span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="fu">summary</span>(xy_mod_cat)<span class="sc">$</span>coefficients</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -2.9974    0.55825 -5.3693 2.2677e-06
x1b           1.8140    0.84160  2.1554 3.6172e-02</code></pre>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># construir modelos with dummy variable</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>xy_mod_num <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1_num, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb125-3"><a href="#cb125-3"></a></span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="co"># summary with dummy coding</span></span>
<span id="cb125-5"><a href="#cb125-5"></a><span class="fu">summary</span>(xy_mod_num)<span class="sc">$</span>coefficients</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -2.9974    0.55825 -5.3693 2.2677e-06
x1_num        1.8140    0.84160  2.1554 3.6172e-02</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Las cosas se complican un poco más cuando se codifica un predictor categórico con más de dos niveles. Pero la lógica es la misma.</p>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="interacciones" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="interacciones"><span class="header-section-number">6.6</span> Interacciones</h2>
<p>Una interacción estadística se refiere a un efecto de una variable predictora que está mediado por una segunda variable.</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2} + \beta_{3} * x_{1} * x_{2}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Esto es más fácil de entender si se observa la interacción de una variable continua y una binaria:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="co"># definir semilla</span></span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb127-3"><a href="#cb127-3"></a></span>
<span id="cb127-4"><a href="#cb127-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb127-5"><a href="#cb127-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb127-6"><a href="#cb127-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb127-7"><a href="#cb127-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb127-8"><a href="#cb127-8"></a>b2 <span class="ot">&lt;-</span> <span class="fl">1.7</span></span>
<span id="cb127-9"><a href="#cb127-9"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb127-10"><a href="#cb127-10"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb127-11"><a href="#cb127-11"></a></span>
<span id="cb127-12"><a href="#cb127-12"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb127-13"><a href="#cb127-13"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb127-14"><a href="#cb127-14"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb127-15"><a href="#cb127-15"></a></span>
<span id="cb127-16"><a href="#cb127-16"></a><span class="co"># interaccion se añade como el producto dex1 y x2</span></span>
<span id="cb127-17"><a href="#cb127-17"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> b3 <span class="sc">*</span> x1 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb127-18"><a href="#cb127-18"></a></span>
<span id="cb127-19"><a href="#cb127-19"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb127-20"><a href="#cb127-20"></a></span>
<span id="cb127-21"><a href="#cb127-21"></a><span class="co"># crear data frame</span></span>
<span id="cb127-22"><a href="#cb127-22"></a>xy_datos_intr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb127-23"><a href="#cb127-23"></a></span>
<span id="cb127-24"><a href="#cb127-24"></a><span class="fu">head</span>(xy_datos_intr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">b</td>
<td style="text-align: right;">1.02557</td>
<td style="text-align: right;">-4.0147</td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-0.28477</td>
<td style="text-align: right;">-5.1746</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-1.22072</td>
<td style="text-align: right;">-1.3991</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">0.18130</td>
<td style="text-align: right;">-1.0242</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-0.13889</td>
<td style="text-align: right;">-3.8483</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">0.00576</td>
<td style="text-align: right;">4.1377</td>
</tr>
</tbody>
</table>
</div>
</div>
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="co"># construir modelos</span></span>
<span id="cb128-2"><a href="#cb128-2"></a>xy_mod_intr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1 <span class="sc">*</span> x2, <span class="at">data =</span> xy_datos_intr)</span>
<span id="cb128-3"><a href="#cb128-3"></a></span>
<span id="cb128-4"><a href="#cb128-4"></a><span class="co"># guardar resumen para graficar lineas de mejor ajuste</span></span>
<span id="cb128-5"><a href="#cb128-5"></a>xy_summ_intr <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod_intr)</span>
<span id="cb128-6"><a href="#cb128-6"></a></span>
<span id="cb128-7"><a href="#cb128-7"></a>xy_summ_intr</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2 + x1 * x2, data = xy_datos_intr)

Residuals:
   Min     1Q Median     3Q    Max 
-6.222 -1.664 -0.158  1.650  6.383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -4.193      0.570   -7.35  2.7e-09 ***
x1b            3.597      0.806    4.46  5.2e-05 ***
x2             1.327      0.682    1.95   0.0576 .  
x1b:x2        -2.972      0.962   -3.09   0.0034 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.83 on 46 degrees of freedom
Multiple R-squared:  0.396, Adjusted R-squared:  0.357 
F-statistic:   10 on 3 and 46 DF,  p-value: 3.29e-05</code></pre>
</div>
</div>
<p>También ayuda graficar los datos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="co"># graficar</span></span>
<span id="cb130-2"><a href="#cb130-2"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_intr, <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y, <span class="at">color =</span> x1)) <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<p>… y los tamaños de efecto:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_intr<span class="sc">$</span>coefficients), </span>
<span id="cb132-2"><a href="#cb132-2"></a>                    <span class="at">est =</span> xy_mod_intr<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_intr))</span>
<span id="cb132-3"><a href="#cb132-3"></a></span>
<span id="cb132-4"><a href="#cb132-4"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb132-5"><a href="#cb132-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb132-6"><a href="#cb132-6"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb132-7"><a href="#cb132-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb132-8"><a href="#cb132-8"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>También deberíamos revisar los gráficos de diagnóstico:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="fu">plot_model</span>(xy_mod_intr, <span class="at">type =</span> <span class="st">"diag"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-91-2.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-91-3.png" class="img-fluid" style="width:80.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-91-4.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value   Pr(&gt;|t|)
(Intercept)  -4.1930    0.57023 -7.3532 2.6978e-09
x1b           3.5974    0.80607  4.4629 5.1950e-05
x2            1.3274    0.68161  1.9474 5.7610e-02
x1b:x2       -2.9720    0.96227 -3.0885 3.4061e-03</code></pre>
</div>
</div>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1-b’ a ‘x1-a’) es 3.59741 y que es significativamente diferente de 0 (valor p = 5.19496^{-5})</p></li>
<li><p>El modelo encontró que <span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) es 1.32735 y que es significativamente diferente de 0 (p = 0.05761). Esto es en realidad la pendiente de la relación entre x2 e y cuando x1 = `a’</p></li>
<li><p>El modelo encontró que <span class="math inline">\(\beta_3\)</span> (el tamaño de efecto del término de interacción ‘x1 * x2’) es -2.97196 y que es significativamente diferente de 0 (p = 0.00341). Esta es la diferencia entre las pendientes de x2 <em>vs</em> y cuando x1 = ‘a’ y x2 <em>vs</em> y cuando x1 = ‘b’.</p></li>
<li><p>Los valores simulados para los parámetros de regresión pueden compararse con el resumen del modelo <code>lm()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span> se simuló con un valor de 3 y se estimó en 3.597</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> se simuló con un valor de 1.7 y se estimó en 1.327</p></li>
<li><p><span class="math inline">\(\beta_3\)</span> se simuló con un valor de -3 y se estimó en -2.972</p></li>
</ul></li>
</ul>
</div>
<hr>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Chirino F, B Wilink, Araya-Salas M. In prep. <strong>Climatic factors affecting vocal activity in lemur leaf frogs</strong>.</li>
</ul>
<p>“<em>El aumento de la luz de la luna disminuye la actividad vocal de</em> Agalychnis lemur <em>aunque esta relación es mediada por la temperatura.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lemur.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 7</font></p>
<p>&nbsp;</p>
<ul>
<li><p>Modifique el <a href="#simular-un-predictor-asociado">código usado para simular un único predictor asociado</a> aumentando gradualmente el error. Esto se hace aumentando el argumento ‘sd’ en <code>error &lt;- rnorm(n = n, sd = 2)</code>.</p></li>
<li><p>Mire cómo los errores más grandes afectan la inferencia (debe volver a correr los modelos)</p></li>
</ul>
<ul>
<li>Ahora reemplace el término de error con <code>error &lt;- rexp(n = n, rate = 0.2)</code>. Esto crea un error con una distribución exponencial (por lo tanto no normal). Se supone que esto es problemático para el poder inferencial de estos modelos. Compare las estimaciones que obtuvo con los valores de la simulación (‘b0’ y ‘b1’). Explore la distribución de los residuos (<code>plot(nombre_del_modelo)</code>) para los modelos de error ‘normal’ y ‘exponencial’.</li>
</ul>
<ul>
<li>Se supone que la colinealidad (la presencia de predictores correlacionados) afecta a la estabilidad de la regresión múltiple. El siguiente código crea dos predictores altamente colineales (‘x1’ y ‘x2’). La última línea de código muestra la correlación entre ellos.</li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="co"># definir semilla</span></span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb141-3"><a href="#cb141-3"></a></span>
<span id="cb141-4"><a href="#cb141-4"></a><span class="co"># numero de observaciones</span></span>
<span id="cb141-5"><a href="#cb141-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb141-6"><a href="#cb141-6"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb141-7"><a href="#cb141-7"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb141-8"><a href="#cb141-8"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb141-9"><a href="#cb141-9"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb141-10"><a href="#cb141-10"></a></span>
<span id="cb141-11"><a href="#cb141-11"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb141-12"><a href="#cb141-12"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb141-13"><a href="#cb141-13"></a></span>
<span id="cb141-14"><a href="#cb141-14"></a><span class="co"># hacer x2 muy parecido a x1</span></span>
<span id="cb141-15"><a href="#cb141-15"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb141-16"><a href="#cb141-16"></a></span>
<span id="cb141-17"><a href="#cb141-17"></a><span class="fu">cor</span>(x1, x2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.94642</code></pre>
</div>
</div>
<ul>
<li><p>Construya un modelo de regresión múltiple para estos datos (y ~ x1 + x2). Puede utilizar el mismo código que en la sección <a href="#añadir-más-de-un-predictor:-regresión-múltiple">Añadir más de un predictor: regresión múltiple</a>.</p></li>
<li><p>¿Cómo afecta a la inferencia la presencia de predictores colineales? Realice los gráficos de diagnóstico para este modelo (<code>plot(nombre_del_modelo)</code>).</p></li>
<li><p>Simule un juego de datos con tres predictores en los que sólo dos de ellos son altamente colineales. Ajuste un modelo de regresión múltiple (y ~ x1 + x2 + x3) para esos datos y observe cómo la colinealidad afecta a la estimación del predictor no colineal.</p></li>
</ul>
<p>&nbsp;</p>
</div>
<hr>
</section>
</section>
<section id="extender-los-modelos-lineales-a-estructuras-de-datos-más-complejas" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Extender los modelos lineales a estructuras de datos más complejas</h1>
<p>&nbsp;</p>
<section id="modelos-lineales-generalizados-glm" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="modelos-lineales-generalizados-glm"><span class="header-section-number">7.1</span> Modelos lineales generalizados (GLM)</h2>
<p>Los GLM nos permiten modelar la asociación a variables respuesta que no siguen una distribución normal. Además, permiten modelar distribuciones que se asemejan más al proceso que generó los datos. El siguiente código crea un juego de datos con una respuesta que representa cuentas (por lo tanto, no normal):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="co"># definir semilla</span></span>
<span id="cb143-2"><a href="#cb143-2"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb143-3"><a href="#cb143-3"></a></span>
<span id="cb143-4"><a href="#cb143-4"></a><span class="co"># numero de muestas</span></span>
<span id="cb143-5"><a href="#cb143-5"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb143-6"><a href="#cb143-6"></a></span>
<span id="cb143-7"><a href="#cb143-7"></a><span class="co"># coeficientes</span></span>
<span id="cb143-8"><a href="#cb143-8"></a>b0 <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb143-9"><a href="#cb143-9"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb143-10"><a href="#cb143-10"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb143-11"><a href="#cb143-11"></a></span>
<span id="cb143-12"><a href="#cb143-12"></a></span>
<span id="cb143-13"><a href="#cb143-13"></a><span class="co">#generar variables</span></span>
<span id="cb143-14"><a href="#cb143-14"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> <span class="fl">6.5</span>) <span class="co"># lambda = tasa promedio de exitos </span></span>
<span id="cb143-15"><a href="#cb143-15"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, , <span class="fu">length</span>(y))</span>
<span id="cb143-16"><a href="#cb143-16"></a>x1 <span class="ot">&lt;-</span> (<span class="fu">log</span>(y) <span class="sc">-</span> b0 <span class="sc">-</span> b2 <span class="sc">*</span> x2) <span class="sc">/</span> b1</span>
<span id="cb143-17"><a href="#cb143-17"></a></span>
<span id="cb143-18"><a href="#cb143-18"></a><span class="co"># crear data frame</span></span>
<span id="cb143-19"><a href="#cb143-19"></a>xy_datos_pois <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb143-20"><a href="#cb143-20"></a></span>
<span id="cb143-21"><a href="#cb143-21"></a><span class="fu">head</span>(xy_datos_pois)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">x2</th>
<th style="text-align: right;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.14330</td>
<td style="text-align: right;">-0.50000</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.47959</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.45918</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.43878</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.76710</td>
<td style="text-align: right;">-0.41837</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.57378</td>
<td style="text-align: right;">-0.39796</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>También grafiquemos ‘x1’ <em>vs</em> ‘y’:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="co"># graficar</span></span>
<span id="cb144-2"><a href="#cb144-2"></a><span class="fu">ggplot</span>(xy_datos_pois, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb144-3"><a href="#cb144-3"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>La relación no parece muy lineal ni la varianza parece ser constante a través de ‘x1’.</p>
<p>Podemos relajar el requisito de la distribución normal con GLMs. <code>glm()</code> es una función básica de R que nos ayuda a hacer el truco. Para este ejemplo la distribución más apropiada es <em>Poisson</em>. Esto se puede establecer en el argumento `family’ así:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>glm_pois  <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_pois, <span class="at">family =</span> <span class="fu">poisson</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<p>Que es equivalente a esto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim_{poisson} \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Como puede ver el único argumento extra comparado con <code>lm()</code> es <code>family</code>. El resto es simplemente la “fórmula” y los “datos” con los que ya estamos familiarizados. Así que, de nuevo, podemos aprovechar nuestros conocimientos sobre los modelos lineales para extenderlos a estructuras de datos más complejas.</p>
<p>También necesitamos ejecutar <code>summary()</code> para obtener el resultado del modelo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="fu">summary</span>(glm_pois)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = y ~ x1 + x2, family = poisson(), data = xy_datos_pois)

Deviance Residuals: 
      Min         1Q     Median         3Q        Max  
-1.49e-08  -1.49e-08   0.00e+00   0.00e+00   2.98e-08  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.20e+00   1.29e-01    9.31  &lt; 2e-16 ***
x1          1.30e+00   2.20e-01    5.92  3.2e-09 ***
x2          1.39e-16   1.90e-01    0.00        1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 3.9471e+01  on 49  degrees of freedom
Residual deviance: 2.2204e-16  on 47  degrees of freedom
AIC: 186.9

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro de los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error    z value   Pr(&gt;|z|)
(Intercept) 1.2000e+00    0.12889 9.3106e+00 1.2709e-20
x1          1.3000e+00    0.21960 5.9200e+00 3.2198e-09
x2          1.3882e-16    0.19016 7.3003e-16 1.0000e+00</code></pre>
</div>
</div>
<ul>
<li><p>El modelo nos dice que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 1.3 y que es significativamente diferente de 0 (p = 3.21981^{-9}). Esto se interpreta en realidad como que un aumento de 1 unidad de ‘x1’ resulta en ‘y’ (tasa) en un factor de exp(1.3) = 3.6693.</p></li>
<li><p>El modelo también nos dice que <span class="math inline">\(\beta_2\)</span> (el tamaño de efecto de ‘x2’) es 1.38824^{-16} y que es significativamente diferente de 0 (p = 1). Esto significa que un aumento en 1 unidad de ‘x2’ resulta en ‘y’ (tasa) en un factor de exp(1.38824^{-16}) = 1.</p></li>
</ul>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Topp, E. N., Tscharntke, T., &amp; Loos, J. (2022). <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1111/ddi.13257"><strong>Fire and landscape context shape plant and butterfly diversity in a South African shrubland</strong></a>. <em>Diversity and Distributions</em>, 28(3), 357-371.</li>
</ul>
<p>“<em>La riqueza de especies de mariposas es de tres a cuatro veces mayor cuando aumenta el hábitat natural en el paisaje circundante (en un radio de 2 km), mientras que la abundancia de mariposas se asociaba negativamente con el aumento del tiempo transcurrido desde el último incendio.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/butterflies.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Ejercicio 8</font></p>
<p>&nbsp;</p>
<ul>
<li>Intente correr un modelo <code>lm()</code> (con una distribución gaussiana), compare los resultados y compruebe los residuos (<code>plot_model(model_name, type = "diag")</code>)</li>
</ul>
</div>
<p>&nbsp;</p>
<p>Existen muchas otras funciones de distribución y enlace:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/link-functions.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<hr>
</section>
<section id="modelos-de-efectos-variables-modelos-mixtos" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="modelos-de-efectos-variables-modelos-mixtos"><span class="header-section-number">7.2</span> Modelos de efectos variables (modelos mixtos)</h2>
<p>A veces nuestros conjuntos de datos incluyen estructuras con varios niveles de organización. Por ejemplo, cuando tomamos muestras de varios individuos de diferentes poblaciones. En esos casos, la variación en el nivel estructural superior (poblaciones) podría impedir la detección de patrones en el nivel inferior (individuos).</p>
<p>Vamos a simular algunos datos que se asemejan a ese escenario. Tenemos dos predictores continuos (x1) y una respuesta continua (y). Cada muestra procede de 1 de 8 poblaciones diferentes (poblacion):</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="co"># x&lt;- 1</span></span>
<span id="cb149-2"><a href="#cb149-2"></a><span class="co"># definir semilla</span></span>
<span id="cb149-3"><a href="#cb149-3"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb149-4"><a href="#cb149-4"></a></span>
<span id="cb149-5"><a href="#cb149-5"></a><span class="co"># numero de observaciones</span></span>
<span id="cb149-6"><a href="#cb149-6"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb149-7"><a href="#cb149-7"></a>b0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb149-8"><a href="#cb149-8"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb149-9"><a href="#cb149-9"></a>poblacion <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb149-10"><a href="#cb149-10"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb149-11"><a href="#cb149-11"></a></span>
<span id="cb149-12"><a href="#cb149-12"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb149-13"><a href="#cb149-13"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb149-14"><a href="#cb149-14"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> poblacion <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb149-15"><a href="#cb149-15"></a></span>
<span id="cb149-16"><a href="#cb149-16"></a><span class="co"># add letters</span></span>
<span id="cb149-17"><a href="#cb149-17"></a>poblacion <span class="ot">&lt;-</span> letters[poblacion <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb149-18"><a href="#cb149-18"></a></span>
<span id="cb149-19"><a href="#cb149-19"></a><span class="co"># create data set</span></span>
<span id="cb149-20"><a href="#cb149-20"></a>xy_datos_mixto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y, poblacion)</span>
<span id="cb149-21"><a href="#cb149-21"></a></span>
<span id="cb149-22"><a href="#cb149-22"></a><span class="fu">head</span>(xy_datos_mixto, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">x1</th>
<th style="text-align: right;">y</th>
<th style="text-align: left;">poblacion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.54607</td>
<td style="text-align: right;">3.3378</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.56834</td>
<td style="text-align: right;">3.1399</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.63855</td>
<td style="text-align: right;">15.2824</td>
<td style="text-align: left;">i</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.98424</td>
<td style="text-align: right;">2.6610</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.05355</td>
<td style="text-align: right;">3.7312</td>
<td style="text-align: left;">b</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.82294</td>
<td style="text-align: right;">3.0189</td>
<td style="text-align: left;">a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-1.32373</td>
<td style="text-align: right;">3.2186</td>
<td style="text-align: left;">c</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.17854</td>
<td style="text-align: right;">19.0542</td>
<td style="text-align: left;">i</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2.26484</td>
<td style="text-align: right;">15.4549</td>
<td style="text-align: left;">i</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.77843</td>
<td style="text-align: right;">11.6670</td>
<td style="text-align: left;">h</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Podemos explorar la relación entre ‘y’ y ‘x1’ con un gráfico:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb150-2"><a href="#cb150-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>¿Puede ver claramente el patrón de asociación entre las dos variables que hemos utilizado para simular los datos? Podemos seguir explorando los datos con un modelo de regresión lineal simple:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_mixto))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = xy_datos_mixto)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.755  -5.119   0.186   4.602  12.409 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    8.852      0.325   27.21   &lt;2e-16 ***
x1             0.633      0.329    1.92    0.055 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.63 on 298 degrees of freedom
Multiple R-squared:  0.0123,    Adjusted R-squared:  0.00895 
F-statistic:  3.7 on 1 and 298 DF,  p-value: 0.0554</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>A pesar de haber simulado un <span class="math inline">\(\beta_1\)</span> distinto de cero, no tenemos ninguna asociación significativa según este modelo y la estimación de <span class="math inline">\(\beta_1\)</span> está muy lejos de la simulada. Esta pobre inferencia se debe a que estamos ignorando una característica importante de nuestros datos, la agrupación de las muestras en “poblaciones”.</p>
<p>Los modelos de efectos mixtos (también conocidos como modelos multinivel o modelos de efectos variables) pueden ayudarnos a tener en cuenta estas características adicionales, mejorando significativamente nuestro poder de inferencia. Coloreemos cada una de las poblaciones para ver cómo covarían las variables en cada subgrupo de datos:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span> </span>
<span id="cb153-2"><a href="#cb153-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Parece haber un patrón claro de asociación positiva entre x1 e y. El patrón se hace un poco más evidente si mostramos cada población en su propio panel:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span></span>
<span id="cb154-2"><a href="#cb154-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> poblacion) <span class="sc">+</span></span>
<span id="cb154-4"><a href="#cb154-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos_de_regresion_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>&nbsp;</p>
<p>Construyamos un modelo de efectos mixtos utilizando la población como intercepto variable:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a>mix_eff_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> poblacion), <span class="at">data =</span> xy_datos_mixto)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Que es equivalente a esto:</p>
<center>
<font size="6"><span class="math inline">\(\hat{Y} \sim_{gausiana} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1}\)</span></font>
</center>
<p>&nbsp;</p>
<p>Podemos ver el resultado del modelo igual que con un modelo <code>lm()</code>:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="fu">summary</span>(mix_eff_mod)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: y ~ x1 + (1 | poblacion)
   Data: xy_datos_mixto

REML criterion at convergence: 1296.4

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.524 -0.657 -0.032  0.612  3.245 

Random effects:
 Groups    Name        Variance Std.Dev.
 poblacion (Intercept) 30.07    5.48    
 Residual               3.76    1.94    
Number of obs: 300, groups:  poblacion, 9

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)    8.788      1.831   8.003     4.8   0.0014 ** 
x1             1.317      0.115 290.068    11.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
   (Intr)
x1 -0.003</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>El modelo detectó correctamente el patrón simulado y la estimación de <span class="math inline">\(\beta_1\)</span> (1.317) es muy cercana al valor simulado.</p>
<p>&nbsp;</p>
<div class="alert alert-warning">
<center>
<font size="5"><b>Caso de estudio</b></font>
</center>
<p>&nbsp;</p>
<ul>
<li>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <a href="https://www.nature.com/articles/s41598-018-20441-x"><strong>Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird</strong></a>. <em>Scientific Reports</em>. 13, e0189969</li>
</ul>
<p>“<em>… el tamaño corporal mostró una correlación negativa con la frecuencia baja del canto.</em>”</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/lbh_song_size.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p>&nbsp;</p>
<center>
<font size="5"><b>Interpretación del modelo</b></font>
</center>
<p>&nbsp;</p>
<p>Cuadro con los coeficientes (estimados):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error       df t value   Pr(&gt;|t|)
(Intercept)   8.7881     1.8315   8.0031  4.7983 1.3569e-03
x1            1.3166     0.1151 290.0679 11.4395 2.9326e-25</code></pre>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li><p>El modelo encontró que <span class="math inline">\(\beta_1\)</span> (el tamaño de efecto de ‘x1’) es 1.31665 y que es significativamente diferente de 0 (p = 2.93263^{-25})</p></li>
<li><p>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <code>lmer()</code> para tener una idea de la precisión del modelo:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> se fijó en 1.3 y se estimó como 1.317.</li>
</ul></li>
<li><p>La varianza del intercepto para cada población fue de 29.95624 y la desviación estándar de 5.47323</p></li>
<li><p>Los interceptos estimados para cada población son:</p></li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a><span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">-8.22835</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">-6.17134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: right;">-4.23048</td>
</tr>
<tr class="even">
<td style="text-align: left;">d</td>
<td style="text-align: right;">-1.30838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e</td>
<td style="text-align: right;">0.24573</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">2.22552</td>
</tr>
<tr class="odd">
<td style="text-align: left;">g</td>
<td style="text-align: right;">3.91556</td>
</tr>
<tr class="even">
<td style="text-align: left;">h</td>
<td style="text-align: right;">5.75609</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i</td>
<td style="text-align: right;">7.79566</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li>Podemos compararlos con los promedios para cada población en los datos:</li>
</ul>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="co"># sumar interceptos por poblacion a el intercepto total</span></span>
<span id="cb161-2"><a href="#cb161-2"></a>interceptos <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion <span class="sc">+</span> <span class="fu">fixef</span>(mix_eff_mod)[<span class="dv">1</span>]</span>
<span id="cb161-3"><a href="#cb161-3"></a></span>
<span id="cb161-4"><a href="#cb161-4"></a><span class="co"># calcular los promedios por poblacion en los datos </span></span>
<span id="cb161-5"><a href="#cb161-5"></a>prom_pobs <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(y <span class="sc">~</span> poblacion, xy_datos_mixto, mean)</span>
<span id="cb161-6"><a href="#cb161-6"></a></span>
<span id="cb161-7"><a href="#cb161-7"></a><span class="co"># unir</span></span>
<span id="cb161-8"><a href="#cb161-8"></a><span class="fu">cbind</span>(interceptos, <span class="at">prom_pobs=</span> prom_pobs[,<span class="dv">2</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">prom_pobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0.55975</td>
<td style="text-align: right;">0.86151</td>
</tr>
<tr class="even">
<td style="text-align: left;">b</td>
<td style="text-align: right;">2.61677</td>
<td style="text-align: right;">2.76860</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c</td>
<td style="text-align: right;">4.55762</td>
<td style="text-align: right;">4.90112</td>
</tr>
<tr class="even">
<td style="text-align: left;">d</td>
<td style="text-align: right;">7.47972</td>
<td style="text-align: right;">7.73174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">e</td>
<td style="text-align: right;">9.03384</td>
<td style="text-align: right;">8.87649</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">11.01363</td>
<td style="text-align: right;">10.77650</td>
</tr>
<tr class="odd">
<td style="text-align: left;">g</td>
<td style="text-align: right;">12.70366</td>
<td style="text-align: right;">12.62651</td>
</tr>
<tr class="even">
<td style="text-align: left;">h</td>
<td style="text-align: right;">14.54420</td>
<td style="text-align: right;">14.62110</td>
</tr>
<tr class="odd">
<td style="text-align: left;">i</td>
<td style="text-align: right;">16.58376</td>
<td style="text-align: right;">16.42520</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<ul>
<li>La varianza entre los niveles del factor aleatorio (<code>poblacion</code>) es de 29.95624 y la desviación estándar de 5.47323</li>
</ul>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<section id="la-paradoja-de-simpson" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="la-paradoja-de-simpson"><span class="header-section-number">7.2.1</span> La paradoja de Simpson</h3>
<p>La paradoja de Simpson es un fenómeno en estadística en el que una tendencia aparece en varios grupos de datos pero desaparece o se invierte cuando se combinan los grupos. Se ha utilizado para ilustrar el tipo de resultados engañosos que puede generar el ignorar la estructura en los datos y las relaciones causales entre variables.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/simpsons_paradox.gif" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p><font size="3">Tomado de wikipedia</font></p>
<p>&nbsp;</p>
<p>La estructura de los datos debido a observaciones pertenecientes al mismo grupo puede ser tomada en cuenta usando el grupo como un factor aleatorio, tal y como se hizo en el ejemplo anterior.</p>
<p>&nbsp;</p>
<div class="alert alert-info">
<center>
<b><font size="5">Modelos lineales como abordaje estadístico estándar </font></b>
</center>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/swiss_knife.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<center>
<font size="5"><span class="math inline">\(\hat{Y} \sim_{función\ de\ enlace} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}\)</span></font>
</center>
<ul>
<li><p>Este modelo básico incluye una función de enlace que cuando es gausiana (i.e.&nbsp;normal) equivale a un modelo lineal y cuando no, a un modelo generalizado</p></li>
<li><p>Cuando el <span class="math inline">\(\beta_{grupo}\)</span> es diferente entre grupos (i.e.&nbsp;cuando el intercepto difiere entre grupos) es un modelo mixto con intercepto variable (i.e.&nbsp;aleatorio)</p></li>
</ul>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<p>Este manual solo pretende sugerir un abordaje estadístico centrado en los modelos de regresión desde el cual se pueden llevar a cabo adecuadamente la mayoría de los análisis estadísticos que usamos en biología. <strong>El manual no tiene como objetivo explicar en detalle las particularidades de los modelos generalizados y mixtos</strong>. Note que estos modelos, principalmente los mixtos, pueden adaptarse a otras estructuras de datos mas complejas no cubiertas aquí, como lo son las pendientes aleatorias, pendientes e interceptos aleatorios, estructuras de correlación (i.e.&nbsp;autocorrelación espacial o temporal, pedigrís o árboles filogenéticos), medidas repetidas y el uso de pseudoreplicas, entre otras.</p>
<p>&nbsp;</p>
<hr>
</section>
</section>
<section id="referencias" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="referencias"><span class="header-section-number">7.3</span> Referencias</h2>
<ul>
<li><p><a href="https://github.com/rmcelreath/stat_rethinking_2022">Richard McElreath’s Statistical Rethinking book</a></p></li>
<li><p><a href="https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rbinom/">R’s rbinom – Simulate Binomial or Bernoulli trials</a></p></li>
<li><p><a href="https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rnorm/">R’s rnorm – selecting values from a normal distribution</a></p></li>
<li><p><a href="https://www.programmingr.com/examples/neat-tricks/sample-r-function/rexp/">R’s exp – Simulating Exponential Distributions</a></p></li>
<li><p><a href="https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/">Simulating data in R</a></p></li>
</ul>
<p>&nbsp;</p>
<hr>
<p><font size="4">Información de la sesión</font></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=es_CR.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_CR.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_CR.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] car_3.1-2         carData_3.0-5     sjPlot_2.8.15     lmerTest_3.1-3   
 [5] lme4_1.1-35.1     Matrix_1.4-0      viridis_0.6.2     viridisLite_0.4.2
 [9] ggplot2_3.4.4     knitr_1.45       

loaded via a namespace (and not attached):
 [1] tidyr_1.2.0         jsonlite_1.8.7      splines_4.1.2      
 [4] modelr_0.1.11       assertthat_0.2.1    yaml_2.3.7         
 [7] remotes_2.4.2.1     bayestestR_0.13.1   numDeriv_2016.8-1.1
[10] pillar_1.9.0        backports_1.4.1     lattice_0.20-45    
[13] glue_1.6.2          digest_0.6.33       minqa_1.2.4        
[16] colorspace_2.1-0    sandwich_3.0-1      htmltools_0.5.7    
[19] pkgconfig_2.0.3     broom_0.7.12        purrr_0.3.4        
[22] xtable_1.8-4        mvtnorm_1.1-3       scales_1.2.1       
[25] emmeans_1.8.9       tibble_3.2.1        mgcv_1.8-39        
[28] farver_2.1.1        generics_0.1.2      sjlabelled_1.2.0   
[31] sketchy_1.0.2       TH.data_1.1-0       withr_2.5.2        
[34] cli_3.6.1           survival_3.2-13     magrittr_2.0.3     
[37] crayon_1.5.2        estimability_1.4.1  evaluate_0.23      
[40] fansi_1.0.5         nlme_3.1-155        MASS_7.3-55        
[43] tools_4.1.2         lifecycle_1.0.4     multcomp_1.4-18    
[46] munsell_0.5.0       ggeffects_1.3.2     packrat_0.9.2      
[49] compiler_4.1.2      rlang_1.1.2         grid_4.1.2         
[52] nloptr_2.0.0        rstudioapi_0.13     htmlwidgets_1.5.4  
[55] labeling_0.4.3      rmarkdown_2.25      xaringanExtra_0.7.0
[58] boot_1.3-28         gtable_0.3.4        codetools_0.2-18   
[61] abind_1.4-5         sjstats_0.18.2      DBI_1.1.3          
[64] sjmisc_2.8.9        R6_2.5.1            gridExtra_2.3      
[67] zoo_1.8-9           dplyr_1.0.8         performance_0.8.0  
[70] fastmap_1.1.1       utf8_1.2.4          insight_0.19.6     
[73] stringi_1.7.12      Rcpp_1.0.11         vctrs_0.6.4        
[76] tidyselect_1.1.2    xfun_0.41           coda_0.19-4        </code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/marce10\.github\.io\/R_avanzado_2023\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb163" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb163-1"><a href="#cb163-1"></a><span class="co">---</span></span>
<span id="cb163-2"><a href="#cb163-2"></a><span class="an">title:</span><span class="co"> &lt;font size="7"&gt;&lt;b&gt;Modelos de regresión&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb163-3"><a href="#cb163-3"></a><span class="co">---</span></span>
<span id="cb163-4"><a href="#cb163-4"></a></span>
<span id="cb163-5"><a href="#cb163-5"></a><span class="in">```{=html}</span></span>
<span id="cb163-6"><a href="#cb163-6"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb163-7"><a href="#cb163-7"></a><span class="in">body</span></span>
<span id="cb163-8"><a href="#cb163-8"></a><span class="in">  { counter-reset: source-line 0; }</span></span>
<span id="cb163-9"><a href="#cb163-9"></a><span class="in">pre.numberSource code</span></span>
<span id="cb163-10"><a href="#cb163-10"></a><span class="in">  { counter-reset: none; }</span></span>
<span id="cb163-11"><a href="#cb163-11"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb163-12"><a href="#cb163-12"></a><span class="in">```</span></span>
<span id="cb163-13"><a href="#cb163-13"></a></span>
<span id="cb163-14"><a href="#cb163-14"></a><span class="in">```{r,echo=FALSE,message=FALSE}</span></span>
<span id="cb163-15"><a href="#cb163-15"></a></span>
<span id="cb163-16"><a href="#cb163-16"></a><span class="fu">options</span>(<span class="st">"digits"</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb163-17"><a href="#cb163-17"></a><span class="fu">options</span>(<span class="st">"digits.secs"</span><span class="ot">=</span><span class="dv">3</span>)</span>
<span id="cb163-18"><a href="#cb163-18"></a></span>
<span id="cb163-19"><a href="#cb163-19"></a><span class="in">```</span></span>
<span id="cb163-20"><a href="#cb163-20"></a></span>
<span id="cb163-21"><a href="#cb163-21"></a>::: {.alert .alert-info}</span>
<span id="cb163-22"><a href="#cb163-22"></a><span class="fu"># Objetivos del manual {.unnumbered .unlisted}</span></span>
<span id="cb163-23"><a href="#cb163-23"></a></span>
<span id="cb163-24"><a href="#cb163-24"></a><span class="ss">-   </span>Familiarizarse con el formato para reportes dinámicos Rmarkdown/quarto</span>
<span id="cb163-25"><a href="#cb163-25"></a></span>
<span id="cb163-26"><a href="#cb163-26"></a><span class="ss">-   </span>Ser capaz de documentar el manejo y análisis de datos en R usando Rmarkdown/quarto</span>
<span id="cb163-27"><a href="#cb163-27"></a>:::</span>
<span id="cb163-28"><a href="#cb163-28"></a></span>
<span id="cb163-29"><a href="#cb163-29"></a>&nbsp;</span>
<span id="cb163-30"><a href="#cb163-30"></a></span>
<span id="cb163-31"><a href="#cb163-31"></a><span class="in">```{r, echo = FALSE, message=FALSE}</span></span>
<span id="cb163-32"><a href="#cb163-32"></a>  </span>
<span id="cb163-33"><a href="#cb163-33"></a><span class="fu">library</span>(knitr)</span>
<span id="cb163-34"><a href="#cb163-34"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb163-35"><a href="#cb163-35"></a><span class="fu">library</span>(viridis)</span>
<span id="cb163-36"><a href="#cb163-36"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb163-37"><a href="#cb163-37"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb163-38"><a href="#cb163-38"></a><span class="fu">library</span>(car)</span>
<span id="cb163-39"><a href="#cb163-39"></a></span>
<span id="cb163-40"><a href="#cb163-40"></a><span class="co"># ggplot settings</span></span>
<span id="cb163-41"><a href="#cb163-41"></a>geom_histogram <span class="ot">&lt;-</span> <span class="cf">function</span>(...) ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(..., <span class="at">fill =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">8</span>], <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">bins =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb163-42"><a href="#cb163-42"></a></span>
<span id="cb163-43"><a href="#cb163-43"></a>geom_smooth <span class="ot">&lt;-</span> <span class="cf">function</span>(...) ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(..., <span class="at">color =</span> <span class="fu">viridis</span>(<span class="dv">10</span>,  <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">8</span>])</span>
<span id="cb163-44"><a href="#cb163-44"></a></span>
<span id="cb163-45"><a href="#cb163-45"></a>geom_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(...) ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(..., <span class="at">fill =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>])</span>
<span id="cb163-46"><a href="#cb163-46"></a></span>
<span id="cb163-47"><a href="#cb163-47"></a>geom_pointrange <span class="ot">&lt;-</span> <span class="cf">function</span>(...) ggplot2<span class="sc">::</span><span class="fu">geom_pointrange</span>(..., <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>], <span class="at">size =</span> <span class="dv">2</span>) </span>
<span id="cb163-48"><a href="#cb163-48"></a></span>
<span id="cb163-49"><a href="#cb163-49"></a>plot_model <span class="ot">&lt;-</span> <span class="cf">function</span>(...) sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(xy_mod, <span class="at">type =</span> <span class="st">"diag"</span>, <span class="at">colors =</span> <span class="fu">viridis</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>])</span>
<span id="cb163-50"><a href="#cb163-50"></a></span>
<span id="cb163-51"><a href="#cb163-51"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>))</span>
<span id="cb163-52"><a href="#cb163-52"></a></span>
<span id="cb163-53"><a href="#cb163-53"></a><span class="in">```</span></span>
<span id="cb163-54"><a href="#cb163-54"></a></span>
<span id="cb163-55"><a href="#cb163-55"></a><span class="in">```{=html}</span></span>
<span id="cb163-56"><a href="#cb163-56"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb163-57"><a href="#cb163-57"></a><span class="in">body</span></span>
<span id="cb163-58"><a href="#cb163-58"></a><span class="in">  { counter-reset: source-line 0; }</span></span>
<span id="cb163-59"><a href="#cb163-59"></a><span class="in">pre.numberSource code</span></span>
<span id="cb163-60"><a href="#cb163-60"></a><span class="in">  { counter-reset: none; }</span></span>
<span id="cb163-61"><a href="#cb163-61"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb163-62"><a href="#cb163-62"></a><span class="in">```</span></span>
<span id="cb163-63"><a href="#cb163-63"></a>&nbsp;</span>
<span id="cb163-64"><a href="#cb163-64"></a></span>
<span id="cb163-65"><a href="#cb163-65"></a><span class="fu"># Modelos lineales como marco unificador</span></span>
<span id="cb163-66"><a href="#cb163-66"></a></span>
<span id="cb163-67"><a href="#cb163-67"></a>Tradicionalmente, los modelos estadísticos se han enseñado como herramientas desconectadas sin una relación clara entre ellas. Sólo hace falta darle un vistazo a un libro clásico de estadística para biólogos (Sokal &amp; Rolhf):</span>
<span id="cb163-68"><a href="#cb163-68"></a></span>
<span id="cb163-69"><a href="#cb163-69"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-70"><a href="#cb163-70"></a></span>
<span id="cb163-71"><a href="#cb163-71"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/sokal_rohlf.png"</span>)</span>
<span id="cb163-72"><a href="#cb163-72"></a></span>
<span id="cb163-73"><a href="#cb163-73"></a><span class="in">```</span></span>
<span id="cb163-74"><a href="#cb163-74"></a></span>
<span id="cb163-75"><a href="#cb163-75"></a>&nbsp;</span>
<span id="cb163-76"><a href="#cb163-76"></a></span>
<span id="cb163-77"><a href="#cb163-77"></a>Sin embargo, la mayoría de esos modelos estadísticos comunes no son más que casos especiales de modelos lineales. Por lo tanto, aprenderlos como tales puede simplificar mucho las cosas. Este enfoque tiene varias ventajas:</span>
<span id="cb163-78"><a href="#cb163-78"></a></span>
<span id="cb163-79"><a href="#cb163-79"></a><span class="ss">-   </span>En primer lugar, **todo se reduce a *y=a⋅x+b***, lo que simplifica en gran medida el aprendizaje</span>
<span id="cb163-80"><a href="#cb163-80"></a></span>
<span id="cb163-81"><a href="#cb163-81"></a><span class="ss">-   </span>Esto también significa que no hay **necesidad de aprender sobre los parámetros, las hipótesis y la interpretación de los resultados para cada caso especial**.</span>
<span id="cb163-82"><a href="#cb163-82"></a></span>
<span id="cb163-83"><a href="#cb163-83"></a><span class="ss">-   </span>Los modelos lineales se han ampliado para **tener en cuenta distribuciones y estructuras de datos complejas** (por ejemplo, modelos mixtos, modelos lineales generalizados, modelos cero-inflados, etc.) proporcionando una **plataforma más flexible**.</span>
<span id="cb163-84"><a href="#cb163-84"></a></span>
<span id="cb163-85"><a href="#cb163-85"></a><span class="ss">-   </span>Los modelos lineales se **aplican en todos los paradigmas estadísticos** (por ejemplo, frecuentista, bayesiano)</span>
<span id="cb163-86"><a href="#cb163-86"></a></span>
<span id="cb163-87"><a href="#cb163-87"></a>&nbsp;</span>
<span id="cb163-88"><a href="#cb163-88"></a></span>
<span id="cb163-89"><a href="#cb163-89"></a>::: {.alert .alert-info}</span>
<span id="cb163-90"><a href="#cb163-90"></a><span class="fu"># Objetivo del manual</span></span>
<span id="cb163-91"><a href="#cb163-91"></a></span>
<span id="cb163-92"><a href="#cb163-92"></a><span class="ss">&nbsp; - </span>Comprender la inferencia estadística a través de una única herramienta de modelaje (modelos lineales en sentido amplio)</span>
<span id="cb163-93"><a href="#cb163-93"></a></span>
<span id="cb163-94"><a href="#cb163-94"></a><span class="ss">-   </span>Familiarizarse con la construcción de modelos lineales</span>
<span id="cb163-95"><a href="#cb163-95"></a></span>
<span id="cb163-96"><a href="#cb163-96"></a><span class="ss">-   </span>Extender los modelos lineales a diferentes estructuras de datos</span>
<span id="cb163-97"><a href="#cb163-97"></a>:::</span>
<span id="cb163-98"><a href="#cb163-98"></a></span>
<span id="cb163-99"><a href="#cb163-99"></a>&nbsp;</span>
<span id="cb163-100"><a href="#cb163-100"></a></span>
<span id="cb163-101"><a href="#cb163-101"></a>------------------------------------------------------------------------</span>
<span id="cb163-102"><a href="#cb163-102"></a></span>
<span id="cb163-103"><a href="#cb163-103"></a>Paquetes a utilizar en este manual:</span>
<span id="cb163-104"><a href="#cb163-104"></a></span>
<span id="cb163-107"><a href="#cb163-107"></a><span class="in">```{r}</span></span>
<span id="cb163-108"><a href="#cb163-108"></a><span class="co"># instalar/cargar paquetes</span></span>
<span id="cb163-109"><a href="#cb163-109"></a></span>
<span id="cb163-110"><a href="#cb163-110"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(</span>
<span id="cb163-111"><a href="#cb163-111"></a>  <span class="fu">c</span>(<span class="st">"ggplot2"</span>, </span>
<span id="cb163-112"><a href="#cb163-112"></a>    <span class="st">"viridis"</span>, </span>
<span id="cb163-113"><a href="#cb163-113"></a>    <span class="st">"lmerTest"</span>, </span>
<span id="cb163-114"><a href="#cb163-114"></a>    <span class="st">"sjPlot"</span>)</span>
<span id="cb163-115"><a href="#cb163-115"></a>  )</span>
<span id="cb163-116"><a href="#cb163-116"></a></span>
<span id="cb163-117"><a href="#cb163-117"></a><span class="in">```</span></span>
<span id="cb163-118"><a href="#cb163-118"></a></span>
<span id="cb163-119"><a href="#cb163-119"></a>&nbsp;</span>
<span id="cb163-120"><a href="#cb163-120"></a></span>
<span id="cb163-121"><a href="#cb163-121"></a>------------------------------------------------------------------------</span>
<span id="cb163-122"><a href="#cb163-122"></a></span>
<span id="cb163-123"><a href="#cb163-123"></a><span class="fu"># Cómo simular datos</span></span>
<span id="cb163-124"><a href="#cb163-124"></a></span>
<span id="cb163-125"><a href="#cb163-125"></a><span class="fu">## Generación de números aleatorios en R</span></span>
<span id="cb163-126"><a href="#cb163-126"></a></span>
<span id="cb163-127"><a href="#cb163-127"></a>La estadística nos permite inferir patrones en los datos. Solemos utilizar conjuntos de datos reales para enseñar estadística. Sin embargo, puede ser circular entender el funcionamiento interno de una herramienta estadística probando su capacidad para inferir un patrón que no estamos seguros de encontrar en los datos (y no tenemos idea del mecanismo que produjo ese patrón). **Las simulaciones nos permiten crear escenarios controlados en los que conocemos con seguridad los patrones** presentes en los datos y los procesos subyacentes que los han generado.</span>
<span id="cb163-128"><a href="#cb163-128"></a></span>
<span id="cb163-129"><a href="#cb163-129"></a>R ofrece algunas funciones básicas para la simulación de datos. Las más utilizadas son las funciones generadoras de números aleatorios. Los nombres de estas funciones comienzan con *r* (<span class="in">`r____()`</span>). Por ejemplo, <span class="in">`runif()`</span>:</span>
<span id="cb163-130"><a href="#cb163-130"></a></span>
<span id="cb163-131"><a href="#cb163-131"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb163-132"><a href="#cb163-132"></a></span>
<span id="cb163-133"><a href="#cb163-133"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb163-134"><a href="#cb163-134"></a></span>
<span id="cb163-135"><a href="#cb163-135"></a><span class="in">```</span></span>
<span id="cb163-136"><a href="#cb163-136"></a></span>
<span id="cb163-139"><a href="#cb163-139"></a><span class="in">```{r}</span></span>
<span id="cb163-140"><a href="#cb163-140"></a><span class="co"># simular variable uniforme</span></span>
<span id="cb163-141"><a href="#cb163-141"></a>unif_var <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb163-142"><a href="#cb163-142"></a></span>
<span id="cb163-143"><a href="#cb163-143"></a><span class="in">```</span></span>
<span id="cb163-144"><a href="#cb163-144"></a></span>
<span id="cb163-145"><a href="#cb163-145"></a>&nbsp;</span>
<span id="cb163-146"><a href="#cb163-146"></a></span>
<span id="cb163-147"><a href="#cb163-147"></a>El resultado es un vector numérico de longitud 100 (<span class="in">`n = 100`</span>):</span>
<span id="cb163-148"><a href="#cb163-148"></a></span>
<span id="cb163-151"><a href="#cb163-151"></a><span class="in">```{r}</span></span>
<span id="cb163-152"><a href="#cb163-152"></a><span class="co"># imprimir variable</span></span>
<span id="cb163-153"><a href="#cb163-153"></a>unif_var</span>
<span id="cb163-154"><a href="#cb163-154"></a></span>
<span id="cb163-155"><a href="#cb163-155"></a><span class="in">```</span></span>
<span id="cb163-156"><a href="#cb163-156"></a></span>
<span id="cb163-157"><a href="#cb163-157"></a>&nbsp;</span>
<span id="cb163-158"><a href="#cb163-158"></a></span>
<span id="cb163-159"><a href="#cb163-159"></a>Podemos explorar el resultado graficando un histograma:</span>
<span id="cb163-160"><a href="#cb163-160"></a></span>
<span id="cb163-163"><a href="#cb163-163"></a><span class="in">```{r}</span></span>
<span id="cb163-164"><a href="#cb163-164"></a><span class="co"># crear histograma</span></span>
<span id="cb163-165"><a href="#cb163-165"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(unif_var), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> unif_var)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-166"><a href="#cb163-166"></a></span>
<span id="cb163-167"><a href="#cb163-167"></a><span class="in">```</span></span>
<span id="cb163-168"><a href="#cb163-168"></a></span>
<span id="cb163-169"><a href="#cb163-169"></a>&nbsp;</span>
<span id="cb163-170"><a href="#cb163-170"></a></span>
<span id="cb163-171"><a href="#cb163-171"></a>Muestra una distribución uniforme que va de 0 a 10.</span>
<span id="cb163-172"><a href="#cb163-172"></a></span>
<span id="cb163-173"><a href="#cb163-173"></a>También podemos simular números aleatorios procedentes de una distribución normal utilizando <span class="in">`rnorm()`</span>:</span>
<span id="cb163-174"><a href="#cb163-174"></a></span>
<span id="cb163-177"><a href="#cb163-177"></a><span class="in">```{r}</span></span>
<span id="cb163-178"><a href="#cb163-178"></a><span class="co"># crear una variable normal</span></span>
<span id="cb163-179"><a href="#cb163-179"></a>norm_var <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-180"><a href="#cb163-180"></a></span>
<span id="cb163-181"><a href="#cb163-181"></a><span class="co"># graficar histograma</span></span>
<span id="cb163-182"><a href="#cb163-182"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(norm_var), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> norm_var)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-183"><a href="#cb163-183"></a></span>
<span id="cb163-184"><a href="#cb163-184"></a><span class="in">```</span></span>
<span id="cb163-185"><a href="#cb163-185"></a></span>
<span id="cb163-186"><a href="#cb163-186"></a>&nbsp;</span>
<span id="cb163-187"><a href="#cb163-187"></a></span>
<span id="cb163-188"><a href="#cb163-188"></a>Tenga en cuenta que todas las funciones generadoras de números aleatorios tienen el argumento 'n', que determina la longitud del vector generado (es decir, el número de números aleatorios), además de algunos argumentos adicionales relacionados con parámetros específicos de la distribución.</span>
<span id="cb163-189"><a href="#cb163-189"></a></span>
<span id="cb163-190"><a href="#cb163-190"></a>Las variables continuas (es decir, los vectores numéricos) pueden convertirse en variables discretas (es decir, números enteros) simplemente redondeándolas:</span>
<span id="cb163-191"><a href="#cb163-191"></a></span>
<span id="cb163-194"><a href="#cb163-194"></a><span class="in">```{r}</span></span>
<span id="cb163-195"><a href="#cb163-195"></a>v1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-196"><a href="#cb163-196"></a></span>
<span id="cb163-197"><a href="#cb163-197"></a>v1</span>
<span id="cb163-198"><a href="#cb163-198"></a></span>
<span id="cb163-199"><a href="#cb163-199"></a><span class="fu">round</span>(<span class="at">x =</span> v1, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb163-200"><a href="#cb163-200"></a></span>
<span id="cb163-201"><a href="#cb163-201"></a><span class="in">```</span></span>
<span id="cb163-202"><a href="#cb163-202"></a></span>
<span id="cb163-203"><a href="#cb163-203"></a>&nbsp;</span>
<span id="cb163-204"><a href="#cb163-204"></a></span>
<span id="cb163-205"><a href="#cb163-205"></a>::: {.alert .alert-info}</span>
<span id="cb163-206"><a href="#cb163-206"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 1<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-207"><a href="#cb163-207"></a></span>
<span id="cb163-208"><a href="#cb163-208"></a><span class="ss">-   </span>¿Qué hacen las funciones <span class="in">`rbinom()`</span> y <span class="in">`rexp()`</span>?</span>
<span id="cb163-209"><a href="#cb163-209"></a></span>
<span id="cb163-210"><a href="#cb163-210"></a><span class="ss">-   </span>Ejecutela y haga histogramas de sus resultados</span>
<span id="cb163-211"><a href="#cb163-211"></a></span>
<span id="cb163-212"><a href="#cb163-212"></a><span class="ss">-   </span>¿Qué hacen los argumentos 'mean' y 'sd' en <span class="in">`rnorm()`</span>? Juege con diferentes valores y comprueba el histograma para hacerse una idea de su efecto en la simulación</span>
<span id="cb163-213"><a href="#cb163-213"></a>:::</span>
<span id="cb163-214"><a href="#cb163-214"></a></span>
<span id="cb163-215"><a href="#cb163-215"></a>&nbsp;</span>
<span id="cb163-216"><a href="#cb163-216"></a></span>
<span id="cb163-217"><a href="#cb163-217"></a><span class="fu">## Generación de variables categóricas</span></span>
<span id="cb163-218"><a href="#cb163-218"></a></span>
<span id="cb163-219"><a href="#cb163-219"></a>La forma más sencilla de generar variables categóricas es utilizar el vector de ejemplo <span class="in">`letters' (o`</span>LETTERS') para asignar niveles de categoría. Podemos hacerlo utilizando la función <span class="in">`rep()`</span>. Por ejemplo, el siguiente código crea un vector categórico (caracteres) con dos niveles, cada uno con 4 observaciones:</span>
<span id="cb163-220"><a href="#cb163-220"></a></span>
<span id="cb163-223"><a href="#cb163-223"></a><span class="in">```{r}</span></span>
<span id="cb163-224"><a href="#cb163-224"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb163-225"><a href="#cb163-225"></a></span>
<span id="cb163-226"><a href="#cb163-226"></a><span class="in">```</span></span>
<span id="cb163-227"><a href="#cb163-227"></a></span>
<span id="cb163-228"><a href="#cb163-228"></a>&nbsp;</span>
<span id="cb163-229"><a href="#cb163-229"></a></span>
<span id="cb163-230"><a href="#cb163-230"></a>También podemos replicar este patrón utilizando el argumento 'times'. Este código replica el vector anterior 2 veces:</span>
<span id="cb163-231"><a href="#cb163-231"></a></span>
<span id="cb163-234"><a href="#cb163-234"></a><span class="in">```{r}</span></span>
<span id="cb163-235"><a href="#cb163-235"></a><span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">4</span>, <span class="at">times =</span> <span class="dv">2</span>)</span>
<span id="cb163-236"><a href="#cb163-236"></a></span>
<span id="cb163-237"><a href="#cb163-237"></a><span class="in">```</span></span>
<span id="cb163-238"><a href="#cb163-238"></a></span>
<span id="cb163-239"><a href="#cb163-239"></a>&nbsp;</span>
<span id="cb163-240"><a href="#cb163-240"></a></span>
<span id="cb163-241"><a href="#cb163-241"></a>Otra opción es simular una variable a partir de una distribución binomial y luego convertirla en un factor:</span>
<span id="cb163-242"><a href="#cb163-242"></a></span>
<span id="cb163-245"><a href="#cb163-245"></a><span class="in">```{r}</span></span>
<span id="cb163-246"><a href="#cb163-246"></a><span class="co"># correr rbinom</span></span>
<span id="cb163-247"><a href="#cb163-247"></a>binom_var <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb163-248"><a href="#cb163-248"></a></span>
<span id="cb163-249"><a href="#cb163-249"></a>binom_var</span>
<span id="cb163-250"><a href="#cb163-250"></a><span class="in">```</span></span>
<span id="cb163-251"><a href="#cb163-251"></a></span>
<span id="cb163-254"><a href="#cb163-254"></a><span class="in">```{r}</span></span>
<span id="cb163-255"><a href="#cb163-255"></a><span class="co"># convertir a factor</span></span>
<span id="cb163-256"><a href="#cb163-256"></a>categ_var <span class="ot">&lt;-</span> <span class="fu">factor</span>(binom_var, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb163-257"><a href="#cb163-257"></a></span>
<span id="cb163-258"><a href="#cb163-258"></a>categ_var</span>
<span id="cb163-259"><a href="#cb163-259"></a><span class="in">```</span></span>
<span id="cb163-260"><a href="#cb163-260"></a></span>
<span id="cb163-261"><a href="#cb163-261"></a>&nbsp;</span>
<span id="cb163-262"><a href="#cb163-262"></a></span>
<span id="cb163-263"><a href="#cb163-263"></a><span class="fu">## Muestreo aleatorio</span></span>
<span id="cb163-264"><a href="#cb163-264"></a></span>
<span id="cb163-265"><a href="#cb163-265"></a>La otra herramienta importante de R para jugar con datos simulados es <span class="in">`sample()`</span>. Esta función permite tomar muestras de tamaños específicos de vectores. Por ejemplo, tomemos el ejemplo del vector 'letters':</span>
<span id="cb163-266"><a href="#cb163-266"></a></span>
<span id="cb163-269"><a href="#cb163-269"></a><span class="in">```{r}</span></span>
<span id="cb163-270"><a href="#cb163-270"></a>letters</span>
<span id="cb163-271"><a href="#cb163-271"></a></span>
<span id="cb163-272"><a href="#cb163-272"></a><span class="in">```</span></span>
<span id="cb163-273"><a href="#cb163-273"></a></span>
<span id="cb163-274"><a href="#cb163-274"></a>&nbsp;</span>
<span id="cb163-275"><a href="#cb163-275"></a></span>
<span id="cb163-276"><a href="#cb163-276"></a>Podemos tomar una muestra de este vector como es:</span>
<span id="cb163-277"><a href="#cb163-277"></a></span>
<span id="cb163-280"><a href="#cb163-280"></a><span class="in">```{r}</span></span>
<span id="cb163-281"><a href="#cb163-281"></a><span class="co"># tomar muestra</span></span>
<span id="cb163-282"><a href="#cb163-282"></a><span class="fu">sample</span>(<span class="at">x =</span> letters, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb163-283"><a href="#cb163-283"></a></span>
<span id="cb163-284"><a href="#cb163-284"></a><span class="in">```</span></span>
<span id="cb163-285"><a href="#cb163-285"></a></span>
<span id="cb163-286"><a href="#cb163-286"></a>&nbsp;</span>
<span id="cb163-287"><a href="#cb163-287"></a></span>
<span id="cb163-288"><a href="#cb163-288"></a>El argumento 'size' nos permite determinar el tamaño de la muestra. Tenga en cuenta que obtendremos un error si el tamaño es mayor que el propio vector:</span>
<span id="cb163-289"><a href="#cb163-289"></a></span>
<span id="cb163-290"><a href="#cb163-290"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb163-291"><a href="#cb163-291"></a></span>
<span id="cb163-292"><a href="#cb163-292"></a><span class="fu">sample</span>(<span class="at">x =</span> letters, <span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb163-293"><a href="#cb163-293"></a></span>
<span id="cb163-294"><a href="#cb163-294"></a><span class="in">```</span></span>
<span id="cb163-295"><a href="#cb163-295"></a></span>
<span id="cb163-296"><a href="#cb163-296"></a>&nbsp;</span>
<span id="cb163-297"><a href="#cb163-297"></a></span>
<span id="cb163-298"><a href="#cb163-298"></a>Esto sólo puede hacerse cuando el muestreo es con reemplazo (replacement). El muestreo con reemplazo puede aplicarse estableciendo el argumento <span class="in">`replace = TRUE`</span>:</span>
<span id="cb163-299"><a href="#cb163-299"></a></span>
<span id="cb163-302"><a href="#cb163-302"></a><span class="in">```{r}</span></span>
<span id="cb163-303"><a href="#cb163-303"></a><span class="fu">sample</span>(<span class="at">x =</span> letters, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-304"><a href="#cb163-304"></a></span>
<span id="cb163-305"><a href="#cb163-305"></a><span class="in">```</span></span>
<span id="cb163-306"><a href="#cb163-306"></a></span>
<span id="cb163-307"><a href="#cb163-307"></a>&nbsp;</span>
<span id="cb163-308"><a href="#cb163-308"></a></span>
<span id="cb163-309"><a href="#cb163-309"></a><span class="fu">## Iterar un proceso</span></span>
<span id="cb163-310"><a href="#cb163-310"></a></span>
<span id="cb163-311"><a href="#cb163-311"></a>A menudo, las simulaciones deben repetirse varias veces para descartar resultados espurios debidos al azar o simplemente para probar diferentes parámetros. Las funciones de simulación de datos mencionadas anteriormente pueden ejecutarse varias veces (por ejemplo, iteradas) utilizando la función <span class="in">`replicate()`</span>:</span>
<span id="cb163-312"><a href="#cb163-312"></a></span>
<span id="cb163-315"><a href="#cb163-315"></a><span class="in">```{r}</span></span>
<span id="cb163-316"><a href="#cb163-316"></a><span class="co"># replicar</span></span>
<span id="cb163-317"><a href="#cb163-317"></a>repl_rnorm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">expr =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb163-318"><a href="#cb163-318"></a></span>
<span id="cb163-319"><a href="#cb163-319"></a><span class="co"># ver clase</span></span>
<span id="cb163-320"><a href="#cb163-320"></a><span class="fu">class</span>(repl_rnorm)</span>
<span id="cb163-321"><a href="#cb163-321"></a></span>
<span id="cb163-322"><a href="#cb163-322"></a><span class="co"># imprimir</span></span>
<span id="cb163-323"><a href="#cb163-323"></a>repl_rnorm</span>
<span id="cb163-324"><a href="#cb163-324"></a><span class="in">```</span></span>
<span id="cb163-325"><a href="#cb163-325"></a></span>
<span id="cb163-326"><a href="#cb163-326"></a>&nbsp;</span>
<span id="cb163-327"><a href="#cb163-327"></a></span>
<span id="cb163-328"><a href="#cb163-328"></a><span class="fu">## Hacer que las simulaciones sean reproducibles</span></span>
<span id="cb163-329"><a href="#cb163-329"></a></span>
<span id="cb163-330"><a href="#cb163-330"></a>El último truco que necesitamos para ejecutar simulaciones en R es la capacidad de reproducir una simulación (es decir, obtener exactamente los mismos datos y resultados simulados). Esto puede ser útil para que otros investigadores puedan ejecutar nuestros análisis exactamente de la misma manera. Esto puede hacerse fácilmente con la función <span class="in">`set.seed()`</span>. Pruebe a ejecutar el siguiente código. Debería obtener la misma salida:</span>
<span id="cb163-331"><a href="#cb163-331"></a></span>
<span id="cb163-334"><a href="#cb163-334"></a><span class="in">```{r}</span></span>
<span id="cb163-335"><a href="#cb163-335"></a><span class="co"># definir semilla</span></span>
<span id="cb163-336"><a href="#cb163-336"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb163-337"><a href="#cb163-337"></a></span>
<span id="cb163-338"><a href="#cb163-338"></a><span class="co"># crear variable uniforme</span></span>
<span id="cb163-339"><a href="#cb163-339"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb163-340"><a href="#cb163-340"></a></span>
<span id="cb163-341"><a href="#cb163-341"></a><span class="in">```</span></span>
<span id="cb163-342"><a href="#cb163-342"></a></span>
<span id="cb163-343"><a href="#cb163-343"></a>------------------------------------------------------------------------</span>
<span id="cb163-344"><a href="#cb163-344"></a></span>
<span id="cb163-345"><a href="#cb163-345"></a><span class="fu"># Crear juegos de datos</span></span>
<span id="cb163-346"><a href="#cb163-346"></a></span>
<span id="cb163-347"><a href="#cb163-347"></a><span class="fu">## Juegos de datos con variables numéricas y categóricas</span></span>
<span id="cb163-348"><a href="#cb163-348"></a></span>
<span id="cb163-349"><a href="#cb163-349"></a>Ahora que sabemos cómo simular variables continuas y categóricas. Podemos juntarlas para crear conjuntos de datos simulados. Esto se puede hacer utilizando la función <span class="in">`data.frame()`</span>:</span>
<span id="cb163-350"><a href="#cb163-350"></a></span>
<span id="cb163-353"><a href="#cb163-353"></a><span class="in">```{r}</span></span>
<span id="cb163-354"><a href="#cb163-354"></a><span class="co"># crear variable categorica</span></span>
<span id="cb163-355"><a href="#cb163-355"></a>grupo <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb163-356"><a href="#cb163-356"></a></span>
<span id="cb163-357"><a href="#cb163-357"></a><span class="co"># crear variable continuaa</span></span>
<span id="cb163-358"><a href="#cb163-358"></a>size <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-359"><a href="#cb163-359"></a></span>
<span id="cb163-360"><a href="#cb163-360"></a><span class="co"># poner juntas en un data frame</span></span>
<span id="cb163-361"><a href="#cb163-361"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(grupo, size)</span>
<span id="cb163-362"><a href="#cb163-362"></a></span>
<span id="cb163-363"><a href="#cb163-363"></a><span class="co"># imprimir</span></span>
<span id="cb163-364"><a href="#cb163-364"></a>df</span>
<span id="cb163-365"><a href="#cb163-365"></a></span>
<span id="cb163-366"><a href="#cb163-366"></a><span class="in">```</span></span>
<span id="cb163-367"><a href="#cb163-367"></a></span>
<span id="cb163-368"><a href="#cb163-368"></a>Por supuesto, podríamos añadir más variables a este cuadro de datos:</span>
<span id="cb163-369"><a href="#cb163-369"></a></span>
<span id="cb163-372"><a href="#cb163-372"></a><span class="in">```{r}</span></span>
<span id="cb163-373"><a href="#cb163-373"></a><span class="co"># crear variable categorica</span></span>
<span id="cb163-374"><a href="#cb163-374"></a>grupo <span class="ot">&lt;-</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb163-375"><a href="#cb163-375"></a>individuo <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb163-376"><a href="#cb163-376"></a></span>
<span id="cb163-377"><a href="#cb163-377"></a><span class="co"># crear variables continuas</span></span>
<span id="cb163-378"><a href="#cb163-378"></a>size <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-379"><a href="#cb163-379"></a>weight <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb163-380"><a href="#cb163-380"></a></span>
<span id="cb163-381"><a href="#cb163-381"></a><span class="co"># poner todo en un data frame</span></span>
<span id="cb163-382"><a href="#cb163-382"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(grupo, individuo, size, weight)</span>
<span id="cb163-383"><a href="#cb163-383"></a></span>
<span id="cb163-384"><a href="#cb163-384"></a><span class="co"># imprimir</span></span>
<span id="cb163-385"><a href="#cb163-385"></a>df</span>
<span id="cb163-386"><a href="#cb163-386"></a></span>
<span id="cb163-387"><a href="#cb163-387"></a><span class="in">```</span></span>
<span id="cb163-388"><a href="#cb163-388"></a></span>
<span id="cb163-389"><a href="#cb163-389"></a>Y eso es un juego de datos simulados en su forma más básica. Se parece mucho al tipo de datos con los que trabajamos en biología.</span>
<span id="cb163-390"><a href="#cb163-390"></a></span>
<span id="cb163-391"><a href="#cb163-391"></a>------------------------------------------------------------------------</span>
<span id="cb163-392"><a href="#cb163-392"></a></span>
<span id="cb163-393"><a href="#cb163-393"></a><span class="fu"># Cómo utilizar datos simulados para entender el comportamiento de las herramientas estadísticas</span></span>
<span id="cb163-394"><a href="#cb163-394"></a></span>
<span id="cb163-395"><a href="#cb163-395"></a>&nbsp;</span>
<span id="cb163-396"><a href="#cb163-396"></a></span>
<span id="cb163-397"><a href="#cb163-397"></a><span class="fu">## Prueba de concepto: *el Teorema Central del Límite*</span></span>
<span id="cb163-398"><a href="#cb163-398"></a></span>
<span id="cb163-399"><a href="#cb163-399"></a>El <span class="co">[</span><span class="ot">Teorema del Límite Central</span><span class="co">](https://en.wikipedia.org/wiki/Central_limit_theorem)</span> afirma que, si tomamos muestras aleatorias de una población, los promedios de esas muestras seguirán una distribución normal, aunque la población no esté distribuida normalmente. Además, la distribución normal resultante debe tener un promedio cercano al promedio de la población. El teorema es un concepto clave para la estadística inferencial, ya que implica que los métodos estadísticos que funcionan para las distribuciones normales pueden ser aplicables a muchos problemas que implican otros tipos de distribuciones. No obstante, el objetivo aquí es sólo mostrar cómo se pueden utilizar las simulaciones para entender el comportamiento de los métodos estadísticos.</span>
<span id="cb163-400"><a href="#cb163-400"></a></span>
<span id="cb163-401"><a href="#cb163-401"></a>Para comprobar si esas afirmaciones básicas sobre el Teorema del Límite Central son ciertas, podemos utilizar datos simulados en R. Vamos a simular una población de 1000 observaciones con una distribución uniforme:</span>
<span id="cb163-402"><a href="#cb163-402"></a></span>
<span id="cb163-403"><a href="#cb163-403"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb163-404"><a href="#cb163-404"></a></span>
<span id="cb163-405"><a href="#cb163-405"></a><span class="co"># simular popublacion uniforme</span></span>
<span id="cb163-406"><a href="#cb163-406"></a>unif_pop <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb163-407"><a href="#cb163-407"></a></span>
<span id="cb163-408"><a href="#cb163-408"></a><span class="co"># ver histograma</span></span>
<span id="cb163-409"><a href="#cb163-409"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(unif_pop), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> unif_pop)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-410"><a href="#cb163-410"></a></span>
<span id="cb163-411"><a href="#cb163-411"></a><span class="in">```</span></span>
<span id="cb163-412"><a href="#cb163-412"></a></span>
<span id="cb163-413"><a href="#cb163-413"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb163-414"><a href="#cb163-414"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb163-415"><a href="#cb163-415"></a></span>
<span id="cb163-416"><a href="#cb163-416"></a><span class="co"># simulate uniform population</span></span>
<span id="cb163-417"><a href="#cb163-417"></a>unif_pop <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb163-418"><a href="#cb163-418"></a></span>
<span id="cb163-419"><a href="#cb163-419"></a><span class="co"># ver distribucion</span></span>
<span id="cb163-420"><a href="#cb163-420"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(unif_pop), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> unif_pop)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-421"><a href="#cb163-421"></a></span>
<span id="cb163-422"><a href="#cb163-422"></a></span>
<span id="cb163-423"><a href="#cb163-423"></a><span class="in">```</span></span>
<span id="cb163-424"><a href="#cb163-424"></a></span>
<span id="cb163-425"><a href="#cb163-425"></a>&nbsp;</span>
<span id="cb163-426"><a href="#cb163-426"></a></span>
<span id="cb163-427"><a href="#cb163-427"></a>Podemos tomar muestras aleatorias usando <span class="in">`sample()`</span> así:</span>
<span id="cb163-428"><a href="#cb163-428"></a></span>
<span id="cb163-431"><a href="#cb163-431"></a><span class="in">```{r}</span></span>
<span id="cb163-432"><a href="#cb163-432"></a><span class="fu">sample</span>(<span class="at">x =</span> unif_pop, <span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb163-433"><a href="#cb163-433"></a></span>
<span id="cb163-434"><a href="#cb163-434"></a><span class="in">```</span></span>
<span id="cb163-435"><a href="#cb163-435"></a></span>
<span id="cb163-436"><a href="#cb163-436"></a>&nbsp;</span>
<span id="cb163-437"><a href="#cb163-437"></a></span>
<span id="cb163-438"><a href="#cb163-438"></a>Este proceso puede ser replicado varias veces con <span class="in">`replicate()`</span>:</span>
<span id="cb163-439"><a href="#cb163-439"></a></span>
<span id="cb163-442"><a href="#cb163-442"></a><span class="in">```{r}</span></span>
<span id="cb163-443"><a href="#cb163-443"></a><span class="co"># replicar</span></span>
<span id="cb163-444"><a href="#cb163-444"></a>samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">expr =</span> <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="at">x =</span> unif_pop, <span class="at">size =</span> <span class="dv">30</span>)))</span>
<span id="cb163-445"><a href="#cb163-445"></a></span>
<span id="cb163-446"><a href="#cb163-446"></a><span class="in">```</span></span>
<span id="cb163-447"><a href="#cb163-447"></a></span>
<span id="cb163-448"><a href="#cb163-448"></a>&nbsp;</span>
<span id="cb163-449"><a href="#cb163-449"></a></span>
<span id="cb163-450"><a href="#cb163-450"></a>El código anterior toma 100 muestras con 30 valores cada una. Ahora podemos comprobar la distribución de las muestras:</span>
<span id="cb163-451"><a href="#cb163-451"></a></span>
<span id="cb163-452"><a href="#cb163-452"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb163-453"><a href="#cb163-453"></a></span>
<span id="cb163-454"><a href="#cb163-454"></a><span class="co"># ver distribucion/ histograma</span></span>
<span id="cb163-455"><a href="#cb163-455"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(samples), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-456"><a href="#cb163-456"></a></span>
<span id="cb163-457"><a href="#cb163-457"></a></span>
<span id="cb163-458"><a href="#cb163-458"></a><span class="in">```</span></span>
<span id="cb163-459"><a href="#cb163-459"></a></span>
<span id="cb163-460"><a href="#cb163-460"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb163-461"><a href="#cb163-461"></a></span>
<span id="cb163-462"><a href="#cb163-462"></a><span class="co"># ver distribucion</span></span>
<span id="cb163-463"><a href="#cb163-463"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(samples), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-464"><a href="#cb163-464"></a></span>
<span id="cb163-465"><a href="#cb163-465"></a><span class="in">```</span></span>
<span id="cb163-466"><a href="#cb163-466"></a></span>
<span id="cb163-467"><a href="#cb163-467"></a>&nbsp;</span>
<span id="cb163-468"><a href="#cb163-468"></a></span>
<span id="cb163-469"><a href="#cb163-469"></a>... asi como el promedio:</span>
<span id="cb163-470"><a href="#cb163-470"></a></span>
<span id="cb163-473"><a href="#cb163-473"></a><span class="in">```{r}</span></span>
<span id="cb163-474"><a href="#cb163-474"></a><span class="fu">mean</span>(samples)</span>
<span id="cb163-475"><a href="#cb163-475"></a></span>
<span id="cb163-476"><a href="#cb163-476"></a><span class="in">```</span></span>
<span id="cb163-477"><a href="#cb163-477"></a></span>
<span id="cb163-478"><a href="#cb163-478"></a>&nbsp;</span>
<span id="cb163-479"><a href="#cb163-479"></a></span>
<span id="cb163-480"><a href="#cb163-480"></a>Como era de esperar, las muestras siguen una distribución normal con una media cercana a la media de la población, que es:</span>
<span id="cb163-481"><a href="#cb163-481"></a></span>
<span id="cb163-484"><a href="#cb163-484"></a><span class="in">```{r}</span></span>
<span id="cb163-485"><a href="#cb163-485"></a><span class="fu">mean</span>(unif_pop)</span>
<span id="cb163-486"><a href="#cb163-486"></a></span>
<span id="cb163-487"><a href="#cb163-487"></a><span class="in">```</span></span>
<span id="cb163-488"><a href="#cb163-488"></a></span>
<span id="cb163-489"><a href="#cb163-489"></a>&nbsp;</span>
<span id="cb163-490"><a href="#cb163-490"></a></span>
<span id="cb163-491"><a href="#cb163-491"></a>Probemos con una distribución más compleja. Por ejemplo, una distribución bimodal:</span>
<span id="cb163-492"><a href="#cb163-492"></a></span>
<span id="cb163-493"><a href="#cb163-493"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb163-494"><a href="#cb163-494"></a></span>
<span id="cb163-495"><a href="#cb163-495"></a><span class="co"># usar semilla</span></span>
<span id="cb163-496"><a href="#cb163-496"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-497"><a href="#cb163-497"></a></span>
<span id="cb163-498"><a href="#cb163-498"></a><span class="co"># simular variables</span></span>
<span id="cb163-499"><a href="#cb163-499"></a>norm1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-500"><a href="#cb163-500"></a>norm2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-501"><a href="#cb163-501"></a></span>
<span id="cb163-502"><a href="#cb163-502"></a><span class="co"># juntar en una sola variable</span></span>
<span id="cb163-503"><a href="#cb163-503"></a>bimod_pop <span class="ot">&lt;-</span> <span class="fu">c</span>(norm1, norm2)</span>
<span id="cb163-504"><a href="#cb163-504"></a></span>
<span id="cb163-505"><a href="#cb163-505"></a><span class="co"># ver histograma</span></span>
<span id="cb163-506"><a href="#cb163-506"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(bimod_pop), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bimod_pop)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-507"><a href="#cb163-507"></a></span>
<span id="cb163-508"><a href="#cb163-508"></a><span class="in">```</span></span>
<span id="cb163-509"><a href="#cb163-509"></a></span>
<span id="cb163-510"><a href="#cb163-510"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb163-511"><a href="#cb163-511"></a></span>
<span id="cb163-512"><a href="#cb163-512"></a><span class="co"># definir semilla</span></span>
<span id="cb163-513"><a href="#cb163-513"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-514"><a href="#cb163-514"></a></span>
<span id="cb163-515"><a href="#cb163-515"></a>norm1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-516"><a href="#cb163-516"></a>norm2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-517"><a href="#cb163-517"></a></span>
<span id="cb163-518"><a href="#cb163-518"></a>bimod_pop <span class="ot">&lt;-</span> <span class="fu">c</span>(norm1, norm2)</span>
<span id="cb163-519"><a href="#cb163-519"></a></span>
<span id="cb163-520"><a href="#cb163-520"></a><span class="co"># ver distribucion</span></span>
<span id="cb163-521"><a href="#cb163-521"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(bimod_pop), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bimod_pop)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-522"><a href="#cb163-522"></a><span class="in">```</span></span>
<span id="cb163-523"><a href="#cb163-523"></a></span>
<span id="cb163-524"><a href="#cb163-524"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb163-525"><a href="#cb163-525"></a></span>
<span id="cb163-526"><a href="#cb163-526"></a><span class="co"># replicar muestreo</span></span>
<span id="cb163-527"><a href="#cb163-527"></a>samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(bimod_pop, <span class="dv">10</span>)))</span>
<span id="cb163-528"><a href="#cb163-528"></a></span>
<span id="cb163-529"><a href="#cb163-529"></a><span class="co"># ver histograma</span></span>
<span id="cb163-530"><a href="#cb163-530"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(samples), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-531"><a href="#cb163-531"></a></span>
<span id="cb163-532"><a href="#cb163-532"></a><span class="in">```</span></span>
<span id="cb163-533"><a href="#cb163-533"></a></span>
<span id="cb163-534"><a href="#cb163-534"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb163-535"><a href="#cb163-535"></a></span>
<span id="cb163-536"><a href="#cb163-536"></a>samples <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(bimod_pop, <span class="dv">10</span>)))</span>
<span id="cb163-537"><a href="#cb163-537"></a></span>
<span id="cb163-538"><a href="#cb163-538"></a><span class="co"># ver distribucion</span></span>
<span id="cb163-539"><a href="#cb163-539"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(samples), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-540"><a href="#cb163-540"></a></span>
<span id="cb163-541"><a href="#cb163-541"></a><span class="in">```</span></span>
<span id="cb163-542"><a href="#cb163-542"></a></span>
<span id="cb163-545"><a href="#cb163-545"></a><span class="in">```{r}</span></span>
<span id="cb163-546"><a href="#cb163-546"></a><span class="co"># ver promedios</span></span>
<span id="cb163-547"><a href="#cb163-547"></a><span class="fu">mean</span>(samples)</span>
<span id="cb163-548"><a href="#cb163-548"></a></span>
<span id="cb163-549"><a href="#cb163-549"></a><span class="fu">mean</span>(bimod_pop)</span>
<span id="cb163-550"><a href="#cb163-550"></a><span class="in">```</span></span>
<span id="cb163-551"><a href="#cb163-551"></a></span>
<span id="cb163-552"><a href="#cb163-552"></a>&nbsp;</span>
<span id="cb163-553"><a href="#cb163-553"></a></span>
<span id="cb163-554"><a href="#cb163-554"></a>::: {.alert .alert-info}</span>
<span id="cb163-555"><a href="#cb163-555"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 2<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-556"><a href="#cb163-556"></a></span>
<span id="cb163-557"><a href="#cb163-557"></a>&nbsp;</span>
<span id="cb163-558"><a href="#cb163-558"></a></span>
<span id="cb163-559"><a href="#cb163-559"></a><span class="ss">-   </span>Intenta explorar el Teorema del Límite Central como en el caso anterior, pero esta vez utilizando:</span>
<span id="cb163-560"><a href="#cb163-560"></a></span>
<span id="cb163-561"><a href="#cb163-561"></a><span class="ss">    1.  </span>Una distribución exponencial (<span class="in">`rexp()`</span>)</span>
<span id="cb163-562"><a href="#cb163-562"></a><span class="ss">    2.  </span>Una distribución binomial (<span class="in">`rbinom()`</span>)</span>
<span id="cb163-563"><a href="#cb163-563"></a></span>
<span id="cb163-564"><a href="#cb163-564"></a>&nbsp;</span>
<span id="cb163-565"><a href="#cb163-565"></a></span>
<span id="cb163-566"><a href="#cb163-566"></a><span class="ss">-   </span>Para cada distribución: grafique un histograma y compare los promedios de la población y de las muestras</span>
<span id="cb163-567"><a href="#cb163-567"></a>:::</span>
<span id="cb163-568"><a href="#cb163-568"></a></span>
<span id="cb163-569"><a href="#cb163-569"></a>&nbsp;</span>
<span id="cb163-570"><a href="#cb163-570"></a></span>
<span id="cb163-571"><a href="#cb163-571"></a>------------------------------------------------------------------------</span>
<span id="cb163-572"><a href="#cb163-572"></a></span>
<span id="cb163-573"><a href="#cb163-573"></a>::: {.alert .alert-warning}</span>
<span id="cb163-574"><a href="#cb163-574"></a><span class="kw">&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span></span>
<span id="cb163-575"><a href="#cb163-575"></a></span>
<span id="cb163-576"><a href="#cb163-576"></a><span class="kw">&lt;center&gt;</span>Regresión lineal simple<span class="kw">&lt;/center&gt;</span></span>
<span id="cb163-577"><a href="#cb163-577"></a></span>
<span id="cb163-578"><a href="#cb163-578"></a><span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-579"><a href="#cb163-579"></a></span>
<span id="cb163-580"><a href="#cb163-580"></a>Las regresiones lineales se basan en la ecuación lineal *a = mx + b* que aprendimos en el colegio. La representación formal tiene este aspecto:</span>
<span id="cb163-581"><a href="#cb163-581"></a></span>
<span id="cb163-582"><a href="#cb163-582"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-583"><a href="#cb163-583"></a></span>
<span id="cb163-584"><a href="#cb163-584"></a>&nbsp;</span>
<span id="cb163-585"><a href="#cb163-585"></a></span>
<span id="cb163-586"><a href="#cb163-586"></a><span class="ss">-   </span>$\hat{Y}$: variable respuesta</span>
<span id="cb163-587"><a href="#cb163-587"></a></span>
<span id="cb163-588"><a href="#cb163-588"></a><span class="ss">-   </span>$\beta_{o}$: intercepto</span>
<span id="cb163-589"><a href="#cb163-589"></a></span>
<span id="cb163-590"><a href="#cb163-590"></a><span class="ss">-   </span>$\beta_{1}$: estimado de la magnitud del efecto de $x_{1}$ en $\hat{Y}$ (también conocido como tamaño de efecto, coeficiente o simplemente "estimado")</span>
<span id="cb163-591"><a href="#cb163-591"></a></span>
<span id="cb163-592"><a href="#cb163-592"></a><span class="ss">-   </span>$x_{1}$: variable predictora</span>
<span id="cb163-593"><a href="#cb163-593"></a></span>
<span id="cb163-594"><a href="#cb163-594"></a>&nbsp;</span>
<span id="cb163-595"><a href="#cb163-595"></a></span>
<span id="cb163-596"><a href="#cb163-596"></a>El objetivo más común de una regresión lineal es la estimación de los valores de $\beta_{*}$. Esto se consigue encontrando la línea recta que mejor se ajusta y que representa la asociación entre un predictor y la respuesta:</span>
<span id="cb163-597"><a href="#cb163-597"></a></span>
<span id="cb163-598"><a href="#cb163-598"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-599"><a href="#cb163-599"></a></span>
<span id="cb163-600"><a href="#cb163-600"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/regression.jpg"</span>)</span>
<span id="cb163-601"><a href="#cb163-601"></a></span>
<span id="cb163-602"><a href="#cb163-602"></a><span class="in">```</span></span>
<span id="cb163-603"><a href="#cb163-603"></a></span>
<span id="cb163-604"><a href="#cb163-604"></a>&nbsp;</span>
<span id="cb163-605"><a href="#cb163-605"></a></span>
<span id="cb163-606"><a href="#cb163-606"></a>Estos $\beta_{*}$ son el tamaño de efecto estimado del predictor correspondiente (por ejemplo, $\beta_{1}$ es el tamaño de efecto $x_{1}$). Su valor representa el cambio medio en $\hat{Y}$ (en unidades $\hat{Y}$) para una unidad de cambio en $\beta_{*}$. Por lo tanto, la hipótesis nula es que esos $\beta_{*}$ no son diferentes de 0:</span>
<span id="cb163-607"><a href="#cb163-607"></a></span>
<span id="cb163-608"><a href="#cb163-608"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\qquad \mathcal{H}_0: \hat{Y} = \beta_0 + 0 * x_{1}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-609"><a href="#cb163-609"></a></span>
<span id="cb163-610"><a href="#cb163-610"></a>lo que equivale a esto:</span>
<span id="cb163-611"><a href="#cb163-611"></a></span>
<span id="cb163-612"><a href="#cb163-612"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\qquad \mathcal{H}_0: \hat{Y} = \beta_0$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-613"><a href="#cb163-613"></a></span>
<span id="cb163-614"><a href="#cb163-614"></a>&nbsp;</span>
<span id="cb163-615"><a href="#cb163-615"></a></span>
<span id="cb163-616"><a href="#cb163-616"></a><span class="in">```{r, echo = FALSE, eval = FALSE}</span></span>
<span id="cb163-617"><a href="#cb163-617"></a></span>
<span id="cb163-618"><a href="#cb163-618"></a>For instance, a regression model with this output<span class="sc">:</span></span>
<span id="cb163-619"><a href="#cb163-619"></a></span>
<span id="cb163-620"><a href="#cb163-620"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-621"><a href="#cb163-621"></a></span>
<span id="cb163-622"><a href="#cb163-622"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-623"><a href="#cb163-623"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-624"><a href="#cb163-624"></a>b0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb163-625"><a href="#cb163-625"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-626"><a href="#cb163-626"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb163-627"><a href="#cb163-627"></a></span>
<span id="cb163-628"><a href="#cb163-628"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-629"><a href="#cb163-629"></a>B1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-630"><a href="#cb163-630"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> B1 <span class="sc">+</span> error</span>
<span id="cb163-631"><a href="#cb163-631"></a></span>
<span id="cb163-632"><a href="#cb163-632"></a><span class="co"># crear data frame</span></span>
<span id="cb163-633"><a href="#cb163-633"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(B1, y)</span>
<span id="cb163-634"><a href="#cb163-634"></a></span>
<span id="cb163-635"><a href="#cb163-635"></a><span class="co"># construir modelos</span></span>
<span id="cb163-636"><a href="#cb163-636"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> B1, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-637"><a href="#cb163-637"></a></span>
<span id="cb163-638"><a href="#cb163-638"></a><span class="fu">summary</span>(xy_mod)<span class="sc">$</span>coefficients</span>
<span id="cb163-639"><a href="#cb163-639"></a></span>
<span id="cb163-640"><a href="#cb163-640"></a>Results <span class="cf">in</span> the following predictive model<span class="sc">:</span></span>
<span id="cb163-641"><a href="#cb163-641"></a></span>
<span id="cb163-642"><a href="#cb163-642"></a><span class="er">&lt;</span>center<span class="sc">&gt;</span><span class="er">&lt;</span>font size <span class="ot">=</span> <span class="dv">6</span><span class="sc">&gt;</span><span class="er">$</span>\hat{Y} \sim <span class="fl">1.079</span> <span class="sc">+</span> <span class="fl">2.926</span> <span class="sc">*</span> x_{<span class="dv">1</span>}<span class="sc">$</span><span class="er">&lt;/</span>font<span class="sc">&gt;</span><span class="er">&lt;/</span>center<span class="sc">&gt;</span></span>
<span id="cb163-643"><a href="#cb163-643"></a></span>
<span id="cb163-644"><a href="#cb163-644"></a><span class="in">```</span></span>
<span id="cb163-645"><a href="#cb163-645"></a></span>
<span id="cb163-646"><a href="#cb163-646"></a>Por ejemplo, un modelo de regresión con este resultado:</span>
<span id="cb163-647"><a href="#cb163-647"></a></span>
<span id="cb163-648"><a href="#cb163-648"></a><span class="in">```{r, out.width = "90%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-649"><a href="#cb163-649"></a></span>
<span id="cb163-650"><a href="#cb163-650"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/model_betas_esp.png"</span>)</span>
<span id="cb163-651"><a href="#cb163-651"></a></span>
<span id="cb163-652"><a href="#cb163-652"></a><span class="in">```</span></span>
<span id="cb163-653"><a href="#cb163-653"></a></span>
<span id="cb163-654"><a href="#cb163-654"></a>&nbsp;</span>
<span id="cb163-655"><a href="#cb163-655"></a>:::</span>
<span id="cb163-656"><a href="#cb163-656"></a></span>
<span id="cb163-657"><a href="#cb163-657"></a>&nbsp;</span>
<span id="cb163-658"><a href="#cb163-658"></a></span>
<span id="cb163-659"><a href="#cb163-659"></a>------------------------------------------------------------------------</span>
<span id="cb163-660"><a href="#cb163-660"></a></span>
<span id="cb163-661"><a href="#cb163-661"></a><span class="fu"># Regresión lineal en R</span></span>
<span id="cb163-662"><a href="#cb163-662"></a></span>
<span id="cb163-663"><a href="#cb163-663"></a>Para sacar el máximo provecho de los modelos lineales necesitamos sentirnos cómodos con ellos. Empezaremos explorando la función de regresión lineal de R <span class="in">`lm()`</span>. En R la mayoría de los modelos lineales y sus extensiones comparten formatos comunes de entrada de datos y resultados, lo que facilita su aplicación una vez que entendemos sus fundamentos.</span>
<span id="cb163-664"><a href="#cb163-664"></a></span>
<span id="cb163-665"><a href="#cb163-665"></a>Utilizaremos el juego de datos 'trees' que viene por defecto con R. 'trees' proporciona medidas del **diámetro** (etiquetado como 'Girth'), **altura** y **volumen** de 31 cerezos talados:</span>
<span id="cb163-666"><a href="#cb163-666"></a></span>
<span id="cb163-669"><a href="#cb163-669"></a><span class="in">```{r}</span></span>
<span id="cb163-670"><a href="#cb163-670"></a><span class="fu">head</span>(trees)</span>
<span id="cb163-671"><a href="#cb163-671"></a></span>
<span id="cb163-672"><a href="#cb163-672"></a><span class="in">```</span></span>
<span id="cb163-673"><a href="#cb163-673"></a></span>
<span id="cb163-674"><a href="#cb163-674"></a>&nbsp;</span>
<span id="cb163-675"><a href="#cb163-675"></a></span>
<span id="cb163-676"><a href="#cb163-676"></a>La función básica de R para construir un modelo lineal es <span class="in">`lm()`</span>. Veamos los componentes básicos de un modelo de regresión utilizando <span class="in">`lm()`</span>:</span>
<span id="cb163-677"><a href="#cb163-677"></a></span>
<span id="cb163-678"><a href="#cb163-678"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-679"><a href="#cb163-679"></a></span>
<span id="cb163-680"><a href="#cb163-680"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/lm.png"</span>)</span>
<span id="cb163-681"><a href="#cb163-681"></a></span>
<span id="cb163-682"><a href="#cb163-682"></a><span class="in">```</span></span>
<span id="cb163-683"><a href="#cb163-683"></a></span>
<span id="cb163-684"><a href="#cb163-684"></a>&nbsp;</span>
<span id="cb163-685"><a href="#cb163-685"></a></span>
<span id="cb163-686"><a href="#cb163-686"></a>Podemos correr este modelo para ver el resultado:</span>
<span id="cb163-687"><a href="#cb163-687"></a></span>
<span id="cb163-690"><a href="#cb163-690"></a><span class="in">```{r}</span></span>
<span id="cb163-691"><a href="#cb163-691"></a>reg_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Height <span class="sc">~</span> Girth, <span class="at">data =</span> trees)</span>
<span id="cb163-692"><a href="#cb163-692"></a></span>
<span id="cb163-693"><a href="#cb163-693"></a><span class="fu">summary</span>(reg_mod)</span>
<span id="cb163-694"><a href="#cb163-694"></a></span>
<span id="cb163-695"><a href="#cb163-695"></a><span class="in">```</span></span>
<span id="cb163-696"><a href="#cb163-696"></a></span>
<span id="cb163-697"><a href="#cb163-697"></a>&nbsp;</span>
<span id="cb163-698"><a href="#cb163-698"></a></span>
<span id="cb163-699"><a href="#cb163-699"></a>Esto es lo que significan los elementos de la salida:</span>
<span id="cb163-700"><a href="#cb163-700"></a></span>
<span id="cb163-701"><a href="#cb163-701"></a><span class="ss">-   </span>**Llamada** (call): la función y los parámetros que se utilizaron para crear el modelo</span>
<span id="cb163-702"><a href="#cb163-702"></a></span>
<span id="cb163-703"><a href="#cb163-703"></a><span class="ss">-   </span>**Residuales** (residuals): distribución de los residuales. Los residuales son la diferencia entre lo que predijo el modelo y el valor real de *y*. Esta es una representación gráfica de los residuales:</span>
<span id="cb163-704"><a href="#cb163-704"></a></span>
<span id="cb163-705"><a href="#cb163-705"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb163-706"><a href="#cb163-706"></a></span>
<span id="cb163-707"><a href="#cb163-707"></a><span class="co"># añadir valores predichos</span></span>
<span id="cb163-708"><a href="#cb163-708"></a>trees<span class="sc">$</span>predicted <span class="ot">&lt;-</span> reg_mod<span class="sc">$</span>fitted.values</span>
<span id="cb163-709"><a href="#cb163-709"></a></span>
<span id="cb163-710"><a href="#cb163-710"></a><span class="co"># graficar</span></span>
<span id="cb163-711"><a href="#cb163-711"></a><span class="fu">ggplot</span>(trees, <span class="fu">aes</span>(<span class="at">x =</span> Girth, <span class="at">y =</span> Height)) <span class="sc">+</span> </span>
<span id="cb163-712"><a href="#cb163-712"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb163-713"><a href="#cb163-713"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Diámetro (Girth)"</span>, <span class="at">y =</span> <span class="st">"Alto (height)"</span>) <span class="sc">+</span></span>
<span id="cb163-714"><a href="#cb163-714"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Girth, <span class="at">yend =</span> predicted), <span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-715"><a href="#cb163-715"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb163-716"><a href="#cb163-716"></a></span>
<span id="cb163-717"><a href="#cb163-717"></a><span class="in">```</span></span>
<span id="cb163-718"><a href="#cb163-718"></a></span>
<span id="cb163-719"><a href="#cb163-719"></a>&nbsp;</span>
<span id="cb163-720"><a href="#cb163-720"></a></span>
<span id="cb163-721"><a href="#cb163-721"></a><span class="ss">-   </span>**Coeficientes** (coefficients): contiene los tamaños de efecto ('Estimates'), una medida de su incertidumbre ('Standar error'), la estadística asociada ('t value') y el valor p ('Pr(<span class="sc">\&gt;</span>\|t\|)'). Los tamaño de efecto o estimados se dan como el cambio promedio en *y* por cada aumento de 1 unidad en *x*. Para este ejemplo el estimado es de 1,0544 $in / in$. A pesar de que las unidades se anulan (<span class="sc">\`</span>1,0544 $in / in$ = 1,0544) tenerlas en cuenta sigue siendo biológicamente significativo. Significan que, en promedio, y un aumento de 1 pulgada en la circunferencia que se espera un aumento de 1,0544 pulgadas en la altura.</span>
<span id="cb163-722"><a href="#cb163-722"></a></span>
<span id="cb163-723"><a href="#cb163-723"></a><span class="ss">-   </span>**Error estándar de los residuales** (residual standard error): se explica por sí mismo. El error estándar de los residuales</span>
<span id="cb163-724"><a href="#cb163-724"></a></span>
<span id="cb163-725"><a href="#cb163-725"></a><span class="ss">-   </span>**R-cuadrado múltiple** (multiple R-squared): el coeficiente de determinación, que pretende ser una medida de lo bien que su modelo se ajusta a los datos</span>
<span id="cb163-726"><a href="#cb163-726"></a></span>
<span id="cb163-727"><a href="#cb163-727"></a><span class="ss">-   </span>**R-cuadrado ajustado** (adjusted R-squared): similar al 'R-cuadrado múltiple' pero penalizado por el número de parámetros</span>
<span id="cb163-728"><a href="#cb163-728"></a></span>
<span id="cb163-729"><a href="#cb163-729"></a><span class="ss">-   </span>**Estadístico F** (F-statistic): estadístico para una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</span>
<span id="cb163-730"><a href="#cb163-730"></a></span>
<span id="cb163-731"><a href="#cb163-731"></a><span class="ss">-   </span>**Valor de p**: probabilidad de una prueba global que comprueba si al menos uno de sus coeficientes es distinto de cero</span>
<span id="cb163-732"><a href="#cb163-732"></a></span>
<span id="cb163-733"><a href="#cb163-733"></a>&nbsp;</span>
<span id="cb163-734"><a href="#cb163-734"></a></span>
<span id="cb163-735"><a href="#cb163-735"></a>Utilizaremos <span class="in">`lm()`</span> para mostrar la flexibilidad de los modelos de regresión. Los componentes de regresión se añadirán gradualmente para que podamos tomarnos el tiempo de entender cada uno de ellos así como los correspondientes cambios en la salida de la regresión.</span>
<span id="cb163-736"><a href="#cb163-736"></a></span>
<span id="cb163-737"><a href="#cb163-737"></a>------------------------------------------------------------------------</span>
<span id="cb163-738"><a href="#cb163-738"></a></span>
<span id="cb163-739"><a href="#cb163-739"></a><span class="fu">## Modelo solo con intercepto</span></span>
<span id="cb163-740"><a href="#cb163-740"></a></span>
<span id="cb163-741"><a href="#cb163-741"></a>Primero vamos a crear una variable numérica de respuesta:</span>
<span id="cb163-742"><a href="#cb163-742"></a></span>
<span id="cb163-745"><a href="#cb163-745"></a><span class="in">```{r}</span></span>
<span id="cb163-746"><a href="#cb163-746"></a><span class="co"># definir semilla</span></span>
<span id="cb163-747"><a href="#cb163-747"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-748"><a href="#cb163-748"></a></span>
<span id="cb163-749"><a href="#cb163-749"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-750"><a href="#cb163-750"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-751"><a href="#cb163-751"></a></span>
<span id="cb163-752"><a href="#cb163-752"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-753"><a href="#cb163-753"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-754"><a href="#cb163-754"></a></span>
<span id="cb163-755"><a href="#cb163-755"></a><span class="co"># put it in a data frame</span></span>
<span id="cb163-756"><a href="#cb163-756"></a>y_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb163-757"><a href="#cb163-757"></a><span class="in">```</span></span>
<span id="cb163-758"><a href="#cb163-758"></a></span>
<span id="cb163-759"><a href="#cb163-759"></a>&nbsp;</span>
<span id="cb163-760"><a href="#cb163-760"></a></span>
<span id="cb163-761"><a href="#cb163-761"></a>Esta única variable puede introducirse en un **modelo de regresión sólo con intercepto**. Para ello, debemos suministrar la fórmula del modelo y los datos a <span class="in">`lm()`</span>:</span>
<span id="cb163-762"><a href="#cb163-762"></a></span>
<span id="cb163-765"><a href="#cb163-765"></a><span class="in">```{r}</span></span>
<span id="cb163-766"><a href="#cb163-766"></a><span class="co"># run model</span></span>
<span id="cb163-767"><a href="#cb163-767"></a>y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> y_data)</span>
<span id="cb163-768"><a href="#cb163-768"></a></span>
<span id="cb163-769"><a href="#cb163-769"></a><span class="in">```</span></span>
<span id="cb163-770"><a href="#cb163-770"></a></span>
<span id="cb163-771"><a href="#cb163-771"></a>&nbsp;</span>
<span id="cb163-772"><a href="#cb163-772"></a></span>
<span id="cb163-773"><a href="#cb163-773"></a>Lo que equivale a:</span>
<span id="cb163-774"><a href="#cb163-774"></a></span>
<span id="cb163-775"><a href="#cb163-775"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-776"><a href="#cb163-776"></a></span>
<span id="cb163-777"><a href="#cb163-777"></a>&nbsp;</span>
<span id="cb163-778"><a href="#cb163-778"></a></span>
<span id="cb163-779"><a href="#cb163-779"></a>Podemos obtener el resumen por defecto de los resultados del modelo ejecutando <span class="in">`summary()`</span> en el objeto de salida 'y_mod':</span>
<span id="cb163-780"><a href="#cb163-780"></a></span>
<span id="cb163-783"><a href="#cb163-783"></a><span class="in">```{r}</span></span>
<span id="cb163-784"><a href="#cb163-784"></a><span class="fu">summary</span>(y_mod)</span>
<span id="cb163-785"><a href="#cb163-785"></a></span>
<span id="cb163-786"><a href="#cb163-786"></a><span class="in">```</span></span>
<span id="cb163-787"><a href="#cb163-787"></a></span>
<span id="cb163-788"><a href="#cb163-788"></a>&nbsp;</span>
<span id="cb163-789"><a href="#cb163-789"></a></span>
<span id="cb163-790"><a href="#cb163-790"></a>Puede ser bastante informativo graficar los tamaños de efecto (aunque en este caso sólo tenemos uno):</span>
<span id="cb163-791"><a href="#cb163-791"></a></span>
<span id="cb163-794"><a href="#cb163-794"></a><span class="in">```{r}</span></span>
<span id="cb163-795"><a href="#cb163-795"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(y_mod<span class="sc">$</span>coefficients), </span>
<span id="cb163-796"><a href="#cb163-796"></a>                    <span class="at">est =</span> y_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(y_mod))</span>
<span id="cb163-797"><a href="#cb163-797"></a></span>
<span id="cb163-798"><a href="#cb163-798"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb163-799"><a href="#cb163-799"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-800"><a href="#cb163-800"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb163-801"><a href="#cb163-801"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb163-802"><a href="#cb163-802"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb163-803"><a href="#cb163-803"></a></span>
<span id="cb163-804"><a href="#cb163-804"></a><span class="in">```</span></span>
<span id="cb163-805"><a href="#cb163-805"></a></span>
<span id="cb163-806"><a href="#cb163-806"></a>&nbsp;</span>
<span id="cb163-807"><a href="#cb163-807"></a></span>
<span id="cb163-808"><a href="#cb163-808"></a>::: {.alert .alert-success}</span>
<span id="cb163-809"><a href="#cb163-809"></a>&nbsp;</span>
<span id="cb163-810"><a href="#cb163-810"></a></span>
<span id="cb163-811"><a href="#cb163-811"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-812"><a href="#cb163-812"></a></span>
<span id="cb163-813"><a href="#cb163-813"></a>&nbsp;</span>
<span id="cb163-814"><a href="#cb163-814"></a></span>
<span id="cb163-815"><a href="#cb163-815"></a>Para evaluar la importancia de la asociación nos centramos en la tabla de coeficientes:</span>
<span id="cb163-816"><a href="#cb163-816"></a></span>
<span id="cb163-817"><a href="#cb163-817"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-818"><a href="#cb163-818"></a></span>
<span id="cb163-819"><a href="#cb163-819"></a>summ_y_mod <span class="ot">&lt;-</span> <span class="fu">summary</span>(y_mod)</span>
<span id="cb163-820"><a href="#cb163-820"></a></span>
<span id="cb163-821"><a href="#cb163-821"></a>summ_y_mod<span class="sc">$</span>coefficients</span>
<span id="cb163-822"><a href="#cb163-822"></a><span class="in">```</span></span>
<span id="cb163-823"><a href="#cb163-823"></a></span>
<span id="cb163-824"><a href="#cb163-824"></a><span class="ss">-   </span>En este ejemplo no hay predictores en el modelo, por lo que sólo tenemos una estimación para el intercepto ($\beta_0$)</span>
<span id="cb163-825"><a href="#cb163-825"></a></span>
<span id="cb163-826"><a href="#cb163-826"></a><span class="ss">-   </span>El modelo nos dice que el intercepto se estima en <span class="in">`r summ_y_mod$coefficients[1, 1]`</span> y que este valor no es significativamente diferente de 0 (valor p = <span class="in">`r summ_y_mod$coefficients[1, 4]`</span>)</span>
<span id="cb163-827"><a href="#cb163-827"></a></span>
<span id="cb163-828"><a href="#cb163-828"></a><span class="ss">-   </span>En este caso el intercepto es simplemente la media de la variable de respuesta</span>
<span id="cb163-829"><a href="#cb163-829"></a></span>
<span id="cb163-832"><a href="#cb163-832"></a><span class="in">```{r}</span></span>
<span id="cb163-833"><a href="#cb163-833"></a><span class="fu">mean</span>(y_data<span class="sc">$</span>y)</span>
<span id="cb163-834"><a href="#cb163-834"></a></span>
<span id="cb163-835"><a href="#cb163-835"></a><span class="in">```</span></span>
<span id="cb163-836"><a href="#cb163-836"></a></span>
<span id="cb163-837"><a href="#cb163-837"></a>&nbsp;</span>
<span id="cb163-838"><a href="#cb163-838"></a></span>
<span id="cb163-839"><a href="#cb163-839"></a><span class="ss">-   </span>Rara vez tenemos predicciones sobre el intercepto, por lo que tendemos a ignorar esta estimación.</span>
<span id="cb163-840"><a href="#cb163-840"></a>:::</span>
<span id="cb163-841"><a href="#cb163-841"></a></span>
<span id="cb163-842"><a href="#cb163-842"></a>&nbsp;</span>
<span id="cb163-843"><a href="#cb163-843"></a></span>
<span id="cb163-844"><a href="#cb163-844"></a>::: {.alert .alert-warning}</span>
<span id="cb163-845"><a href="#cb163-845"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-846"><a href="#cb163-846"></a></span>
<span id="cb163-847"><a href="#cb163-847"></a>&nbsp;</span>
<span id="cb163-848"><a href="#cb163-848"></a></span>
<span id="cb163-849"><a href="#cb163-849"></a><span class="ss">-   </span>Ruhs, E. C., Martin, L. B., &amp; Downs, C. J. (2020). <span class="co">[</span><span class="ot">**The impacts of body mass on immune cell concentrations in birds**</span><span class="co">](https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.0655?download=true)</span>. *Proceedings of the Royal Society B*, 287(1934), 20200655.</span>
<span id="cb163-850"><a href="#cb163-850"></a></span>
<span id="cb163-851"><a href="#cb163-851"></a>"*Encontramos que un modelo sólo con intercepto (intercept-only model) explicaba mejor las concentraciones de linfocitos y eosinófilos en las aves, indicando que las concentraciones de estos tipos de células eran independientes de la masa corporal.*"</span>
<span id="cb163-852"><a href="#cb163-852"></a></span>
<span id="cb163-853"><a href="#cb163-853"></a><span class="in">```{r, out.width = "85%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-854"><a href="#cb163-854"></a></span>
<span id="cb163-855"><a href="#cb163-855"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/leukocytes.png"</span>)</span>
<span id="cb163-856"><a href="#cb163-856"></a></span>
<span id="cb163-857"><a href="#cb163-857"></a><span class="in">```</span></span>
<span id="cb163-858"><a href="#cb163-858"></a></span>
<span id="cb163-859"><a href="#cb163-859"></a>&nbsp;</span>
<span id="cb163-860"><a href="#cb163-860"></a>:::</span>
<span id="cb163-861"><a href="#cb163-861"></a></span>
<span id="cb163-862"><a href="#cb163-862"></a>&nbsp;</span>
<span id="cb163-863"><a href="#cb163-863"></a></span>
<span id="cb163-864"><a href="#cb163-864"></a>::: {.alert .alert-info}</span>
<span id="cb163-865"><a href="#cb163-865"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 3<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-866"><a href="#cb163-866"></a></span>
<span id="cb163-867"><a href="#cb163-867"></a>&nbsp;</span>
<span id="cb163-868"><a href="#cb163-868"></a></span>
<span id="cb163-869"><a href="#cb163-869"></a><span class="ss">-   </span>Cambie el argumento 'mean' en la llamada de la función "rnorm()<span class="sc">\`</span> (<span class="co">[</span><span class="ot">línea 130</span><span class="co">](#cb53-8)</span>) por un valor distinto de 0 y observe cómo cambian los valores en la tabla de coeficientes</span>
<span id="cb163-870"><a href="#cb163-870"></a></span>
<span id="cb163-871"><a href="#cb163-871"></a><span class="ss">-   </span>Cambia el argumento <span class="in">`sd`</span> en la llamada a la función <span class="in">`rnorm()`</span> (<span class="co">[</span><span class="ot">línea 130</span><span class="co">](#cb53-8)</span>) por un valor más alto y observe cómo cambian los valores en la tabla de coeficientes</span>
<span id="cb163-872"><a href="#cb163-872"></a>:::</span>
<span id="cb163-873"><a href="#cb163-873"></a></span>
<span id="cb163-874"><a href="#cb163-874"></a>&nbsp;</span>
<span id="cb163-875"><a href="#cb163-875"></a></span>
<span id="cb163-876"><a href="#cb163-876"></a>------------------------------------------------------------------------</span>
<span id="cb163-877"><a href="#cb163-877"></a></span>
<span id="cb163-878"><a href="#cb163-878"></a><span class="fu">## Añadir un predictor no asociado</span></span>
<span id="cb163-879"><a href="#cb163-879"></a></span>
<span id="cb163-880"><a href="#cb163-880"></a>Podemos crear 2 variables numéricas no relacionadas así:</span>
<span id="cb163-881"><a href="#cb163-881"></a></span>
<span id="cb163-884"><a href="#cb163-884"></a><span class="in">```{r}</span></span>
<span id="cb163-885"><a href="#cb163-885"></a><span class="co"># definir semilla</span></span>
<span id="cb163-886"><a href="#cb163-886"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-887"><a href="#cb163-887"></a></span>
<span id="cb163-888"><a href="#cb163-888"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-889"><a href="#cb163-889"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-890"><a href="#cb163-890"></a></span>
<span id="cb163-891"><a href="#cb163-891"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-892"><a href="#cb163-892"></a>y <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-893"><a href="#cb163-893"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-894"><a href="#cb163-894"></a></span>
<span id="cb163-895"><a href="#cb163-895"></a><span class="co"># crear data frame</span></span>
<span id="cb163-896"><a href="#cb163-896"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb163-897"><a href="#cb163-897"></a></span>
<span id="cb163-898"><a href="#cb163-898"></a><span class="in">```</span></span>
<span id="cb163-899"><a href="#cb163-899"></a></span>
<span id="cb163-900"><a href="#cb163-900"></a>&nbsp;</span>
<span id="cb163-901"><a href="#cb163-901"></a></span>
<span id="cb163-902"><a href="#cb163-902"></a>Estas dos variables pueden introducirse en un modelo de regresión para evaluar la asociación entre ellas:</span>
<span id="cb163-903"><a href="#cb163-903"></a></span>
<span id="cb163-906"><a href="#cb163-906"></a><span class="in">```{r}</span></span>
<span id="cb163-907"><a href="#cb163-907"></a><span class="co"># construir model</span></span>
<span id="cb163-908"><a href="#cb163-908"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-909"><a href="#cb163-909"></a></span>
<span id="cb163-910"><a href="#cb163-910"></a><span class="co"># graficar</span></span>
<span id="cb163-911"><a href="#cb163-911"></a><span class="fu">ggplot</span>(xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-912"><a href="#cb163-912"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb163-913"><a href="#cb163-913"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span>
<span id="cb163-914"><a href="#cb163-914"></a></span>
<span id="cb163-915"><a href="#cb163-915"></a></span>
<span id="cb163-916"><a href="#cb163-916"></a><span class="in">```</span></span>
<span id="cb163-917"><a href="#cb163-917"></a></span>
<span id="cb163-918"><a href="#cb163-918"></a>&nbsp;</span>
<span id="cb163-919"><a href="#cb163-919"></a></span>
<span id="cb163-920"><a href="#cb163-920"></a>Que es equivalente a esto:</span>
<span id="cb163-921"><a href="#cb163-921"></a></span>
<span id="cb163-922"><a href="#cb163-922"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-923"><a href="#cb163-923"></a></span>
<span id="cb163-924"><a href="#cb163-924"></a>&nbsp;</span>
<span id="cb163-925"><a href="#cb163-925"></a></span>
<span id="cb163-926"><a href="#cb163-926"></a>Imprimamos el resumen de este modelo:</span>
<span id="cb163-927"><a href="#cb163-927"></a></span>
<span id="cb163-930"><a href="#cb163-930"></a><span class="in">```{r}</span></span>
<span id="cb163-931"><a href="#cb163-931"></a><span class="fu">summary</span>(xy_mod)</span>
<span id="cb163-932"><a href="#cb163-932"></a></span>
<span id="cb163-933"><a href="#cb163-933"></a><span class="in">```</span></span>
<span id="cb163-934"><a href="#cb163-934"></a></span>
<span id="cb163-935"><a href="#cb163-935"></a>&nbsp;</span>
<span id="cb163-936"><a href="#cb163-936"></a></span>
<span id="cb163-937"><a href="#cb163-937"></a>... y graficar los tamaños de efecto:</span>
<span id="cb163-938"><a href="#cb163-938"></a></span>
<span id="cb163-941"><a href="#cb163-941"></a><span class="in">```{r}</span></span>
<span id="cb163-942"><a href="#cb163-942"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod<span class="sc">$</span>coefficients), </span>
<span id="cb163-943"><a href="#cb163-943"></a>                    <span class="at">est =</span> xy_mod<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod))</span>
<span id="cb163-944"><a href="#cb163-944"></a></span>
<span id="cb163-945"><a href="#cb163-945"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb163-946"><a href="#cb163-946"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-947"><a href="#cb163-947"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb163-948"><a href="#cb163-948"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb163-949"><a href="#cb163-949"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb163-950"><a href="#cb163-950"></a></span>
<span id="cb163-951"><a href="#cb163-951"></a><span class="in">```</span></span>
<span id="cb163-952"><a href="#cb163-952"></a></span>
<span id="cb163-953"><a href="#cb163-953"></a>&nbsp;</span>
<span id="cb163-954"><a href="#cb163-954"></a></span>
<span id="cb163-955"><a href="#cb163-955"></a>Deberíamos "diagnosticar" la idoneidad del modelo inspeccionando más de cerca la distribución de los residuales. La función <span class="in">`plot_model()`</span> del paquete <span class="in">`sjPlot`</span> hace un buen trabajo para crear gráficos de diagnóstico para modelos lineales:</span>
<span id="cb163-956"><a href="#cb163-956"></a></span>
<span id="cb163-957"><a href="#cb163-957"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb163-958"><a href="#cb163-958"></a></span>
<span id="cb163-959"><a href="#cb163-959"></a><span class="fu">plot_model</span>(xy_mod, <span class="at">type =</span> <span class="st">"diag"</span>)</span>
<span id="cb163-960"><a href="#cb163-960"></a></span>
<span id="cb163-961"><a href="#cb163-961"></a><span class="in">```</span></span>
<span id="cb163-962"><a href="#cb163-962"></a></span>
<span id="cb163-963"><a href="#cb163-963"></a>&nbsp;</span>
<span id="cb163-964"><a href="#cb163-964"></a></span>
<span id="cb163-965"><a href="#cb163-965"></a>::: {.alert .alert-success}</span>
<span id="cb163-966"><a href="#cb163-966"></a>&nbsp;</span>
<span id="cb163-967"><a href="#cb163-967"></a></span>
<span id="cb163-968"><a href="#cb163-968"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-969"><a href="#cb163-969"></a></span>
<span id="cb163-970"><a href="#cb163-970"></a>&nbsp;</span>
<span id="cb163-971"><a href="#cb163-971"></a></span>
<span id="cb163-972"><a href="#cb163-972"></a>Cuadro con coeficientes:</span>
<span id="cb163-973"><a href="#cb163-973"></a></span>
<span id="cb163-974"><a href="#cb163-974"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-975"><a href="#cb163-975"></a></span>
<span id="cb163-976"><a href="#cb163-976"></a>summ_xy_mod <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod)</span>
<span id="cb163-977"><a href="#cb163-977"></a></span>
<span id="cb163-978"><a href="#cb163-978"></a>summ_xy_mod<span class="sc">$</span>coefficients</span>
<span id="cb163-979"><a href="#cb163-979"></a><span class="in">```</span></span>
<span id="cb163-980"><a href="#cb163-980"></a></span>
<span id="cb163-981"><a href="#cb163-981"></a>&nbsp;</span>
<span id="cb163-982"><a href="#cb163-982"></a></span>
<span id="cb163-983"><a href="#cb163-983"></a><span class="ss">-   </span>En este ejemplo hemos añadido un predictor al modelo, por lo que hemos obtenido una estimado adicional (y una fila extra, 'x1')</span>
<span id="cb163-984"><a href="#cb163-984"></a></span>
<span id="cb163-985"><a href="#cb163-985"></a><span class="ss">-   </span>El modelo nos dice que la estimación de 'x1' es <span class="in">`r summ_xy_mod$coefficients[2, 1]`</span> y que no es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod$coefficients[2, 4]`</span>)</span>
<span id="cb163-986"><a href="#cb163-986"></a>:::</span>
<span id="cb163-987"><a href="#cb163-987"></a></span>
<span id="cb163-988"><a href="#cb163-988"></a>------------------------------------------------------------------------</span>
<span id="cb163-989"><a href="#cb163-989"></a></span>
<span id="cb163-990"><a href="#cb163-990"></a>&nbsp;</span>
<span id="cb163-991"><a href="#cb163-991"></a></span>
<span id="cb163-992"><a href="#cb163-992"></a><span class="fu">## Simular un predictor asociado {#simular-un-predictor-asociado}</span></span>
<span id="cb163-993"><a href="#cb163-993"></a></span>
<span id="cb163-994"><a href="#cb163-994"></a>Podemos utilizar la fórmula del modelo lineal anterior para simular dos variables continuas asociadas así:</span>
<span id="cb163-995"><a href="#cb163-995"></a></span>
<span id="cb163-998"><a href="#cb163-998"></a><span class="in">```{r}</span></span>
<span id="cb163-999"><a href="#cb163-999"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1000"><a href="#cb163-1000"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1001"><a href="#cb163-1001"></a></span>
<span id="cb163-1002"><a href="#cb163-1002"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1003"><a href="#cb163-1003"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1004"><a href="#cb163-1004"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1005"><a href="#cb163-1005"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1006"><a href="#cb163-1006"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-1007"><a href="#cb163-1007"></a></span>
<span id="cb163-1008"><a href="#cb163-1008"></a><span class="co"># variables aleatorias</span></span>
<span id="cb163-1009"><a href="#cb163-1009"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1010"><a href="#cb163-1010"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb163-1011"><a href="#cb163-1011"></a></span>
<span id="cb163-1012"><a href="#cb163-1012"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1013"><a href="#cb163-1013"></a>xy_datos2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb163-1014"><a href="#cb163-1014"></a></span>
<span id="cb163-1015"><a href="#cb163-1015"></a><span class="in">```</span></span>
<span id="cb163-1016"><a href="#cb163-1016"></a></span>
<span id="cb163-1017"><a href="#cb163-1017"></a>&nbsp;</span>
<span id="cb163-1018"><a href="#cb163-1018"></a></span>
<span id="cb163-1019"><a href="#cb163-1019"></a>Note que **también hemos añadido un término de error**, por lo que la asociación no es perfecta. Vamos a correr el modelo y graficar la asociación entre las dos variables:</span>
<span id="cb163-1020"><a href="#cb163-1020"></a></span>
<span id="cb163-1023"><a href="#cb163-1023"></a><span class="in">```{r}</span></span>
<span id="cb163-1024"><a href="#cb163-1024"></a><span class="co"># construir model</span></span>
<span id="cb163-1025"><a href="#cb163-1025"></a>xy_mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos2)</span>
<span id="cb163-1026"><a href="#cb163-1026"></a></span>
<span id="cb163-1027"><a href="#cb163-1027"></a><span class="co"># graficar</span></span>
<span id="cb163-1028"><a href="#cb163-1028"></a><span class="fu">ggplot</span>(xy_datos2, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-1029"><a href="#cb163-1029"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb163-1030"><a href="#cb163-1030"></a>  <span class="fu">geom_point</span>() <span class="co"># graficar points</span></span>
<span id="cb163-1031"><a href="#cb163-1031"></a></span>
<span id="cb163-1032"><a href="#cb163-1032"></a><span class="in">```</span></span>
<span id="cb163-1033"><a href="#cb163-1033"></a></span>
<span id="cb163-1034"><a href="#cb163-1034"></a>&nbsp;</span>
<span id="cb163-1035"><a href="#cb163-1035"></a></span>
<span id="cb163-1036"><a href="#cb163-1036"></a>La fórmula es la misma que la del modelo anterior:</span>
<span id="cb163-1037"><a href="#cb163-1037"></a></span>
<span id="cb163-1038"><a href="#cb163-1038"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1039"><a href="#cb163-1039"></a></span>
<span id="cb163-1040"><a href="#cb163-1040"></a>&nbsp;</span>
<span id="cb163-1041"><a href="#cb163-1041"></a></span>
<span id="cb163-1042"><a href="#cb163-1042"></a>Este es el resumen del modelo:</span>
<span id="cb163-1043"><a href="#cb163-1043"></a></span>
<span id="cb163-1046"><a href="#cb163-1046"></a><span class="in">```{r}</span></span>
<span id="cb163-1047"><a href="#cb163-1047"></a><span class="fu">summary</span>(xy_mod2)</span>
<span id="cb163-1048"><a href="#cb163-1048"></a></span>
<span id="cb163-1049"><a href="#cb163-1049"></a><span class="in">```</span></span>
<span id="cb163-1050"><a href="#cb163-1050"></a></span>
<span id="cb163-1051"><a href="#cb163-1051"></a>&nbsp;</span>
<span id="cb163-1052"><a href="#cb163-1052"></a></span>
<span id="cb163-1053"><a href="#cb163-1053"></a>.. el gráfico con los tamaños de efecto:</span>
<span id="cb163-1054"><a href="#cb163-1054"></a></span>
<span id="cb163-1057"><a href="#cb163-1057"></a><span class="in">```{r}</span></span>
<span id="cb163-1058"><a href="#cb163-1058"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod2<span class="sc">$</span>coefficients), </span>
<span id="cb163-1059"><a href="#cb163-1059"></a>                    <span class="at">est =</span> xy_mod2<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod2))</span>
<span id="cb163-1060"><a href="#cb163-1060"></a></span>
<span id="cb163-1061"><a href="#cb163-1061"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb163-1062"><a href="#cb163-1062"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-1063"><a href="#cb163-1063"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb163-1064"><a href="#cb163-1064"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb163-1065"><a href="#cb163-1065"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb163-1066"><a href="#cb163-1066"></a></span>
<span id="cb163-1067"><a href="#cb163-1067"></a><span class="in">```</span></span>
<span id="cb163-1068"><a href="#cb163-1068"></a></span>
<span id="cb163-1069"><a href="#cb163-1069"></a>&nbsp;</span>
<span id="cb163-1070"><a href="#cb163-1070"></a></span>
<span id="cb163-1071"><a href="#cb163-1071"></a>... y los gráficos diagnósticos del modelo:</span>
<span id="cb163-1072"><a href="#cb163-1072"></a></span>
<span id="cb163-1073"><a href="#cb163-1073"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb163-1074"><a href="#cb163-1074"></a></span>
<span id="cb163-1075"><a href="#cb163-1075"></a><span class="fu">plot_model</span>(xy_mod2, <span class="at">type =</span> <span class="st">"diag"</span>)</span>
<span id="cb163-1076"><a href="#cb163-1076"></a></span>
<span id="cb163-1077"><a href="#cb163-1077"></a><span class="in">```</span></span>
<span id="cb163-1078"><a href="#cb163-1078"></a></span>
<span id="cb163-1079"><a href="#cb163-1079"></a>&nbsp;</span>
<span id="cb163-1080"><a href="#cb163-1080"></a></span>
<span id="cb163-1081"><a href="#cb163-1081"></a>::: {.alert .alert-success}</span>
<span id="cb163-1082"><a href="#cb163-1082"></a>&nbsp;</span>
<span id="cb163-1083"><a href="#cb163-1083"></a></span>
<span id="cb163-1084"><a href="#cb163-1084"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1085"><a href="#cb163-1085"></a></span>
<span id="cb163-1086"><a href="#cb163-1086"></a>&nbsp;</span>
<span id="cb163-1087"><a href="#cb163-1087"></a></span>
<span id="cb163-1088"><a href="#cb163-1088"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb163-1089"><a href="#cb163-1089"></a></span>
<span id="cb163-1090"><a href="#cb163-1090"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-1091"><a href="#cb163-1091"></a><span class="co"># resumen</span></span>
<span id="cb163-1092"><a href="#cb163-1092"></a>summ_xy_mod2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod2)</span>
<span id="cb163-1093"><a href="#cb163-1093"></a></span>
<span id="cb163-1094"><a href="#cb163-1094"></a>summ_xy_mod2<span class="sc">$</span>coefficients</span>
<span id="cb163-1095"><a href="#cb163-1095"></a><span class="in">```</span></span>
<span id="cb163-1096"><a href="#cb163-1096"></a></span>
<span id="cb163-1097"><a href="#cb163-1097"></a><span class="ss">-   </span>El modelo nos dice que $beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_xy_mod2$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod2$coefficients[2, 4]`</span>)</span>
<span id="cb163-1098"><a href="#cb163-1098"></a></span>
<span id="cb163-1099"><a href="#cb163-1099"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb163-1100"><a href="#cb163-1100"></a></span>
<span id="cb163-1101"><a href="#cb163-1101"></a><span class="ss">    -   </span>$\beta_1$ (the effect size of 'x1') was set to <span class="in">`r b1`</span> and was estimated as <span class="in">`r round(summ_xy_mod2$coefficients[2, 1], 3)`</span> by the model</span>
<span id="cb163-1102"><a href="#cb163-1102"></a>:::</span>
<span id="cb163-1103"><a href="#cb163-1103"></a></span>
<span id="cb163-1104"><a href="#cb163-1104"></a>&nbsp;</span>
<span id="cb163-1105"><a href="#cb163-1105"></a></span>
<span id="cb163-1106"><a href="#cb163-1106"></a>::: {.alert .alert-warning}</span>
<span id="cb163-1107"><a href="#cb163-1107"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1108"><a href="#cb163-1108"></a></span>
<span id="cb163-1109"><a href="#cb163-1109"></a>&nbsp;</span>
<span id="cb163-1110"><a href="#cb163-1110"></a></span>
<span id="cb163-1111"><a href="#cb163-1111"></a><span class="ss">-   </span>Keenan EL, Odom KJ, Araya-Salas M, Horton KG, Strimas-Mackey M, Meatte MA, Mann NI, Slater PJ, Price JJ, and Templeton CN. 2020. <span class="co">[</span><span class="ot">**Breeding season length predicts duet coordination and consistency in Neotropical wrens (Troglodytidae)**</span><span class="co">](https://royalsocietypublishing.org/doi/pdf/10.1098/rspb.2020.2482)</span>. *Proceeding of the Royal Society B*. 20202482</span>
<span id="cb163-1112"><a href="#cb163-1112"></a></span>
<span id="cb163-1113"><a href="#cb163-1113"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-1114"><a href="#cb163-1114"></a></span>
<span id="cb163-1115"><a href="#cb163-1115"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/duets.png"</span>)</span>
<span id="cb163-1116"><a href="#cb163-1116"></a></span>
<span id="cb163-1117"><a href="#cb163-1117"></a><span class="in">```</span></span>
<span id="cb163-1118"><a href="#cb163-1118"></a></span>
<span id="cb163-1119"><a href="#cb163-1119"></a>&nbsp;</span>
<span id="cb163-1120"><a href="#cb163-1120"></a></span>
<span id="cb163-1121"><a href="#cb163-1121"></a>"*... la coordinación y la consistencia de los duetos son mayores en las especies con temporadas de apareamiento especialmente largas.*"</span>
<span id="cb163-1122"><a href="#cb163-1122"></a></span>
<span id="cb163-1123"><a href="#cb163-1123"></a><span class="in">```{r, out.width = "70%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-1124"><a href="#cb163-1124"></a></span>
<span id="cb163-1125"><a href="#cb163-1125"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/duet_reg.png"</span>)</span>
<span id="cb163-1126"><a href="#cb163-1126"></a></span>
<span id="cb163-1127"><a href="#cb163-1127"></a><span class="in">```</span></span>
<span id="cb163-1128"><a href="#cb163-1128"></a></span>
<span id="cb163-1129"><a href="#cb163-1129"></a>&nbsp;</span>
<span id="cb163-1130"><a href="#cb163-1130"></a>:::</span>
<span id="cb163-1131"><a href="#cb163-1131"></a></span>
<span id="cb163-1132"><a href="#cb163-1132"></a>&nbsp;</span>
<span id="cb163-1133"><a href="#cb163-1133"></a></span>
<span id="cb163-1134"><a href="#cb163-1134"></a>::: {.alert .alert-info}</span>
<span id="cb163-1135"><a href="#cb163-1135"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 4<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-1136"><a href="#cb163-1136"></a></span>
<span id="cb163-1137"><a href="#cb163-1137"></a>&nbsp;</span>
<span id="cb163-1138"><a href="#cb163-1138"></a></span>
<span id="cb163-1139"><a href="#cb163-1139"></a><span class="ss">-   </span>Aumente el tamaño de la muestra (<span class="in">`n`</span>) a 1000 o más</span>
<span id="cb163-1140"><a href="#cb163-1140"></a></span>
<span id="cb163-1141"><a href="#cb163-1141"></a><span class="ss">-   </span>¿Cómo cambiaron los estimados del tamaño de efecto ($\beta$)?</span>
<span id="cb163-1142"><a href="#cb163-1142"></a></span>
<span id="cb163-1143"><a href="#cb163-1143"></a><span class="ss">-   </span>¿Cómo cambió el error estándar del tamaño de efecto?</span>
<span id="cb163-1144"><a href="#cb163-1144"></a></span>
<span id="cb163-1145"><a href="#cb163-1145"></a><span class="ss">-   </span>Ahora cambie <span class="in">`n`</span> a 15 y compruebe de nuevo las estimaciones del modelo (esta vez compruebe también el valor p)</span>
<span id="cb163-1146"><a href="#cb163-1146"></a>:::</span>
<span id="cb163-1147"><a href="#cb163-1147"></a></span>
<span id="cb163-1148"><a href="#cb163-1148"></a>&nbsp;</span>
<span id="cb163-1149"><a href="#cb163-1149"></a></span>
<span id="cb163-1150"><a href="#cb163-1150"></a>------------------------------------------------------------------------</span>
<span id="cb163-1151"><a href="#cb163-1151"></a></span>
<span id="cb163-1152"><a href="#cb163-1152"></a><span class="fu">## Varios predictores: regresión múltiple</span></span>
<span id="cb163-1153"><a href="#cb163-1153"></a></span>
<span id="cb163-1154"><a href="#cb163-1154"></a>La regresión lineal múltiple es una extensión del modelo de regresión lineal simple que puede tomar varios predictores:</span>
<span id="cb163-1155"><a href="#cb163-1155"></a></span>
<span id="cb163-1156"><a href="#cb163-1156"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1157"><a href="#cb163-1157"></a></span>
<span id="cb163-1158"><a href="#cb163-1158"></a>&nbsp;</span>
<span id="cb163-1159"><a href="#cb163-1159"></a></span>
<span id="cb163-1160"><a href="#cb163-1160"></a>La fórmula parece compleja, pero sólo quiere decir que cualquier parámetro adicional tendrá su propia estimación ($\beta$). La fórmula para una regresión lineal de dos predictores se ve así:</span>
<span id="cb163-1161"><a href="#cb163-1161"></a></span>
<span id="cb163-1162"><a href="#cb163-1162"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1163"><a href="#cb163-1163"></a></span>
<span id="cb163-1164"><a href="#cb163-1164"></a>&nbsp;</span>
<span id="cb163-1165"><a href="#cb163-1165"></a></span>
<span id="cb163-1166"><a href="#cb163-1166"></a>... y se puede simular así:</span>
<span id="cb163-1167"><a href="#cb163-1167"></a></span>
<span id="cb163-1170"><a href="#cb163-1170"></a><span class="in">```{r}</span></span>
<span id="cb163-1171"><a href="#cb163-1171"></a><span class="co"># semila</span></span>
<span id="cb163-1172"><a href="#cb163-1172"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1173"><a href="#cb163-1173"></a></span>
<span id="cb163-1174"><a href="#cb163-1174"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1175"><a href="#cb163-1175"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1176"><a href="#cb163-1176"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1177"><a href="#cb163-1177"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1178"><a href="#cb163-1178"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb163-1179"><a href="#cb163-1179"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-1180"><a href="#cb163-1180"></a></span>
<span id="cb163-1181"><a href="#cb163-1181"></a><span class="co"># variables aleatorias</span></span>
<span id="cb163-1182"><a href="#cb163-1182"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1183"><a href="#cb163-1183"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1184"><a href="#cb163-1184"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb163-1185"><a href="#cb163-1185"></a></span>
<span id="cb163-1186"><a href="#cb163-1186"></a><span class="co"># crear un data frame</span></span>
<span id="cb163-1187"><a href="#cb163-1187"></a>xy_datos_multp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb163-1188"><a href="#cb163-1188"></a></span>
<span id="cb163-1189"><a href="#cb163-1189"></a><span class="co"># construir el modelo</span></span>
<span id="cb163-1190"><a href="#cb163-1190"></a>xy_mod_multp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_multp)</span>
<span id="cb163-1191"><a href="#cb163-1191"></a></span>
<span id="cb163-1192"><a href="#cb163-1192"></a><span class="fu">summary</span>(xy_mod_multp)</span>
<span id="cb163-1193"><a href="#cb163-1193"></a></span>
<span id="cb163-1194"><a href="#cb163-1194"></a><span class="in">```</span></span>
<span id="cb163-1195"><a href="#cb163-1195"></a></span>
<span id="cb163-1196"><a href="#cb163-1196"></a>&nbsp;</span>
<span id="cb163-1197"><a href="#cb163-1197"></a></span>
<span id="cb163-1198"><a href="#cb163-1198"></a>... graficar los tamaños de efecto:</span>
<span id="cb163-1199"><a href="#cb163-1199"></a></span>
<span id="cb163-1202"><a href="#cb163-1202"></a><span class="in">```{r}</span></span>
<span id="cb163-1203"><a href="#cb163-1203"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_multp<span class="sc">$</span>coefficients), </span>
<span id="cb163-1204"><a href="#cb163-1204"></a>                    <span class="at">est =</span> xy_mod_multp<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_multp))</span>
<span id="cb163-1205"><a href="#cb163-1205"></a></span>
<span id="cb163-1206"><a href="#cb163-1206"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb163-1207"><a href="#cb163-1207"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-1208"><a href="#cb163-1208"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb163-1209"><a href="#cb163-1209"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb163-1210"><a href="#cb163-1210"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb163-1211"><a href="#cb163-1211"></a></span>
<span id="cb163-1212"><a href="#cb163-1212"></a><span class="in">```</span></span>
<span id="cb163-1213"><a href="#cb163-1213"></a></span>
<span id="cb163-1214"><a href="#cb163-1214"></a>&nbsp;</span>
<span id="cb163-1215"><a href="#cb163-1215"></a></span>
<span id="cb163-1216"><a href="#cb163-1216"></a>... y los gráficos diagnósticos:</span>
<span id="cb163-1217"><a href="#cb163-1217"></a></span>
<span id="cb163-1218"><a href="#cb163-1218"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb163-1219"><a href="#cb163-1219"></a></span>
<span id="cb163-1220"><a href="#cb163-1220"></a><span class="fu">plot_model</span>(xy_mod_multp, <span class="at">type =</span> <span class="st">"diag"</span>)</span>
<span id="cb163-1221"><a href="#cb163-1221"></a></span>
<span id="cb163-1222"><a href="#cb163-1222"></a><span class="in">```</span></span>
<span id="cb163-1223"><a href="#cb163-1223"></a></span>
<span id="cb163-1224"><a href="#cb163-1224"></a>&nbsp;</span>
<span id="cb163-1225"><a href="#cb163-1225"></a></span>
<span id="cb163-1226"><a href="#cb163-1226"></a>::: {.alert .alert-success}</span>
<span id="cb163-1227"><a href="#cb163-1227"></a>&nbsp;</span>
<span id="cb163-1228"><a href="#cb163-1228"></a></span>
<span id="cb163-1229"><a href="#cb163-1229"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1230"><a href="#cb163-1230"></a></span>
<span id="cb163-1231"><a href="#cb163-1231"></a>&nbsp;</span>
<span id="cb163-1232"><a href="#cb163-1232"></a></span>
<span id="cb163-1233"><a href="#cb163-1233"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb163-1234"><a href="#cb163-1234"></a></span>
<span id="cb163-1235"><a href="#cb163-1235"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-1236"><a href="#cb163-1236"></a></span>
<span id="cb163-1237"><a href="#cb163-1237"></a>summ_xy_mod_multp <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod_multp)</span>
<span id="cb163-1238"><a href="#cb163-1238"></a></span>
<span id="cb163-1239"><a href="#cb163-1239"></a>summ_xy_mod_multp<span class="sc">$</span>coefficients</span>
<span id="cb163-1240"><a href="#cb163-1240"></a><span class="in">```</span></span>
<span id="cb163-1241"><a href="#cb163-1241"></a></span>
<span id="cb163-1242"><a href="#cb163-1242"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_xy_mod_multp$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod_multp$coefficients[2, 4]`</span>). Este es el efecto de 'x1' sobre 'y' una vez removida la variación explicada por 'x2'.</span>
<span id="cb163-1243"><a href="#cb163-1243"></a></span>
<span id="cb163-1244"><a href="#cb163-1244"></a><span class="ss">-   </span>También se encontró que el $\beta_2$ (el tamaño de efecto de 'x2') es <span class="in">`r summ_xy_mod_multp$coefficients[3, 1]`</span> y que también es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod_multp$coefficients[3, 4]`</span>). Este es el efecto de 'x2' sobre 'y' una vez removida la variación explicada por 'x1'.</span>
<span id="cb163-1245"><a href="#cb163-1245"></a></span>
<span id="cb163-1246"><a href="#cb163-1246"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb163-1247"><a href="#cb163-1247"></a></span>
<span id="cb163-1248"><a href="#cb163-1248"></a><span class="ss">    -   </span>$\beta_1$ se fijó en <span class="in">`r b1`</span> y se estimó como <span class="in">`r round(summ_xy_mod_multp$coefficients[2, 1], 3)`</span>.</span>
<span id="cb163-1249"><a href="#cb163-1249"></a></span>
<span id="cb163-1250"><a href="#cb163-1250"></a><span class="ss">    -   </span>$\beta_2$ (el tamaño de efecto de 'x2') se fijó en <span class="in">`r b2`</span> y se estimó como <span class="in">`r round(summ_xy_mod_multp$coefficients[3, 1], 3)`</span>.</span>
<span id="cb163-1251"><a href="#cb163-1251"></a>:::</span>
<span id="cb163-1252"><a href="#cb163-1252"></a></span>
<span id="cb163-1253"><a href="#cb163-1253"></a>&nbsp;</span>
<span id="cb163-1254"><a href="#cb163-1254"></a></span>
<span id="cb163-1255"><a href="#cb163-1255"></a>::: {.alert .alert-warning}</span>
<span id="cb163-1256"><a href="#cb163-1256"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1257"><a href="#cb163-1257"></a></span>
<span id="cb163-1258"><a href="#cb163-1258"></a>&nbsp;</span>
<span id="cb163-1259"><a href="#cb163-1259"></a></span>
<span id="cb163-1260"><a href="#cb163-1260"></a><span class="ss">-   </span>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <span class="co">[</span><span class="ot">**Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird**</span><span class="co">](https://www.nature.com/articles/s41598-018-20441-x)</span>. *Scientific Reports*. 13, e0189969</span>
<span id="cb163-1261"><a href="#cb163-1261"></a></span>
<span id="cb163-1262"><a href="#cb163-1262"></a>"*La memoria espacial, el tamaño corporal y el largo de la punta del pico ... predijeron positivamente la probabilidad de adquirir y defender un territorio.*"</span>
<span id="cb163-1263"><a href="#cb163-1263"></a></span>
<span id="cb163-1264"><a href="#cb163-1264"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-1265"><a href="#cb163-1265"></a></span>
<span id="cb163-1266"><a href="#cb163-1266"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/lbh_cognition.png"</span>)</span>
<span id="cb163-1267"><a href="#cb163-1267"></a></span>
<span id="cb163-1268"><a href="#cb163-1268"></a><span class="in">```</span></span>
<span id="cb163-1269"><a href="#cb163-1269"></a></span>
<span id="cb163-1270"><a href="#cb163-1270"></a>&nbsp;</span>
<span id="cb163-1271"><a href="#cb163-1271"></a>:::</span>
<span id="cb163-1272"><a href="#cb163-1272"></a></span>
<span id="cb163-1273"><a href="#cb163-1273"></a>&nbsp;</span>
<span id="cb163-1274"><a href="#cb163-1274"></a></span>
<span id="cb163-1275"><a href="#cb163-1275"></a>Hay un punto importante que es necesario enfatizar aquí: **la regresión múltiple estima el efecto de un predictor después de tener en cuenta el efecto de los demás predictores del modelo**. En otras palabras, los nuevos predictores del modelo tratarán de explicar la variación de los datos que no fue explicada por los otros predictores. Así que **el resultado de la regresión múltiple no es equivalente a los resultados de las regresiones lineales simples** sobre los mismos predictores. Esto puede demostrarse fácilmente corriendo esas regresiones:</span>
<span id="cb163-1276"><a href="#cb163-1276"></a></span>
<span id="cb163-1279"><a href="#cb163-1279"></a><span class="in">```{r}</span></span>
<span id="cb163-1280"><a href="#cb163-1280"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1281"><a href="#cb163-1281"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1282"><a href="#cb163-1282"></a>x2y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1283"><a href="#cb163-1283"></a></span>
<span id="cb163-1284"><a href="#cb163-1284"></a><span class="co"># atajo a los coeficientes</span></span>
<span id="cb163-1285"><a href="#cb163-1285"></a><span class="fu">coef</span>(xy_mod)</span>
<span id="cb163-1286"><a href="#cb163-1286"></a><span class="fu">coef</span>(x1y_mod)</span>
<span id="cb163-1287"><a href="#cb163-1287"></a><span class="fu">coef</span>(x2y_mod)</span>
<span id="cb163-1288"><a href="#cb163-1288"></a></span>
<span id="cb163-1289"><a href="#cb163-1289"></a><span class="in">```</span></span>
<span id="cb163-1290"><a href="#cb163-1290"></a></span>
<span id="cb163-1291"><a href="#cb163-1291"></a>&nbsp;</span>
<span id="cb163-1292"><a href="#cb163-1292"></a></span>
<span id="cb163-1293"><a href="#cb163-1293"></a>Las estimaciones de las mismas variables varían considerablemente entre la regresión múltiple y las regresiones de un solo predictor.</span>
<span id="cb163-1294"><a href="#cb163-1294"></a></span>
<span id="cb163-1295"><a href="#cb163-1295"></a>Este punto se demuestra además por el hecho de que, si uno de los predictores no tiene ninguna influencia en la respuesta, el efecto del predictor adicional convergerá a su efecto en una regresión lineal simple. Para simular este escenario, fijamos b2 en 0:</span>
<span id="cb163-1296"><a href="#cb163-1296"></a></span>
<span id="cb163-1299"><a href="#cb163-1299"></a><span class="in">```{r}</span></span>
<span id="cb163-1300"><a href="#cb163-1300"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1301"><a href="#cb163-1301"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1302"><a href="#cb163-1302"></a></span>
<span id="cb163-1303"><a href="#cb163-1303"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1304"><a href="#cb163-1304"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1305"><a href="#cb163-1305"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1306"><a href="#cb163-1306"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1307"><a href="#cb163-1307"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb163-1308"><a href="#cb163-1308"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1309"><a href="#cb163-1309"></a></span>
<span id="cb163-1310"><a href="#cb163-1310"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1311"><a href="#cb163-1311"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1312"><a href="#cb163-1312"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1313"><a href="#cb163-1313"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb163-1314"><a href="#cb163-1314"></a></span>
<span id="cb163-1315"><a href="#cb163-1315"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1316"><a href="#cb163-1316"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb163-1317"><a href="#cb163-1317"></a></span>
<span id="cb163-1318"><a href="#cb163-1318"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1319"><a href="#cb163-1319"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1320"><a href="#cb163-1320"></a>x1y_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1321"><a href="#cb163-1321"></a></span>
<span id="cb163-1322"><a href="#cb163-1322"></a><span class="co"># shortcut to coefficients</span></span>
<span id="cb163-1323"><a href="#cb163-1323"></a><span class="fu">coef</span>(xy_mod)</span>
<span id="cb163-1324"><a href="#cb163-1324"></a><span class="fu">coef</span>(x1y_mod)</span>
<span id="cb163-1325"><a href="#cb163-1325"></a><span class="in">```</span></span>
<span id="cb163-1326"><a href="#cb163-1326"></a></span>
<span id="cb163-1327"><a href="#cb163-1327"></a>El estimado de $\beta_1$ fue casi el mismo en la regresión múltiple (<span class="in">`r coef(xy_mod)[2]`</span>) y en la regresión de un solo predictor (<span class="in">`r coef(x1y_mod)[2]`</span>)</span>
<span id="cb163-1328"><a href="#cb163-1328"></a></span>
<span id="cb163-1329"><a href="#cb163-1329"></a>Por comodidad, hemos utilizado <span class="in">`coef()`</span> para extraer sólo los estimado de la regresión, pero los valores son los mismos que obtenemos con <span class="in">`summary(model)`</span>.</span>
<span id="cb163-1330"><a href="#cb163-1330"></a></span>
<span id="cb163-1331"><a href="#cb163-1331"></a>&nbsp;</span>
<span id="cb163-1332"><a href="#cb163-1332"></a></span>
<span id="cb163-1333"><a href="#cb163-1333"></a>::: {.alert .alert-info}</span>
<span id="cb163-1334"><a href="#cb163-1334"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 5<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-1335"><a href="#cb163-1335"></a></span>
<span id="cb163-1336"><a href="#cb163-1336"></a>&nbsp;</span>
<span id="cb163-1337"><a href="#cb163-1337"></a></span>
<span id="cb163-1338"><a href="#cb163-1338"></a>La siguiente simulación genera un par de predictores continuos altamente colineales:</span>
<span id="cb163-1339"><a href="#cb163-1339"></a></span>
<span id="cb163-1342"><a href="#cb163-1342"></a><span class="in">```{r}</span></span>
<span id="cb163-1343"><a href="#cb163-1343"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1344"><a href="#cb163-1344"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1345"><a href="#cb163-1345"></a></span>
<span id="cb163-1346"><a href="#cb163-1346"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1347"><a href="#cb163-1347"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb163-1348"><a href="#cb163-1348"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1349"><a href="#cb163-1349"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1350"><a href="#cb163-1350"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb163-1351"><a href="#cb163-1351"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1352"><a href="#cb163-1352"></a></span>
<span id="cb163-1353"><a href="#cb163-1353"></a><span class="co">#  variables aleatorias colineales</span></span>
<span id="cb163-1354"><a href="#cb163-1354"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1355"><a href="#cb163-1355"></a>x2 <span class="ot">&lt;-</span>  x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>) <span class="co"># hacer x2 colineal con x1</span></span>
<span id="cb163-1356"><a href="#cb163-1356"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb163-1357"><a href="#cb163-1357"></a></span>
<span id="cb163-1358"><a href="#cb163-1358"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1359"><a href="#cb163-1359"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb163-1360"><a href="#cb163-1360"></a></span>
<span id="cb163-1361"><a href="#cb163-1361"></a><span class="fu">cor</span>(x1, x2)</span>
<span id="cb163-1362"><a href="#cb163-1362"></a><span class="in">```</span></span>
<span id="cb163-1363"><a href="#cb163-1363"></a></span>
<span id="cb163-1364"><a href="#cb163-1364"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb163-1365"><a href="#cb163-1365"></a><span class="co"># graficar</span></span>
<span id="cb163-1366"><a href="#cb163-1366"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2)) <span class="sc">+</span></span>
<span id="cb163-1367"><a href="#cb163-1367"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb163-1368"><a href="#cb163-1368"></a></span>
<span id="cb163-1369"><a href="#cb163-1369"></a><span class="in">```</span></span>
<span id="cb163-1370"><a href="#cb163-1370"></a></span>
<span id="cb163-1371"><a href="#cb163-1371"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb163-1372"><a href="#cb163-1372"></a><span class="co"># graficar</span></span>
<span id="cb163-1373"><a href="#cb163-1373"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2)) <span class="sc">+</span></span>
<span id="cb163-1374"><a href="#cb163-1374"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb163-1375"><a href="#cb163-1375"></a><span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#d9edf7"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#d9edf7"</span>, <span class="at">colour=</span><span class="cn">NA</span>))</span>
<span id="cb163-1376"><a href="#cb163-1376"></a></span>
<span id="cb163-1377"><a href="#cb163-1377"></a><span class="in">```</span></span>
<span id="cb163-1378"><a href="#cb163-1378"></a></span>
<span id="cb163-1379"><a href="#cb163-1379"></a><span class="ss">-   </span>Construya un modelo lineal multiple (con <span class="in">`lm()`</span>) con 'y' como respuesta y 'x1' y 'x2' como predictores</span>
<span id="cb163-1380"><a href="#cb163-1380"></a></span>
<span id="cb163-1381"><a href="#cb163-1381"></a><span class="ss">-   </span>Compare los betas estimados por el modelo con los usados para generar los datos. ¿Es una buena estimación?. También observe los valores de p. ¿Esperaría que fueran significativos?</span>
<span id="cb163-1382"><a href="#cb163-1382"></a>:::</span>
<span id="cb163-1383"><a href="#cb163-1383"></a></span>
<span id="cb163-1384"><a href="#cb163-1384"></a>&nbsp;</span>
<span id="cb163-1385"><a href="#cb163-1385"></a></span>
<span id="cb163-1386"><a href="#cb163-1386"></a>------------------------------------------------------------------------</span>
<span id="cb163-1387"><a href="#cb163-1387"></a></span>
<span id="cb163-1388"><a href="#cb163-1388"></a><span class="fu">## Añadir un predictor categórico</span></span>
<span id="cb163-1389"><a href="#cb163-1389"></a></span>
<span id="cb163-1390"><a href="#cb163-1390"></a>Para los predictores categóricos podemos crear primero una variable binaria (0, 1) y luego añadir etiquetas a cada valor:</span>
<span id="cb163-1391"><a href="#cb163-1391"></a></span>
<span id="cb163-1394"><a href="#cb163-1394"></a><span class="in">```{r}</span></span>
<span id="cb163-1395"><a href="#cb163-1395"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1396"><a href="#cb163-1396"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb163-1397"><a href="#cb163-1397"></a></span>
<span id="cb163-1398"><a href="#cb163-1398"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1399"><a href="#cb163-1399"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1400"><a href="#cb163-1400"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb163-1401"><a href="#cb163-1401"></a>b1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb163-1402"><a href="#cb163-1402"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-1403"><a href="#cb163-1403"></a></span>
<span id="cb163-1404"><a href="#cb163-1404"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1405"><a href="#cb163-1405"></a>x1_num <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-1406"><a href="#cb163-1406"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1_num <span class="sc">+</span> error</span>
<span id="cb163-1407"><a href="#cb163-1407"></a></span>
<span id="cb163-1408"><a href="#cb163-1408"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1_num, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb163-1409"><a href="#cb163-1409"></a></span>
<span id="cb163-1410"><a href="#cb163-1410"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1411"><a href="#cb163-1411"></a>xy_datos_cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x1_num, y)</span>
<span id="cb163-1412"><a href="#cb163-1412"></a></span>
<span id="cb163-1413"><a href="#cb163-1413"></a><span class="fu">head</span>(xy_datos_cat)</span>
<span id="cb163-1414"><a href="#cb163-1414"></a></span>
<span id="cb163-1415"><a href="#cb163-1415"></a><span class="in">```</span></span>
<span id="cb163-1416"><a href="#cb163-1416"></a></span>
<span id="cb163-1417"><a href="#cb163-1417"></a>&nbsp;</span>
<span id="cb163-1418"><a href="#cb163-1418"></a></span>
<span id="cb163-1419"><a href="#cb163-1419"></a>Y así es como se escribe formalmente:</span>
<span id="cb163-1420"><a href="#cb163-1420"></a></span>
<span id="cb163-1421"><a href="#cb163-1421"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1422"><a href="#cb163-1422"></a></span>
<span id="cb163-1423"><a href="#cb163-1423"></a>&nbsp;</span>
<span id="cb163-1424"><a href="#cb163-1424"></a></span>
<span id="cb163-1425"><a href="#cb163-1425"></a>Lo mismo que con los predictores continuos.</span>
<span id="cb163-1426"><a href="#cb163-1426"></a></span>
<span id="cb163-1427"><a href="#cb163-1427"></a>Podemos explorar el patrón de los datos utilizando un diagrama de cajas (boxplot):</span>
<span id="cb163-1428"><a href="#cb163-1428"></a></span>
<span id="cb163-1431"><a href="#cb163-1431"></a><span class="in">```{r}</span></span>
<span id="cb163-1432"><a href="#cb163-1432"></a><span class="co"># graficar</span></span>
<span id="cb163-1433"><a href="#cb163-1433"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-1434"><a href="#cb163-1434"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb163-1435"><a href="#cb163-1435"></a></span>
<span id="cb163-1436"><a href="#cb163-1436"></a><span class="in">```</span></span>
<span id="cb163-1437"><a href="#cb163-1437"></a></span>
<span id="cb163-1438"><a href="#cb163-1438"></a>&nbsp;</span>
<span id="cb163-1439"><a href="#cb163-1439"></a></span>
<span id="cb163-1440"><a href="#cb163-1440"></a>... y obtener los estimados del modelo:</span>
<span id="cb163-1441"><a href="#cb163-1441"></a></span>
<span id="cb163-1444"><a href="#cb163-1444"></a><span class="in">```{r}</span></span>
<span id="cb163-1445"><a href="#cb163-1445"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1446"><a href="#cb163-1446"></a>xy_mod_cat <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb163-1447"><a href="#cb163-1447"></a></span>
<span id="cb163-1448"><a href="#cb163-1448"></a><span class="fu">summary</span>(xy_mod_cat)</span>
<span id="cb163-1449"><a href="#cb163-1449"></a><span class="in">```</span></span>
<span id="cb163-1450"><a href="#cb163-1450"></a></span>
<span id="cb163-1451"><a href="#cb163-1451"></a>&nbsp;</span>
<span id="cb163-1452"><a href="#cb163-1452"></a></span>
<span id="cb163-1453"><a href="#cb163-1453"></a>... graficar los tamaños de efecto:</span>
<span id="cb163-1454"><a href="#cb163-1454"></a></span>
<span id="cb163-1457"><a href="#cb163-1457"></a><span class="in">```{r}</span></span>
<span id="cb163-1458"><a href="#cb163-1458"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_cat<span class="sc">$</span>coefficients), </span>
<span id="cb163-1459"><a href="#cb163-1459"></a>                    <span class="at">est =</span> xy_mod_cat<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_cat))</span>
<span id="cb163-1460"><a href="#cb163-1460"></a></span>
<span id="cb163-1461"><a href="#cb163-1461"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb163-1462"><a href="#cb163-1462"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-1463"><a href="#cb163-1463"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb163-1464"><a href="#cb163-1464"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb163-1465"><a href="#cb163-1465"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb163-1466"><a href="#cb163-1466"></a></span>
<span id="cb163-1467"><a href="#cb163-1467"></a><span class="in">```</span></span>
<span id="cb163-1468"><a href="#cb163-1468"></a></span>
<span id="cb163-1469"><a href="#cb163-1469"></a>&nbsp;</span>
<span id="cb163-1470"><a href="#cb163-1470"></a></span>
<span id="cb163-1471"><a href="#cb163-1471"></a>... y los gráficos diagnósticos del modelo:</span>
<span id="cb163-1472"><a href="#cb163-1472"></a></span>
<span id="cb163-1473"><a href="#cb163-1473"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb163-1474"><a href="#cb163-1474"></a></span>
<span id="cb163-1475"><a href="#cb163-1475"></a><span class="fu">plot_model</span>(xy_mod_cat, <span class="at">type =</span> <span class="st">"diag"</span>)[[<span class="dv">2</span>]]</span>
<span id="cb163-1476"><a href="#cb163-1476"></a></span>
<span id="cb163-1477"><a href="#cb163-1477"></a><span class="in">```</span></span>
<span id="cb163-1478"><a href="#cb163-1478"></a></span>
<span id="cb163-1479"><a href="#cb163-1479"></a>&nbsp;</span>
<span id="cb163-1480"><a href="#cb163-1480"></a></span>
<span id="cb163-1481"><a href="#cb163-1481"></a>::: {.alert .alert-success}</span>
<span id="cb163-1482"><a href="#cb163-1482"></a>&nbsp;</span>
<span id="cb163-1483"><a href="#cb163-1483"></a></span>
<span id="cb163-1484"><a href="#cb163-1484"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1485"><a href="#cb163-1485"></a></span>
<span id="cb163-1486"><a href="#cb163-1486"></a>&nbsp;</span>
<span id="cb163-1487"><a href="#cb163-1487"></a></span>
<span id="cb163-1488"><a href="#cb163-1488"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb163-1489"><a href="#cb163-1489"></a></span>
<span id="cb163-1490"><a href="#cb163-1490"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-1491"><a href="#cb163-1491"></a></span>
<span id="cb163-1492"><a href="#cb163-1492"></a>summ_xy_mod_cat <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod_cat)</span>
<span id="cb163-1493"><a href="#cb163-1493"></a></span>
<span id="cb163-1494"><a href="#cb163-1494"></a>summ_xy_mod_cat<span class="sc">$</span>coefficients</span>
<span id="cb163-1495"><a href="#cb163-1495"></a><span class="in">```</span></span>
<span id="cb163-1496"><a href="#cb163-1496"></a></span>
<span id="cb163-1497"><a href="#cb163-1497"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_xy_mod_cat$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_xy_mod_cat$coefficients[2, 4]`</span>)</span>
<span id="cb163-1498"><a href="#cb163-1498"></a></span>
<span id="cb163-1499"><a href="#cb163-1499"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb163-1500"><a href="#cb163-1500"></a></span>
<span id="cb163-1501"><a href="#cb163-1501"></a><span class="ss">    -   </span>$\beta_1$ se fijó en <span class="in">`r b1`</span> y se estimó como <span class="in">`r round(summ_xy_mod_cat$coefficients[2, 1], 3)`</span>.</span>
<span id="cb163-1502"><a href="#cb163-1502"></a></span>
<span id="cb163-1503"><a href="#cb163-1503"></a><span class="ss">-   </span>Tenga en cuenta que en este caso el intercepto se refiere a la estimación del nivel 'a' en el predictor categórico, que se utilizó como base:</span>
<span id="cb163-1504"><a href="#cb163-1504"></a></span>
<span id="cb163-1505"><a href="#cb163-1505"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb163-1506"><a href="#cb163-1506"></a></span>
<span id="cb163-1507"><a href="#cb163-1507"></a><span class="co"># graficar</span></span>
<span id="cb163-1508"><a href="#cb163-1508"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-1509"><a href="#cb163-1509"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb163-1510"><a href="#cb163-1510"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> xy_mod_cat<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb163-1511"><a href="#cb163-1511"></a></span>
<span id="cb163-1512"><a href="#cb163-1512"></a><span class="in">```</span></span>
<span id="cb163-1513"><a href="#cb163-1513"></a></span>
<span id="cb163-1514"><a href="#cb163-1514"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb163-1515"><a href="#cb163-1515"></a></span>
<span id="cb163-1516"><a href="#cb163-1516"></a><span class="fu">ggplot</span>(xy_datos_cat, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-1517"><a href="#cb163-1517"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb163-1518"><a href="#cb163-1518"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> xy_mod_cat<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb163-1519"><a href="#cb163-1519"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#dff0d8"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#dff0d8"</span>, <span class="at">colour=</span><span class="cn">NA</span>))</span>
<span id="cb163-1520"><a href="#cb163-1520"></a></span>
<span id="cb163-1521"><a href="#cb163-1521"></a><span class="in">```</span></span>
<span id="cb163-1522"><a href="#cb163-1522"></a></span>
<span id="cb163-1523"><a href="#cb163-1523"></a><span class="ss">-   </span>Por lo tanto, el intercepto es el mismo que la media de *y* para la categoría 'a':</span>
<span id="cb163-1524"><a href="#cb163-1524"></a></span>
<span id="cb163-1527"><a href="#cb163-1527"></a><span class="in">```{r}</span></span>
<span id="cb163-1528"><a href="#cb163-1528"></a><span class="fu">mean</span>(xy_datos_cat<span class="sc">$</span>y[xy_datos_cat<span class="sc">$</span>x1 <span class="sc">==</span> <span class="st">"a"</span>])</span>
<span id="cb163-1529"><a href="#cb163-1529"></a></span>
<span id="cb163-1530"><a href="#cb163-1530"></a><span class="in">```</span></span>
<span id="cb163-1531"><a href="#cb163-1531"></a></span>
<span id="cb163-1532"><a href="#cb163-1532"></a><span class="ss">-   </span>Observe también que la etiqueta del estimado es 'x1b', no 'x1' como en los predictores continuos. Esto se debe a que en este caso el estimado se refiere a la diferencia entre los dos niveles de la variable categórica ('a' y 'b'). Más concretamente, nos dice que en promedio las observaciones de la categoría 'b' son <span class="in">`r round(summ_xy_mod_cat$coefficients[2, 1], 3)`</span> más altas que las observaciones de la categoría 'a'.</span>
<span id="cb163-1533"><a href="#cb163-1533"></a></span>
<span id="cb163-1534"><a href="#cb163-1534"></a>&nbsp;</span>
<span id="cb163-1535"><a href="#cb163-1535"></a>:::</span>
<span id="cb163-1536"><a href="#cb163-1536"></a></span>
<span id="cb163-1537"><a href="#cb163-1537"></a>&nbsp;</span>
<span id="cb163-1538"><a href="#cb163-1538"></a></span>
<span id="cb163-1539"><a href="#cb163-1539"></a>::: {.alert .alert-warning}</span>
<span id="cb163-1540"><a href="#cb163-1540"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1541"><a href="#cb163-1541"></a></span>
<span id="cb163-1542"><a href="#cb163-1542"></a>&nbsp;</span>
<span id="cb163-1543"><a href="#cb163-1543"></a></span>
<span id="cb163-1544"><a href="#cb163-1544"></a><span class="ss">-   </span>Rico-Guevara A, &amp; M Araya-Salas. 2015. <span class="co">[</span><span class="ot">**Bills as daggers? A test for sexually dimorphic weapons in a lekking hummingbird species**</span><span class="co">](https://academic.oup.com/beheco/article/26/1/21/2262689)</span>. *Behavioral Ecology*. 26 (1): 21-29.</span>
<span id="cb163-1545"><a href="#cb163-1545"></a></span>
<span id="cb163-1546"><a href="#cb163-1546"></a>"*Los machos con puntas de pico más grandes y puntiagudas tuvieron más éxito en ganar control de territorios en el lek.*"</span>
<span id="cb163-1547"><a href="#cb163-1547"></a></span>
<span id="cb163-1548"><a href="#cb163-1548"></a><span class="in">```{r, out.width = "75%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-1549"><a href="#cb163-1549"></a></span>
<span id="cb163-1550"><a href="#cb163-1550"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/daggers_lbh.png"</span>)</span>
<span id="cb163-1551"><a href="#cb163-1551"></a></span>
<span id="cb163-1552"><a href="#cb163-1552"></a><span class="in">```</span></span>
<span id="cb163-1553"><a href="#cb163-1553"></a></span>
<span id="cb163-1554"><a href="#cb163-1554"></a>&nbsp;</span>
<span id="cb163-1555"><a href="#cb163-1555"></a>:::</span>
<span id="cb163-1556"><a href="#cb163-1556"></a></span>
<span id="cb163-1557"><a href="#cb163-1557"></a>&nbsp;</span>
<span id="cb163-1558"><a href="#cb163-1558"></a></span>
<span id="cb163-1559"><a href="#cb163-1559"></a>::: {.alert .alert-info}</span>
<span id="cb163-1560"><a href="#cb163-1560"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 6<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-1561"><a href="#cb163-1561"></a></span>
<span id="cb163-1562"><a href="#cb163-1562"></a>&nbsp;</span>
<span id="cb163-1563"><a href="#cb163-1563"></a></span>
<span id="cb163-1564"><a href="#cb163-1564"></a><span class="ss">-   </span>Los datos desbalanceados cuando hay categorías (es decir, algunas categorías tienen muchas más observaciones que otras) pueden ser problemáticos para la inferencia estadística. Modifique el código <span class="co">[</span><span class="ot">arriba</span><span class="co">](#cb99-1)</span> para simular un juego de datos muy desbalanceado y compruebe la precisión del modelo.</span>
<span id="cb163-1565"><a href="#cb163-1565"></a>:::</span>
<span id="cb163-1566"><a href="#cb163-1566"></a></span>
<span id="cb163-1567"><a href="#cb163-1567"></a>------------------------------------------------------------------------</span>
<span id="cb163-1568"><a href="#cb163-1568"></a></span>
<span id="cb163-1569"><a href="#cb163-1569"></a>::: {.alert .alert-warning}</span>
<span id="cb163-1570"><a href="#cb163-1570"></a><span class="kw">&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span></span>
<span id="cb163-1571"><a href="#cb163-1571"></a></span>
<span id="cb163-1572"><a href="#cb163-1572"></a><span class="kw">&lt;center&gt;</span>Variables indicadoras (Dummy variables)<span class="kw">&lt;/center&gt;</span></span>
<span id="cb163-1573"><a href="#cb163-1573"></a></span>
<span id="cb163-1574"><a href="#cb163-1574"></a><span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-1575"><a href="#cb163-1575"></a></span>
<span id="cb163-1576"><a href="#cb163-1576"></a>En un modelo de regresión, los predictores categóricos también se representan como vectores numéricos. Más concretamente, los predictores categóricos se codifican como 0s y 1s, en los que 1 significa "pertenece a la misma categoría" y 0 "pertenece a una categoría diferente". Mantuvimos el vector numérico original ('x1_num') al simular el juego de datos con el predictor categórico:</span>
<span id="cb163-1577"><a href="#cb163-1577"></a></span>
<span id="cb163-1580"><a href="#cb163-1580"></a><span class="in">```{r}</span></span>
<span id="cb163-1581"><a href="#cb163-1581"></a><span class="fu">head</span>(xy_datos_cat)</span>
<span id="cb163-1582"><a href="#cb163-1582"></a></span>
<span id="cb163-1583"><a href="#cb163-1583"></a><span class="in">```</span></span>
<span id="cb163-1584"><a href="#cb163-1584"></a></span>
<span id="cb163-1585"><a href="#cb163-1585"></a>Observe que las "b" de la columna "x1" se convierten en 1 en la columna "x1_num" y las "a" se convierten en 0. Esto se denomina variable indicadora y el proceso se conoce como 'codificación indicadora' (dummy coding).</span>
<span id="cb163-1586"><a href="#cb163-1586"></a></span>
<span id="cb163-1587"><a href="#cb163-1587"></a>En realidad, podemos utilizar el vector numérico en el modelo de regresión y obtener exactamente los mismos resultados:</span>
<span id="cb163-1588"><a href="#cb163-1588"></a></span>
<span id="cb163-1591"><a href="#cb163-1591"></a><span class="in">```{r}</span></span>
<span id="cb163-1592"><a href="#cb163-1592"></a><span class="co"># summary model with categorical variable</span></span>
<span id="cb163-1593"><a href="#cb163-1593"></a><span class="fu">summary</span>(xy_mod_cat)<span class="sc">$</span>coefficients</span>
<span id="cb163-1594"><a href="#cb163-1594"></a></span>
<span id="cb163-1595"><a href="#cb163-1595"></a><span class="co"># construir modelos with dummy variable</span></span>
<span id="cb163-1596"><a href="#cb163-1596"></a>xy_mod_num <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1_num, <span class="at">data =</span> xy_datos_cat)</span>
<span id="cb163-1597"><a href="#cb163-1597"></a></span>
<span id="cb163-1598"><a href="#cb163-1598"></a><span class="co"># summary with dummy coding</span></span>
<span id="cb163-1599"><a href="#cb163-1599"></a><span class="fu">summary</span>(xy_mod_num)<span class="sc">$</span>coefficients</span>
<span id="cb163-1600"><a href="#cb163-1600"></a></span>
<span id="cb163-1601"><a href="#cb163-1601"></a><span class="in">```</span></span>
<span id="cb163-1602"><a href="#cb163-1602"></a></span>
<span id="cb163-1603"><a href="#cb163-1603"></a>&nbsp;</span>
<span id="cb163-1604"><a href="#cb163-1604"></a></span>
<span id="cb163-1605"><a href="#cb163-1605"></a>Las cosas se complican un poco más cuando se codifica un predictor categórico con más de dos niveles. Pero la lógica es la misma.</span>
<span id="cb163-1606"><a href="#cb163-1606"></a>:::</span>
<span id="cb163-1607"><a href="#cb163-1607"></a></span>
<span id="cb163-1608"><a href="#cb163-1608"></a>&nbsp;</span>
<span id="cb163-1609"><a href="#cb163-1609"></a></span>
<span id="cb163-1610"><a href="#cb163-1610"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb163-1611"><a href="#cb163-1611"></a>This approach can be extended to simulate categorical variables with more than <span class="dv">2</span> levels<span class="sc">:</span></span>
<span id="cb163-1612"><a href="#cb163-1612"></a></span>
<span id="cb163-1613"><a href="#cb163-1613"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1614"><a href="#cb163-1614"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1615"><a href="#cb163-1615"></a></span>
<span id="cb163-1616"><a href="#cb163-1616"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1617"><a href="#cb163-1617"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1618"><a href="#cb163-1618"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1619"><a href="#cb163-1619"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1620"><a href="#cb163-1620"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1621"><a href="#cb163-1621"></a></span>
<span id="cb163-1622"><a href="#cb163-1622"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1623"><a href="#cb163-1623"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.33</span>, <span class="fl">0.33</span>))</span>
<span id="cb163-1624"><a href="#cb163-1624"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb163-1625"><a href="#cb163-1625"></a></span>
<span id="cb163-1626"><a href="#cb163-1626"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>))</span>
<span id="cb163-1627"><a href="#cb163-1627"></a></span>
<span id="cb163-1628"><a href="#cb163-1628"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1629"><a href="#cb163-1629"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb163-1630"><a href="#cb163-1630"></a></span>
<span id="cb163-1631"><a href="#cb163-1631"></a><span class="co"># boxplot(formula = y ~ x1, data = xy_datos)</span></span>
<span id="cb163-1632"><a href="#cb163-1632"></a></span>
<span id="cb163-1633"><a href="#cb163-1633"></a><span class="fu">ggplot</span>(xy_datos, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-1634"><a href="#cb163-1634"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb163-1635"><a href="#cb163-1635"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> xy_mod<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb163-1636"><a href="#cb163-1636"></a></span>
<span id="cb163-1637"><a href="#cb163-1637"></a><span class="sc">&amp;</span>nbsp;</span>
<span id="cb163-1638"><a href="#cb163-1638"></a></span>
<span id="cb163-1639"><a href="#cb163-1639"></a>And these are the results<span class="sc">:</span></span>
<span id="cb163-1640"><a href="#cb163-1640"></a></span>
<span id="cb163-1641"><a href="#cb163-1641"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1642"><a href="#cb163-1642"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1643"><a href="#cb163-1643"></a></span>
<span id="cb163-1644"><a href="#cb163-1644"></a><span class="fu">summary</span>(xy_mod)</span>
<span id="cb163-1645"><a href="#cb163-1645"></a><span class="in">```</span></span>
<span id="cb163-1646"><a href="#cb163-1646"></a></span>
<span id="cb163-1647"><a href="#cb163-1647"></a>------------------------------------------------------------------------</span>
<span id="cb163-1648"><a href="#cb163-1648"></a></span>
<span id="cb163-1649"><a href="#cb163-1649"></a><span class="fu">## Interacciones</span></span>
<span id="cb163-1650"><a href="#cb163-1650"></a></span>
<span id="cb163-1651"><a href="#cb163-1651"></a>Una interacción estadística se refiere a un efecto de una variable predictora que está mediado por una segunda variable.</span>
<span id="cb163-1652"><a href="#cb163-1652"></a></span>
<span id="cb163-1653"><a href="#cb163-1653"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2} + \beta_{3} * x_{1} * x_{2}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1654"><a href="#cb163-1654"></a></span>
<span id="cb163-1655"><a href="#cb163-1655"></a>&nbsp;</span>
<span id="cb163-1656"><a href="#cb163-1656"></a></span>
<span id="cb163-1657"><a href="#cb163-1657"></a>Esto es más fácil de entender si se observa la interacción de una variable continua y una binaria:</span>
<span id="cb163-1658"><a href="#cb163-1658"></a></span>
<span id="cb163-1661"><a href="#cb163-1661"></a><span class="in">```{r}</span></span>
<span id="cb163-1662"><a href="#cb163-1662"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1663"><a href="#cb163-1663"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1664"><a href="#cb163-1664"></a></span>
<span id="cb163-1665"><a href="#cb163-1665"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1666"><a href="#cb163-1666"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1667"><a href="#cb163-1667"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1668"><a href="#cb163-1668"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1669"><a href="#cb163-1669"></a>b2 <span class="ot">&lt;-</span> <span class="fl">1.7</span></span>
<span id="cb163-1670"><a href="#cb163-1670"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb163-1671"><a href="#cb163-1671"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb163-1672"><a href="#cb163-1672"></a></span>
<span id="cb163-1673"><a href="#cb163-1673"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1674"><a href="#cb163-1674"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb163-1675"><a href="#cb163-1675"></a>x2 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1676"><a href="#cb163-1676"></a></span>
<span id="cb163-1677"><a href="#cb163-1677"></a><span class="co"># interaccion se añade como el producto dex1 y x2</span></span>
<span id="cb163-1678"><a href="#cb163-1678"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> b2 <span class="sc">*</span> x2 <span class="sc">+</span> b3 <span class="sc">*</span> x1 <span class="sc">*</span> x2 <span class="sc">+</span> error</span>
<span id="cb163-1679"><a href="#cb163-1679"></a></span>
<span id="cb163-1680"><a href="#cb163-1680"></a>x1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(x1, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>))</span>
<span id="cb163-1681"><a href="#cb163-1681"></a></span>
<span id="cb163-1682"><a href="#cb163-1682"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1683"><a href="#cb163-1683"></a>xy_datos_intr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb163-1684"><a href="#cb163-1684"></a></span>
<span id="cb163-1685"><a href="#cb163-1685"></a><span class="fu">head</span>(xy_datos_intr)</span>
<span id="cb163-1686"><a href="#cb163-1686"></a></span>
<span id="cb163-1687"><a href="#cb163-1687"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1688"><a href="#cb163-1688"></a>xy_mod_intr <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1 <span class="sc">*</span> x2, <span class="at">data =</span> xy_datos_intr)</span>
<span id="cb163-1689"><a href="#cb163-1689"></a></span>
<span id="cb163-1690"><a href="#cb163-1690"></a><span class="co"># guardar resumen para graficar lineas de mejor ajuste</span></span>
<span id="cb163-1691"><a href="#cb163-1691"></a>xy_summ_intr <span class="ot">&lt;-</span> <span class="fu">summary</span>(xy_mod_intr)</span>
<span id="cb163-1692"><a href="#cb163-1692"></a></span>
<span id="cb163-1693"><a href="#cb163-1693"></a>xy_summ_intr</span>
<span id="cb163-1694"><a href="#cb163-1694"></a></span>
<span id="cb163-1695"><a href="#cb163-1695"></a><span class="in">```</span></span>
<span id="cb163-1696"><a href="#cb163-1696"></a></span>
<span id="cb163-1697"><a href="#cb163-1697"></a>También ayuda graficar los datos:</span>
<span id="cb163-1698"><a href="#cb163-1698"></a></span>
<span id="cb163-1699"><a href="#cb163-1699"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb163-1700"><a href="#cb163-1700"></a></span>
<span id="cb163-1701"><a href="#cb163-1701"></a><span class="co"># graficar</span></span>
<span id="cb163-1702"><a href="#cb163-1702"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_intr, <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y, <span class="at">color =</span> x1)) <span class="sc">+</span></span>
<span id="cb163-1703"><a href="#cb163-1703"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb163-1704"><a href="#cb163-1704"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb163-1705"><a href="#cb163-1705"></a></span>
<span id="cb163-1706"><a href="#cb163-1706"></a><span class="in">```</span></span>
<span id="cb163-1707"><a href="#cb163-1707"></a></span>
<span id="cb163-1708"><a href="#cb163-1708"></a><span class="in">```{r, echo = FALSE, out.width = "80%"}</span></span>
<span id="cb163-1709"><a href="#cb163-1709"></a></span>
<span id="cb163-1710"><a href="#cb163-1710"></a><span class="co"># graficar</span></span>
<span id="cb163-1711"><a href="#cb163-1711"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_intr, <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> y, <span class="at">color =</span> x1)) <span class="sc">+</span></span>
<span id="cb163-1712"><a href="#cb163-1712"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb163-1713"><a href="#cb163-1713"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb163-1714"><a href="#cb163-1714"></a></span>
<span id="cb163-1715"><a href="#cb163-1715"></a><span class="in">```</span></span>
<span id="cb163-1716"><a href="#cb163-1716"></a></span>
<span id="cb163-1717"><a href="#cb163-1717"></a>&nbsp;</span>
<span id="cb163-1718"><a href="#cb163-1718"></a></span>
<span id="cb163-1719"><a href="#cb163-1719"></a>... y los tamaños de efecto:</span>
<span id="cb163-1720"><a href="#cb163-1720"></a></span>
<span id="cb163-1723"><a href="#cb163-1723"></a><span class="in">```{r}</span></span>
<span id="cb163-1724"><a href="#cb163-1724"></a>ci_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">param =</span> <span class="fu">names</span>(xy_mod_intr<span class="sc">$</span>coefficients), </span>
<span id="cb163-1725"><a href="#cb163-1725"></a>                    <span class="at">est =</span> xy_mod_intr<span class="sc">$</span>coefficients, <span class="fu">confint</span>(xy_mod_intr))</span>
<span id="cb163-1726"><a href="#cb163-1726"></a></span>
<span id="cb163-1727"><a href="#cb163-1727"></a><span class="fu">ggplot</span>(ci_df, <span class="fu">aes</span>(<span class="at">x=</span>param, <span class="at">y=</span>est)) <span class="sc">+</span> </span>
<span id="cb163-1728"><a href="#cb163-1728"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-1729"><a href="#cb163-1729"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> X2.<span class="dv">5</span>.., <span class="at">ymax =</span> X97.<span class="dv">5</span>..)) <span class="sc">+</span> </span>
<span id="cb163-1730"><a href="#cb163-1730"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Parámetro"</span>, <span class="at">y =</span> <span class="st">"Tamaño de efecto"</span>) <span class="sc">+</span> </span>
<span id="cb163-1731"><a href="#cb163-1731"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb163-1732"><a href="#cb163-1732"></a></span>
<span id="cb163-1733"><a href="#cb163-1733"></a><span class="in">```</span></span>
<span id="cb163-1734"><a href="#cb163-1734"></a></span>
<span id="cb163-1735"><a href="#cb163-1735"></a>&nbsp;</span>
<span id="cb163-1736"><a href="#cb163-1736"></a></span>
<span id="cb163-1737"><a href="#cb163-1737"></a>También deberíamos revisar los gráficos de diagnóstico:</span>
<span id="cb163-1738"><a href="#cb163-1738"></a></span>
<span id="cb163-1739"><a href="#cb163-1739"></a><span class="in">```{r, out.width= "80%", fig.height=4}</span></span>
<span id="cb163-1740"><a href="#cb163-1740"></a></span>
<span id="cb163-1741"><a href="#cb163-1741"></a><span class="fu">plot_model</span>(xy_mod_intr, <span class="at">type =</span> <span class="st">"diag"</span>)</span>
<span id="cb163-1742"><a href="#cb163-1742"></a></span>
<span id="cb163-1743"><a href="#cb163-1743"></a><span class="in">```</span></span>
<span id="cb163-1744"><a href="#cb163-1744"></a></span>
<span id="cb163-1745"><a href="#cb163-1745"></a>&nbsp;</span>
<span id="cb163-1746"><a href="#cb163-1746"></a></span>
<span id="cb163-1747"><a href="#cb163-1747"></a>::: {.alert .alert-success}</span>
<span id="cb163-1748"><a href="#cb163-1748"></a>&nbsp;</span>
<span id="cb163-1749"><a href="#cb163-1749"></a></span>
<span id="cb163-1750"><a href="#cb163-1750"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1751"><a href="#cb163-1751"></a></span>
<span id="cb163-1752"><a href="#cb163-1752"></a>&nbsp;</span>
<span id="cb163-1753"><a href="#cb163-1753"></a></span>
<span id="cb163-1754"><a href="#cb163-1754"></a>Cuadro con los coeficientes:</span>
<span id="cb163-1755"><a href="#cb163-1755"></a></span>
<span id="cb163-1756"><a href="#cb163-1756"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-1757"><a href="#cb163-1757"></a></span>
<span id="cb163-1758"><a href="#cb163-1758"></a>xy_summ_intr<span class="sc">$</span>coefficients</span>
<span id="cb163-1759"><a href="#cb163-1759"></a></span>
<span id="cb163-1760"><a href="#cb163-1760"></a><span class="in">```</span></span>
<span id="cb163-1761"><a href="#cb163-1761"></a></span>
<span id="cb163-1762"><a href="#cb163-1762"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1-b' a 'x1-a') es <span class="in">`r xy_summ_intr$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (valor p = <span class="in">`r xy_summ_intr$coefficients[2, 4]`</span>)</span>
<span id="cb163-1763"><a href="#cb163-1763"></a></span>
<span id="cb163-1764"><a href="#cb163-1764"></a><span class="ss">-   </span>El modelo encontró que $\beta_2$ (el tamaño de efecto de 'x2') es <span class="in">`r xy_summ_intr$coefficients[3, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r xy_summ_intr$coefficients[3, 4]`</span>). Esto es en realidad la pendiente de la relación entre x2 e y cuando x1 = <span class="sc">\`</span>a'</span>
<span id="cb163-1765"><a href="#cb163-1765"></a></span>
<span id="cb163-1766"><a href="#cb163-1766"></a><span class="ss">-   </span>El modelo encontró que $\beta_3$ (el tamaño de efecto del término de interacción 'x1 <span class="sc">\*</span> x2') es <span class="in">`r xy_summ_intr$coefficients[4, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r xy_summ_intr$coefficients[4, 4]`</span>). Esta es la diferencia entre las pendientes de x2 *vs* y cuando x1 = 'a' y x2 *vs* y cuando x1 = 'b'.</span>
<span id="cb163-1767"><a href="#cb163-1767"></a></span>
<span id="cb163-1768"><a href="#cb163-1768"></a><span class="ss">-   </span>Los valores simulados para los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lm()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb163-1769"><a href="#cb163-1769"></a></span>
<span id="cb163-1770"><a href="#cb163-1770"></a><span class="ss">    -   </span>$\beta_1$ se simuló con un valor de <span class="in">`r b1`</span> y se estimó en <span class="in">`r round(xy_summ_intr$coefficients[2, 1], 3)`</span></span>
<span id="cb163-1771"><a href="#cb163-1771"></a></span>
<span id="cb163-1772"><a href="#cb163-1772"></a><span class="ss">    -   </span>$\beta_2$ se simuló con un valor de <span class="in">`r b2`</span> y se estimó en <span class="in">`r round(xy_summ_intr$coefficients[3, 1], 3)`</span></span>
<span id="cb163-1773"><a href="#cb163-1773"></a></span>
<span id="cb163-1774"><a href="#cb163-1774"></a><span class="ss">    -   </span>$\beta_3$ se simuló con un valor de <span class="in">`r b3`</span> y se estimó en <span class="in">`r round(xy_summ_intr$coefficients[4, 1], 3)`</span></span>
<span id="cb163-1775"><a href="#cb163-1775"></a>:::</span>
<span id="cb163-1776"><a href="#cb163-1776"></a></span>
<span id="cb163-1777"><a href="#cb163-1777"></a>------------------------------------------------------------------------</span>
<span id="cb163-1778"><a href="#cb163-1778"></a></span>
<span id="cb163-1779"><a href="#cb163-1779"></a>&nbsp;</span>
<span id="cb163-1780"><a href="#cb163-1780"></a></span>
<span id="cb163-1781"><a href="#cb163-1781"></a>::: {.alert .alert-warning}</span>
<span id="cb163-1782"><a href="#cb163-1782"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1783"><a href="#cb163-1783"></a></span>
<span id="cb163-1784"><a href="#cb163-1784"></a>&nbsp;</span>
<span id="cb163-1785"><a href="#cb163-1785"></a></span>
<span id="cb163-1786"><a href="#cb163-1786"></a><span class="ss">-   </span>Chirino F, B Wilink, Araya-Salas M. In prep. **Climatic factors affecting vocal activity in lemur leaf frogs**.</span>
<span id="cb163-1787"><a href="#cb163-1787"></a></span>
<span id="cb163-1788"><a href="#cb163-1788"></a>"*El aumento de la luz de la luna disminuye la actividad vocal de* Agalychnis lemur *aunque esta relación es mediada por la temperatura.*"</span>
<span id="cb163-1789"><a href="#cb163-1789"></a></span>
<span id="cb163-1790"><a href="#cb163-1790"></a><span class="in">```{r, out.width = "70%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-1791"><a href="#cb163-1791"></a></span>
<span id="cb163-1792"><a href="#cb163-1792"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/lemur.png"</span>)</span>
<span id="cb163-1793"><a href="#cb163-1793"></a></span>
<span id="cb163-1794"><a href="#cb163-1794"></a><span class="in">```</span></span>
<span id="cb163-1795"><a href="#cb163-1795"></a></span>
<span id="cb163-1796"><a href="#cb163-1796"></a>&nbsp;</span>
<span id="cb163-1797"><a href="#cb163-1797"></a>:::</span>
<span id="cb163-1798"><a href="#cb163-1798"></a></span>
<span id="cb163-1799"><a href="#cb163-1799"></a>&nbsp;</span>
<span id="cb163-1800"><a href="#cb163-1800"></a></span>
<span id="cb163-1801"><a href="#cb163-1801"></a>::: {.alert .alert-info}</span>
<span id="cb163-1802"><a href="#cb163-1802"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 7<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-1803"><a href="#cb163-1803"></a></span>
<span id="cb163-1804"><a href="#cb163-1804"></a>&nbsp;</span>
<span id="cb163-1805"><a href="#cb163-1805"></a></span>
<span id="cb163-1806"><a href="#cb163-1806"></a><span class="ss">-   </span>Modifique el <span class="co">[</span><span class="ot">código usado para simular un único predictor asociado</span><span class="co">](#simular-un-predictor-asociado)</span> aumentando gradualmente el error. Esto se hace aumentando el argumento 'sd' en <span class="in">`error &lt;- rnorm(n = n, sd = 2)`</span>.</span>
<span id="cb163-1807"><a href="#cb163-1807"></a></span>
<span id="cb163-1808"><a href="#cb163-1808"></a><span class="ss">-   </span>Mire cómo los errores más grandes afectan la inferencia (debe volver a correr los modelos)</span>
<span id="cb163-1809"><a href="#cb163-1809"></a></span>
<span id="cb163-1810"><a href="#cb163-1810"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb163-1811"><a href="#cb163-1811"></a></span>
<span id="cb163-1812"><a href="#cb163-1812"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1813"><a href="#cb163-1813"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1814"><a href="#cb163-1814"></a></span>
<span id="cb163-1815"><a href="#cb163-1815"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1816"><a href="#cb163-1816"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1817"><a href="#cb163-1817"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1818"><a href="#cb163-1818"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1819"><a href="#cb163-1819"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb163-1820"><a href="#cb163-1820"></a></span>
<span id="cb163-1821"><a href="#cb163-1821"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1822"><a href="#cb163-1822"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1823"><a href="#cb163-1823"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb163-1824"><a href="#cb163-1824"></a></span>
<span id="cb163-1825"><a href="#cb163-1825"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1826"><a href="#cb163-1826"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb163-1827"><a href="#cb163-1827"></a></span>
<span id="cb163-1828"><a href="#cb163-1828"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1829"><a href="#cb163-1829"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos))</span>
<span id="cb163-1830"><a href="#cb163-1830"></a></span>
<span id="cb163-1831"><a href="#cb163-1831"></a><span class="in">```</span></span>
<span id="cb163-1832"><a href="#cb163-1832"></a></span>
<span id="cb163-1833"><a href="#cb163-1833"></a><span class="ss">-   </span>Ahora reemplace el término de error con <span class="in">`error &lt;- rexp(n = n, rate = 0.2)`</span>. Esto crea un error con una distribución exponencial (por lo tanto no normal). Se supone que esto es problemático para el poder inferencial de estos modelos. Compare las estimaciones que obtuvo con los valores de la simulación ('b0' y 'b1'). Explore la distribución de los residuos (<span class="in">`plot(nombre_del_modelo)`</span>) para los modelos de error 'normal' y 'exponencial'.</span>
<span id="cb163-1834"><a href="#cb163-1834"></a></span>
<span id="cb163-1835"><a href="#cb163-1835"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb163-1836"><a href="#cb163-1836"></a></span>
<span id="cb163-1837"><a href="#cb163-1837"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1838"><a href="#cb163-1838"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1839"><a href="#cb163-1839"></a></span>
<span id="cb163-1840"><a href="#cb163-1840"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1841"><a href="#cb163-1841"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1842"><a href="#cb163-1842"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1843"><a href="#cb163-1843"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1844"><a href="#cb163-1844"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,  <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb163-1845"><a href="#cb163-1845"></a><span class="fu">sd</span>(error)</span>
<span id="cb163-1846"><a href="#cb163-1846"></a></span>
<span id="cb163-1847"><a href="#cb163-1847"></a>error <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="at">n =</span> n, <span class="at">rate =</span> <span class="fl">0.2</span>)</span>
<span id="cb163-1848"><a href="#cb163-1848"></a><span class="fu">sd</span>(error)</span>
<span id="cb163-1849"><a href="#cb163-1849"></a></span>
<span id="cb163-1850"><a href="#cb163-1850"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1851"><a href="#cb163-1851"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1852"><a href="#cb163-1852"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb163-1853"><a href="#cb163-1853"></a></span>
<span id="cb163-1854"><a href="#cb163-1854"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1855"><a href="#cb163-1855"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y)</span>
<span id="cb163-1856"><a href="#cb163-1856"></a></span>
<span id="cb163-1857"><a href="#cb163-1857"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1858"><a href="#cb163-1858"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1859"><a href="#cb163-1859"></a></span>
<span id="cb163-1860"><a href="#cb163-1860"></a><span class="fu">coef</span>(mod)</span>
<span id="cb163-1861"><a href="#cb163-1861"></a>resd_mod <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod)</span>
<span id="cb163-1862"><a href="#cb163-1862"></a></span>
<span id="cb163-1863"><a href="#cb163-1863"></a><span class="co"># ver distribucion</span></span>
<span id="cb163-1864"><a href="#cb163-1864"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(resd_mod), <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> resd_mod)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() </span>
<span id="cb163-1865"><a href="#cb163-1865"></a></span>
<span id="cb163-1866"><a href="#cb163-1866"></a><span class="in">```</span></span>
<span id="cb163-1867"><a href="#cb163-1867"></a></span>
<span id="cb163-1868"><a href="#cb163-1868"></a><span class="ss">-   </span>Se supone que la colinealidad (la presencia de predictores correlacionados) afecta a la estabilidad de la regresión múltiple. El siguiente código crea dos predictores altamente colineales ('x1' y 'x2'). La última línea de código muestra la correlación entre ellos.</span>
<span id="cb163-1869"><a href="#cb163-1869"></a></span>
<span id="cb163-1872"><a href="#cb163-1872"></a><span class="in">```{r}</span></span>
<span id="cb163-1873"><a href="#cb163-1873"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1874"><a href="#cb163-1874"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb163-1875"><a href="#cb163-1875"></a></span>
<span id="cb163-1876"><a href="#cb163-1876"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-1877"><a href="#cb163-1877"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1878"><a href="#cb163-1878"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb163-1879"><a href="#cb163-1879"></a>b1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb163-1880"><a href="#cb163-1880"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb163-1881"><a href="#cb163-1881"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1882"><a href="#cb163-1882"></a></span>
<span id="cb163-1883"><a href="#cb163-1883"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-1884"><a href="#cb163-1884"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-1885"><a href="#cb163-1885"></a></span>
<span id="cb163-1886"><a href="#cb163-1886"></a><span class="co"># hacer x2 muy parecido a x1</span></span>
<span id="cb163-1887"><a href="#cb163-1887"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb163-1888"><a href="#cb163-1888"></a></span>
<span id="cb163-1889"><a href="#cb163-1889"></a><span class="fu">cor</span>(x1, x2)</span>
<span id="cb163-1890"><a href="#cb163-1890"></a></span>
<span id="cb163-1891"><a href="#cb163-1891"></a><span class="in">```</span></span>
<span id="cb163-1892"><a href="#cb163-1892"></a></span>
<span id="cb163-1893"><a href="#cb163-1893"></a><span class="in">```{r, eval=FALSE, echo=FALSE}</span></span>
<span id="cb163-1894"><a href="#cb163-1894"></a></span>
<span id="cb163-1895"><a href="#cb163-1895"></a>xy_datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb163-1896"><a href="#cb163-1896"></a></span>
<span id="cb163-1897"><a href="#cb163-1897"></a><span class="co"># construir modelos</span></span>
<span id="cb163-1898"><a href="#cb163-1898"></a>xy_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos)</span>
<span id="cb163-1899"><a href="#cb163-1899"></a></span>
<span id="cb163-1900"><a href="#cb163-1900"></a><span class="fu">summary</span>(xy_mod)</span>
<span id="cb163-1901"><a href="#cb163-1901"></a></span>
<span id="cb163-1902"><a href="#cb163-1902"></a><span class="in">```</span></span>
<span id="cb163-1903"><a href="#cb163-1903"></a></span>
<span id="cb163-1904"><a href="#cb163-1904"></a><span class="ss">-   </span>Construya un modelo de regresión múltiple para estos datos (y \~ x1 + x2). Puede utilizar el mismo código que en la sección <span class="co">[</span><span class="ot">Añadir más de un predictor: regresión múltiple</span><span class="co">](#añadir-más-de-un-predictor:-regresión-múltiple)</span>.</span>
<span id="cb163-1905"><a href="#cb163-1905"></a></span>
<span id="cb163-1906"><a href="#cb163-1906"></a><span class="ss">-   </span>¿Cómo afecta a la inferencia la presencia de predictores colineales? Realice los gráficos de diagnóstico para este modelo (<span class="in">`plot(nombre_del_modelo)`</span>).</span>
<span id="cb163-1907"><a href="#cb163-1907"></a></span>
<span id="cb163-1908"><a href="#cb163-1908"></a><span class="ss">-   </span>Simule un juego de datos con tres predictores en los que sólo dos de ellos son altamente colineales. Ajuste un modelo de regresión múltiple (y \~ x1 + x2 + x3) para esos datos y observe cómo la colinealidad afecta a la estimación del predictor no colineal.</span>
<span id="cb163-1909"><a href="#cb163-1909"></a></span>
<span id="cb163-1910"><a href="#cb163-1910"></a>&nbsp;</span>
<span id="cb163-1911"><a href="#cb163-1911"></a>:::</span>
<span id="cb163-1912"><a href="#cb163-1912"></a></span>
<span id="cb163-1913"><a href="#cb163-1913"></a>------------------------------------------------------------------------</span>
<span id="cb163-1914"><a href="#cb163-1914"></a></span>
<span id="cb163-1915"><a href="#cb163-1915"></a><span class="fu"># Extender los modelos lineales a estructuras de datos más complejas</span></span>
<span id="cb163-1916"><a href="#cb163-1916"></a></span>
<span id="cb163-1917"><a href="#cb163-1917"></a>&nbsp;</span>
<span id="cb163-1918"><a href="#cb163-1918"></a></span>
<span id="cb163-1919"><a href="#cb163-1919"></a><span class="fu">## Modelos lineales generalizados (GLM)</span></span>
<span id="cb163-1920"><a href="#cb163-1920"></a></span>
<span id="cb163-1921"><a href="#cb163-1921"></a>Los GLM nos permiten modelar la asociación a variables respuesta que no siguen una distribución normal. Además, permiten modelar distribuciones que se asemejan más al proceso que generó los datos. El siguiente código crea un juego de datos con una respuesta que representa cuentas (por lo tanto, no normal):</span>
<span id="cb163-1922"><a href="#cb163-1922"></a></span>
<span id="cb163-1925"><a href="#cb163-1925"></a><span class="in">```{r}</span></span>
<span id="cb163-1926"><a href="#cb163-1926"></a><span class="co"># definir semilla</span></span>
<span id="cb163-1927"><a href="#cb163-1927"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb163-1928"><a href="#cb163-1928"></a></span>
<span id="cb163-1929"><a href="#cb163-1929"></a><span class="co"># numero de muestas</span></span>
<span id="cb163-1930"><a href="#cb163-1930"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb163-1931"><a href="#cb163-1931"></a></span>
<span id="cb163-1932"><a href="#cb163-1932"></a><span class="co"># coeficientes</span></span>
<span id="cb163-1933"><a href="#cb163-1933"></a>b0 <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb163-1934"><a href="#cb163-1934"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb163-1935"><a href="#cb163-1935"></a>b2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb163-1936"><a href="#cb163-1936"></a></span>
<span id="cb163-1937"><a href="#cb163-1937"></a></span>
<span id="cb163-1938"><a href="#cb163-1938"></a><span class="co">#generar variables</span></span>
<span id="cb163-1939"><a href="#cb163-1939"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> n, <span class="at">lambda =</span> <span class="fl">6.5</span>) <span class="co"># lambda = tasa promedio de exitos </span></span>
<span id="cb163-1940"><a href="#cb163-1940"></a>x2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, , <span class="fu">length</span>(y))</span>
<span id="cb163-1941"><a href="#cb163-1941"></a>x1 <span class="ot">&lt;-</span> (<span class="fu">log</span>(y) <span class="sc">-</span> b0 <span class="sc">-</span> b2 <span class="sc">*</span> x2) <span class="sc">/</span> b1</span>
<span id="cb163-1942"><a href="#cb163-1942"></a></span>
<span id="cb163-1943"><a href="#cb163-1943"></a><span class="co"># crear data frame</span></span>
<span id="cb163-1944"><a href="#cb163-1944"></a>xy_datos_pois <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, x2, y)</span>
<span id="cb163-1945"><a href="#cb163-1945"></a></span>
<span id="cb163-1946"><a href="#cb163-1946"></a><span class="fu">head</span>(xy_datos_pois)</span>
<span id="cb163-1947"><a href="#cb163-1947"></a></span>
<span id="cb163-1948"><a href="#cb163-1948"></a><span class="in">```</span></span>
<span id="cb163-1949"><a href="#cb163-1949"></a></span>
<span id="cb163-1950"><a href="#cb163-1950"></a>&nbsp;</span>
<span id="cb163-1951"><a href="#cb163-1951"></a></span>
<span id="cb163-1952"><a href="#cb163-1952"></a>También grafiquemos 'x1' *vs* 'y':</span>
<span id="cb163-1953"><a href="#cb163-1953"></a></span>
<span id="cb163-1956"><a href="#cb163-1956"></a><span class="in">```{r}</span></span>
<span id="cb163-1957"><a href="#cb163-1957"></a><span class="co"># graficar</span></span>
<span id="cb163-1958"><a href="#cb163-1958"></a><span class="fu">ggplot</span>(xy_datos_pois, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-1959"><a href="#cb163-1959"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb163-1960"><a href="#cb163-1960"></a></span>
<span id="cb163-1961"><a href="#cb163-1961"></a><span class="in">```</span></span>
<span id="cb163-1962"><a href="#cb163-1962"></a></span>
<span id="cb163-1963"><a href="#cb163-1963"></a>&nbsp;</span>
<span id="cb163-1964"><a href="#cb163-1964"></a></span>
<span id="cb163-1965"><a href="#cb163-1965"></a>La relación no parece muy lineal ni la varianza parece ser constante a través de 'x1'.</span>
<span id="cb163-1966"><a href="#cb163-1966"></a></span>
<span id="cb163-1967"><a href="#cb163-1967"></a>Podemos relajar el requisito de la distribución normal con GLMs. <span class="in">`glm()`</span> es una función básica de R que nos ayuda a hacer el truco. Para este ejemplo la distribución más apropiada es *Poisson*. Esto se puede establecer en el argumento <span class="sc">\`</span>family' así:</span>
<span id="cb163-1968"><a href="#cb163-1968"></a></span>
<span id="cb163-1971"><a href="#cb163-1971"></a><span class="in">```{r}</span></span>
<span id="cb163-1972"><a href="#cb163-1972"></a>glm_pois  <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> xy_datos_pois, <span class="at">family =</span> <span class="fu">poisson</span>())</span>
<span id="cb163-1973"><a href="#cb163-1973"></a></span>
<span id="cb163-1974"><a href="#cb163-1974"></a><span class="in">```</span></span>
<span id="cb163-1975"><a href="#cb163-1975"></a></span>
<span id="cb163-1976"><a href="#cb163-1976"></a>&nbsp;</span>
<span id="cb163-1977"><a href="#cb163-1977"></a></span>
<span id="cb163-1978"><a href="#cb163-1978"></a>Que es equivalente a esto:</span>
<span id="cb163-1979"><a href="#cb163-1979"></a></span>
<span id="cb163-1980"><a href="#cb163-1980"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim_{poisson} \beta_{o} + \beta_{1} * x_{1} + \beta_{2} * x_{2}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-1981"><a href="#cb163-1981"></a></span>
<span id="cb163-1982"><a href="#cb163-1982"></a>&nbsp;</span>
<span id="cb163-1983"><a href="#cb163-1983"></a></span>
<span id="cb163-1984"><a href="#cb163-1984"></a>Como puede ver el único argumento extra comparado con <span class="in">`lm()`</span> es <span class="in">`family`</span>. El resto es simplemente la "fórmula" y los "datos" con los que ya estamos familiarizados. Así que, de nuevo, podemos aprovechar nuestros conocimientos sobre los modelos lineales para extenderlos a estructuras de datos más complejas.</span>
<span id="cb163-1985"><a href="#cb163-1985"></a></span>
<span id="cb163-1986"><a href="#cb163-1986"></a>También necesitamos ejecutar <span class="in">`summary()`</span> para obtener el resultado del modelo:</span>
<span id="cb163-1987"><a href="#cb163-1987"></a></span>
<span id="cb163-1990"><a href="#cb163-1990"></a><span class="in">```{r}</span></span>
<span id="cb163-1991"><a href="#cb163-1991"></a><span class="fu">summary</span>(glm_pois)</span>
<span id="cb163-1992"><a href="#cb163-1992"></a></span>
<span id="cb163-1993"><a href="#cb163-1993"></a><span class="in">```</span></span>
<span id="cb163-1994"><a href="#cb163-1994"></a></span>
<span id="cb163-1995"><a href="#cb163-1995"></a>&nbsp;</span>
<span id="cb163-1996"><a href="#cb163-1996"></a></span>
<span id="cb163-1997"><a href="#cb163-1997"></a>&nbsp;</span>
<span id="cb163-1998"><a href="#cb163-1998"></a></span>
<span id="cb163-1999"><a href="#cb163-1999"></a>::: {.alert .alert-success}</span>
<span id="cb163-2000"><a href="#cb163-2000"></a>&nbsp;</span>
<span id="cb163-2001"><a href="#cb163-2001"></a></span>
<span id="cb163-2002"><a href="#cb163-2002"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-2003"><a href="#cb163-2003"></a></span>
<span id="cb163-2004"><a href="#cb163-2004"></a>&nbsp;</span>
<span id="cb163-2005"><a href="#cb163-2005"></a></span>
<span id="cb163-2006"><a href="#cb163-2006"></a>Cuadro de los coeficientes (estimados):</span>
<span id="cb163-2007"><a href="#cb163-2007"></a></span>
<span id="cb163-2008"><a href="#cb163-2008"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-2009"><a href="#cb163-2009"></a></span>
<span id="cb163-2010"><a href="#cb163-2010"></a>summ_glm_pois <span class="ot">&lt;-</span> <span class="fu">summary</span>(glm_pois)</span>
<span id="cb163-2011"><a href="#cb163-2011"></a></span>
<span id="cb163-2012"><a href="#cb163-2012"></a>summ_glm_pois<span class="sc">$</span>coefficients</span>
<span id="cb163-2013"><a href="#cb163-2013"></a><span class="in">```</span></span>
<span id="cb163-2014"><a href="#cb163-2014"></a></span>
<span id="cb163-2015"><a href="#cb163-2015"></a><span class="ss">-   </span>El modelo nos dice que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_glm_pois$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_glm_pois$coefficients[2, 4]`</span>). Esto se interpreta en realidad como que un aumento de 1 unidad de 'x1' resulta en 'y' (tasa) en un factor de exp(<span class="in">`r summ_glm_pois$coefficients[2, 1]`</span>) = <span class="in">`r exp(summ_glm_pois$coefficients[2, 1])`</span>.</span>
<span id="cb163-2016"><a href="#cb163-2016"></a></span>
<span id="cb163-2017"><a href="#cb163-2017"></a><span class="ss">-   </span>El modelo también nos dice que $\beta_2$ (el tamaño de efecto de 'x2') es <span class="in">`r summ_glm_pois$coefficients[3, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_glm_pois$coefficients[3, 4]`</span>). Esto significa que un aumento en 1 unidad de 'x2' resulta en 'y' (tasa) en un factor de exp(<span class="in">`r summ_glm_pois$coefficients[3, 1]`</span>) = <span class="in">`r exp(summ_glm_pois$coefficients[3, 1])`</span>.</span>
<span id="cb163-2018"><a href="#cb163-2018"></a>:::</span>
<span id="cb163-2019"><a href="#cb163-2019"></a></span>
<span id="cb163-2020"><a href="#cb163-2020"></a>&nbsp;</span>
<span id="cb163-2021"><a href="#cb163-2021"></a></span>
<span id="cb163-2022"><a href="#cb163-2022"></a>::: {.alert .alert-warning}</span>
<span id="cb163-2023"><a href="#cb163-2023"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-2024"><a href="#cb163-2024"></a></span>
<span id="cb163-2025"><a href="#cb163-2025"></a>&nbsp;</span>
<span id="cb163-2026"><a href="#cb163-2026"></a></span>
<span id="cb163-2027"><a href="#cb163-2027"></a><span class="ss">-   </span>Topp, E. N., Tscharntke, T., &amp; Loos, J. (2022). <span class="co">[</span><span class="ot">**Fire and landscape context shape plant and butterfly diversity in a South African shrubland**</span><span class="co">](https://onlinelibrary.wiley.com/doi/pdf/10.1111/ddi.13257)</span>. *Diversity and Distributions*, 28(3), 357-371.</span>
<span id="cb163-2028"><a href="#cb163-2028"></a></span>
<span id="cb163-2029"><a href="#cb163-2029"></a>"*La riqueza de especies de mariposas es de tres a cuatro veces mayor cuando aumenta el hábitat natural en el paisaje circundante (en un radio de 2 km), mientras que la abundancia de mariposas se asociaba negativamente con el aumento del tiempo transcurrido desde el último incendio.*"</span>
<span id="cb163-2030"><a href="#cb163-2030"></a></span>
<span id="cb163-2031"><a href="#cb163-2031"></a><span class="in">```{r, out.width = "100%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-2032"><a href="#cb163-2032"></a></span>
<span id="cb163-2033"><a href="#cb163-2033"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/butterflies.png"</span>)</span>
<span id="cb163-2034"><a href="#cb163-2034"></a></span>
<span id="cb163-2035"><a href="#cb163-2035"></a><span class="in">```</span></span>
<span id="cb163-2036"><a href="#cb163-2036"></a></span>
<span id="cb163-2037"><a href="#cb163-2037"></a>&nbsp;</span>
<span id="cb163-2038"><a href="#cb163-2038"></a>:::</span>
<span id="cb163-2039"><a href="#cb163-2039"></a></span>
<span id="cb163-2040"><a href="#cb163-2040"></a>&nbsp;</span>
<span id="cb163-2041"><a href="#cb163-2041"></a></span>
<span id="cb163-2042"><a href="#cb163-2042"></a>::: {.alert .alert-info}</span>
<span id="cb163-2043"><a href="#cb163-2043"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Ejercicio 8<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-2044"><a href="#cb163-2044"></a></span>
<span id="cb163-2045"><a href="#cb163-2045"></a>&nbsp;</span>
<span id="cb163-2046"><a href="#cb163-2046"></a></span>
<span id="cb163-2047"><a href="#cb163-2047"></a><span class="ss">-   </span>Intente correr un modelo <span class="in">`lm()`</span> (con una distribución gaussiana), compare los resultados y compruebe los residuos (<span class="in">`plot_model(model_name, type = "diag")`</span>)</span>
<span id="cb163-2048"><a href="#cb163-2048"></a>:::</span>
<span id="cb163-2049"><a href="#cb163-2049"></a></span>
<span id="cb163-2050"><a href="#cb163-2050"></a>&nbsp;</span>
<span id="cb163-2051"><a href="#cb163-2051"></a></span>
<span id="cb163-2052"><a href="#cb163-2052"></a>Existen muchas otras funciones de distribución y enlace:</span>
<span id="cb163-2053"><a href="#cb163-2053"></a></span>
<span id="cb163-2054"><a href="#cb163-2054"></a><span class="in">```{r, out.width = "80%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-2055"><a href="#cb163-2055"></a></span>
<span id="cb163-2056"><a href="#cb163-2056"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/link-functions.jpg"</span>)</span>
<span id="cb163-2057"><a href="#cb163-2057"></a></span>
<span id="cb163-2058"><a href="#cb163-2058"></a><span class="in">```</span></span>
<span id="cb163-2059"><a href="#cb163-2059"></a></span>
<span id="cb163-2060"><a href="#cb163-2060"></a>&nbsp;</span>
<span id="cb163-2061"><a href="#cb163-2061"></a></span>
<span id="cb163-2062"><a href="#cb163-2062"></a>------------------------------------------------------------------------</span>
<span id="cb163-2063"><a href="#cb163-2063"></a></span>
<span id="cb163-2064"><a href="#cb163-2064"></a><span class="fu">## Modelos de efectos variables (modelos mixtos)</span></span>
<span id="cb163-2065"><a href="#cb163-2065"></a></span>
<span id="cb163-2066"><a href="#cb163-2066"></a>A veces nuestros conjuntos de datos incluyen estructuras con varios niveles de organización. Por ejemplo, cuando tomamos muestras de varios individuos de diferentes poblaciones. En esos casos, la variación en el nivel estructural superior (poblaciones) podría impedir la detección de patrones en el nivel inferior (individuos).</span>
<span id="cb163-2067"><a href="#cb163-2067"></a></span>
<span id="cb163-2068"><a href="#cb163-2068"></a>Vamos a simular algunos datos que se asemejan a ese escenario. Tenemos dos predictores continuos (x1) y una respuesta continua (y). Cada muestra procede de 1 de 8 poblaciones diferentes (poblacion):</span>
<span id="cb163-2069"><a href="#cb163-2069"></a></span>
<span id="cb163-2072"><a href="#cb163-2072"></a><span class="in">```{r}</span></span>
<span id="cb163-2073"><a href="#cb163-2073"></a><span class="co"># x&lt;- 1</span></span>
<span id="cb163-2074"><a href="#cb163-2074"></a><span class="co"># definir semilla</span></span>
<span id="cb163-2075"><a href="#cb163-2075"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb163-2076"><a href="#cb163-2076"></a></span>
<span id="cb163-2077"><a href="#cb163-2077"></a><span class="co"># numero de observaciones</span></span>
<span id="cb163-2078"><a href="#cb163-2078"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb163-2079"><a href="#cb163-2079"></a>b0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb163-2080"><a href="#cb163-2080"></a>b1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb163-2081"><a href="#cb163-2081"></a>poblacion <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb163-2082"><a href="#cb163-2082"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb163-2083"><a href="#cb163-2083"></a></span>
<span id="cb163-2084"><a href="#cb163-2084"></a><span class="co">#  variables aleatorias</span></span>
<span id="cb163-2085"><a href="#cb163-2085"></a>x1 <span class="ot">&lt;-</span>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb163-2086"><a href="#cb163-2086"></a>y <span class="ot">&lt;-</span> b0 <span class="sc">+</span> poblacion <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> b1 <span class="sc">*</span> x1 <span class="sc">+</span> error</span>
<span id="cb163-2087"><a href="#cb163-2087"></a></span>
<span id="cb163-2088"><a href="#cb163-2088"></a><span class="co"># add letters</span></span>
<span id="cb163-2089"><a href="#cb163-2089"></a>poblacion <span class="ot">&lt;-</span> letters[poblacion <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb163-2090"><a href="#cb163-2090"></a></span>
<span id="cb163-2091"><a href="#cb163-2091"></a><span class="co"># create data set</span></span>
<span id="cb163-2092"><a href="#cb163-2092"></a>xy_datos_mixto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1, y, poblacion)</span>
<span id="cb163-2093"><a href="#cb163-2093"></a></span>
<span id="cb163-2094"><a href="#cb163-2094"></a><span class="fu">head</span>(xy_datos_mixto, <span class="dv">10</span>)</span>
<span id="cb163-2095"><a href="#cb163-2095"></a><span class="in">```</span></span>
<span id="cb163-2096"><a href="#cb163-2096"></a></span>
<span id="cb163-2097"><a href="#cb163-2097"></a>&nbsp;</span>
<span id="cb163-2098"><a href="#cb163-2098"></a></span>
<span id="cb163-2099"><a href="#cb163-2099"></a>Podemos explorar la relación entre 'y' y 'x1' con un gráfico:</span>
<span id="cb163-2100"><a href="#cb163-2100"></a></span>
<span id="cb163-2103"><a href="#cb163-2103"></a><span class="in">```{r}</span></span>
<span id="cb163-2104"><a href="#cb163-2104"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb163-2105"><a href="#cb163-2105"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb163-2106"><a href="#cb163-2106"></a></span>
<span id="cb163-2107"><a href="#cb163-2107"></a><span class="in">```</span></span>
<span id="cb163-2108"><a href="#cb163-2108"></a></span>
<span id="cb163-2109"><a href="#cb163-2109"></a>&nbsp;</span>
<span id="cb163-2110"><a href="#cb163-2110"></a></span>
<span id="cb163-2111"><a href="#cb163-2111"></a>¿Puede ver claramente el patrón de asociación entre las dos variables que hemos utilizado para simular los datos? Podemos seguir explorando los datos con un modelo de regresión lineal simple:</span>
<span id="cb163-2112"><a href="#cb163-2112"></a></span>
<span id="cb163-2115"><a href="#cb163-2115"></a><span class="in">```{r}</span></span>
<span id="cb163-2116"><a href="#cb163-2116"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> xy_datos_mixto))</span>
<span id="cb163-2117"><a href="#cb163-2117"></a></span>
<span id="cb163-2118"><a href="#cb163-2118"></a><span class="in">```</span></span>
<span id="cb163-2119"><a href="#cb163-2119"></a></span>
<span id="cb163-2120"><a href="#cb163-2120"></a>&nbsp;</span>
<span id="cb163-2121"><a href="#cb163-2121"></a></span>
<span id="cb163-2122"><a href="#cb163-2122"></a>A pesar de haber simulado un $\beta_1$ distinto de cero, no tenemos ninguna asociación significativa según este modelo y la estimación de $\beta_1$ está muy lejos de la simulada. Esta pobre inferencia se debe a que estamos ignorando una característica importante de nuestros datos, la agrupación de las muestras en "poblaciones".</span>
<span id="cb163-2123"><a href="#cb163-2123"></a></span>
<span id="cb163-2124"><a href="#cb163-2124"></a>Los modelos de efectos mixtos (también conocidos como modelos multinivel o modelos de efectos variables) pueden ayudarnos a tener en cuenta estas características adicionales, mejorando significativamente nuestro poder de inferencia. Coloreemos cada una de las poblaciones para ver cómo covarían las variables en cada subgrupo de datos:</span>
<span id="cb163-2125"><a href="#cb163-2125"></a></span>
<span id="cb163-2128"><a href="#cb163-2128"></a><span class="in">```{r}</span></span>
<span id="cb163-2129"><a href="#cb163-2129"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span> </span>
<span id="cb163-2130"><a href="#cb163-2130"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb163-2131"><a href="#cb163-2131"></a></span>
<span id="cb163-2132"><a href="#cb163-2132"></a><span class="in">```</span></span>
<span id="cb163-2133"><a href="#cb163-2133"></a></span>
<span id="cb163-2134"><a href="#cb163-2134"></a>&nbsp;</span>
<span id="cb163-2135"><a href="#cb163-2135"></a></span>
<span id="cb163-2136"><a href="#cb163-2136"></a>Parece haber un patrón claro de asociación positiva entre x1 e y. El patrón se hace un poco más evidente si mostramos cada población en su propio panel:</span>
<span id="cb163-2137"><a href="#cb163-2137"></a></span>
<span id="cb163-2138"><a href="#cb163-2138"></a><span class="in">```{r, out.width= "100%"}</span></span>
<span id="cb163-2139"><a href="#cb163-2139"></a></span>
<span id="cb163-2140"><a href="#cb163-2140"></a><span class="fu">ggplot</span>(<span class="at">data =</span> xy_datos_mixto, <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y, <span class="at">color =</span> poblacion)) <span class="sc">+</span></span>
<span id="cb163-2141"><a href="#cb163-2141"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb163-2142"><a href="#cb163-2142"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> poblacion) <span class="sc">+</span></span>
<span id="cb163-2143"><a href="#cb163-2143"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) </span>
<span id="cb163-2144"><a href="#cb163-2144"></a></span>
<span id="cb163-2145"><a href="#cb163-2145"></a><span class="in">```</span></span>
<span id="cb163-2146"><a href="#cb163-2146"></a></span>
<span id="cb163-2147"><a href="#cb163-2147"></a>&nbsp;</span>
<span id="cb163-2148"><a href="#cb163-2148"></a></span>
<span id="cb163-2149"><a href="#cb163-2149"></a>Construyamos un modelo de efectos mixtos utilizando la población como intercepto variable:</span>
<span id="cb163-2150"><a href="#cb163-2150"></a></span>
<span id="cb163-2153"><a href="#cb163-2153"></a><span class="in">```{r}</span></span>
<span id="cb163-2154"><a href="#cb163-2154"></a>mix_eff_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> poblacion), <span class="at">data =</span> xy_datos_mixto)</span>
<span id="cb163-2155"><a href="#cb163-2155"></a><span class="in">```</span></span>
<span id="cb163-2156"><a href="#cb163-2156"></a></span>
<span id="cb163-2157"><a href="#cb163-2157"></a>Que es equivalente a esto:</span>
<span id="cb163-2158"><a href="#cb163-2158"></a></span>
<span id="cb163-2159"><a href="#cb163-2159"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">6</span><span class="kw">&gt;</span>$\hat{Y} \sim_{gausiana} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-2160"><a href="#cb163-2160"></a></span>
<span id="cb163-2161"><a href="#cb163-2161"></a>&nbsp;</span>
<span id="cb163-2162"><a href="#cb163-2162"></a></span>
<span id="cb163-2163"><a href="#cb163-2163"></a>Podemos ver el resultado del modelo igual que con un modelo <span class="in">`lm()`</span>:</span>
<span id="cb163-2164"><a href="#cb163-2164"></a></span>
<span id="cb163-2167"><a href="#cb163-2167"></a><span class="in">```{r}</span></span>
<span id="cb163-2168"><a href="#cb163-2168"></a><span class="fu">summary</span>(mix_eff_mod)</span>
<span id="cb163-2169"><a href="#cb163-2169"></a></span>
<span id="cb163-2170"><a href="#cb163-2170"></a><span class="in">```</span></span>
<span id="cb163-2171"><a href="#cb163-2171"></a></span>
<span id="cb163-2172"><a href="#cb163-2172"></a>&nbsp;</span>
<span id="cb163-2173"><a href="#cb163-2173"></a></span>
<span id="cb163-2174"><a href="#cb163-2174"></a>El modelo detectó correctamente el patrón simulado y la estimación de $\beta_1$ (<span class="in">`r round(fixef(mix_eff_mod)[2], 3)`</span>) es muy cercana al valor simulado.</span>
<span id="cb163-2175"><a href="#cb163-2175"></a></span>
<span id="cb163-2176"><a href="#cb163-2176"></a>&nbsp;</span>
<span id="cb163-2177"><a href="#cb163-2177"></a></span>
<span id="cb163-2178"><a href="#cb163-2178"></a>::: {.alert .alert-warning}</span>
<span id="cb163-2179"><a href="#cb163-2179"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Caso de estudio<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-2180"><a href="#cb163-2180"></a></span>
<span id="cb163-2181"><a href="#cb163-2181"></a>&nbsp;</span>
<span id="cb163-2182"><a href="#cb163-2182"></a></span>
<span id="cb163-2183"><a href="#cb163-2183"></a><span class="ss">-   </span>Araya-Salas M, P González-Gómez, K Wojczulanis-Jakubas, V López III &amp; T Wright. 2018. <span class="co">[</span><span class="ot">**Spatial memory is as important as weapon and body size for territorial ownership in a lekking hummingbird**</span><span class="co">](https://www.nature.com/articles/s41598-018-20441-x)</span>. *Scientific Reports*. 13, e0189969</span>
<span id="cb163-2184"><a href="#cb163-2184"></a></span>
<span id="cb163-2185"><a href="#cb163-2185"></a>"*... el tamaño corporal mostró una correlación negativa con la frecuencia baja del canto.*"</span>
<span id="cb163-2186"><a href="#cb163-2186"></a></span>
<span id="cb163-2187"><a href="#cb163-2187"></a><span class="in">```{r, out.width = "80%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-2188"><a href="#cb163-2188"></a></span>
<span id="cb163-2189"><a href="#cb163-2189"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/lbh_song_size.png"</span>)</span>
<span id="cb163-2190"><a href="#cb163-2190"></a></span>
<span id="cb163-2191"><a href="#cb163-2191"></a><span class="in">```</span></span>
<span id="cb163-2192"><a href="#cb163-2192"></a></span>
<span id="cb163-2193"><a href="#cb163-2193"></a>&nbsp;</span>
<span id="cb163-2194"><a href="#cb163-2194"></a>:::</span>
<span id="cb163-2195"><a href="#cb163-2195"></a></span>
<span id="cb163-2196"><a href="#cb163-2196"></a>&nbsp;</span>
<span id="cb163-2197"><a href="#cb163-2197"></a></span>
<span id="cb163-2198"><a href="#cb163-2198"></a>::: {.alert .alert-success}</span>
<span id="cb163-2199"><a href="#cb163-2199"></a>&nbsp;</span>
<span id="cb163-2200"><a href="#cb163-2200"></a></span>
<span id="cb163-2201"><a href="#cb163-2201"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;&lt;b&gt;</span>Interpretación del modelo<span class="kw">&lt;/b&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-2202"><a href="#cb163-2202"></a></span>
<span id="cb163-2203"><a href="#cb163-2203"></a>&nbsp;</span>
<span id="cb163-2204"><a href="#cb163-2204"></a></span>
<span id="cb163-2205"><a href="#cb163-2205"></a>Cuadro con los coeficientes (estimados):</span>
<span id="cb163-2206"><a href="#cb163-2206"></a></span>
<span id="cb163-2207"><a href="#cb163-2207"></a><span class="in">```{r, echo= FALSE}</span></span>
<span id="cb163-2208"><a href="#cb163-2208"></a></span>
<span id="cb163-2209"><a href="#cb163-2209"></a>summ_mix_eff_mod <span class="ot">&lt;-</span> <span class="fu">summary</span>(mix_eff_mod)</span>
<span id="cb163-2210"><a href="#cb163-2210"></a></span>
<span id="cb163-2211"><a href="#cb163-2211"></a>summ_mix_eff_mod<span class="sc">$</span>coefficients</span>
<span id="cb163-2212"><a href="#cb163-2212"></a></span>
<span id="cb163-2213"><a href="#cb163-2213"></a><span class="in">```</span></span>
<span id="cb163-2214"><a href="#cb163-2214"></a></span>
<span id="cb163-2215"><a href="#cb163-2215"></a>&nbsp;</span>
<span id="cb163-2216"><a href="#cb163-2216"></a></span>
<span id="cb163-2217"><a href="#cb163-2217"></a><span class="ss">-   </span>El modelo encontró que $\beta_1$ (el tamaño de efecto de 'x1') es <span class="in">`r summ_mix_eff_mod$coefficients[2, 1]`</span> y que es significativamente diferente de 0 (p = <span class="in">`r summ_mix_eff_mod$coefficients[2, 5]`</span>)</span>
<span id="cb163-2218"><a href="#cb163-2218"></a></span>
<span id="cb163-2219"><a href="#cb163-2219"></a><span class="ss">-   </span>Los valores simulados de los parámetros de regresión pueden compararse con el resumen del modelo <span class="in">`lmer()`</span> para tener una idea de la precisión del modelo:</span>
<span id="cb163-2220"><a href="#cb163-2220"></a></span>
<span id="cb163-2221"><a href="#cb163-2221"></a><span class="ss">    -   </span>$\beta_1$ se fijó en <span class="in">`r b1`</span> y se estimó como <span class="in">`r round(summ_mix_eff_mod$coefficients[2, 1], 3)`</span>.</span>
<span id="cb163-2222"><a href="#cb163-2222"></a></span>
<span id="cb163-2223"><a href="#cb163-2223"></a><span class="ss">-   </span>La varianza del intercepto para cada población fue de <span class="in">`r var(ranef(mix_eff_mod)$poblacion[,1])`</span> y la desviación estándar de <span class="in">`r sd(ranef(mix_eff_mod)$poblacion[,1])`</span></span>
<span id="cb163-2224"><a href="#cb163-2224"></a></span>
<span id="cb163-2225"><a href="#cb163-2225"></a><span class="ss">-   </span>Los interceptos estimados para cada población son:</span>
<span id="cb163-2226"><a href="#cb163-2226"></a></span>
<span id="cb163-2229"><a href="#cb163-2229"></a><span class="in">```{r}</span></span>
<span id="cb163-2230"><a href="#cb163-2230"></a><span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion</span>
<span id="cb163-2231"><a href="#cb163-2231"></a></span>
<span id="cb163-2232"><a href="#cb163-2232"></a><span class="in">```</span></span>
<span id="cb163-2233"><a href="#cb163-2233"></a></span>
<span id="cb163-2234"><a href="#cb163-2234"></a>&nbsp;</span>
<span id="cb163-2235"><a href="#cb163-2235"></a></span>
<span id="cb163-2236"><a href="#cb163-2236"></a><span class="ss">-   </span>Podemos compararlos con los promedios para cada población en los datos:</span>
<span id="cb163-2237"><a href="#cb163-2237"></a></span>
<span id="cb163-2240"><a href="#cb163-2240"></a><span class="in">```{r}</span></span>
<span id="cb163-2241"><a href="#cb163-2241"></a><span class="co"># sumar interceptos por poblacion a el intercepto total</span></span>
<span id="cb163-2242"><a href="#cb163-2242"></a>interceptos <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mix_eff_mod)<span class="sc">$</span>poblacion <span class="sc">+</span> <span class="fu">fixef</span>(mix_eff_mod)[<span class="dv">1</span>]</span>
<span id="cb163-2243"><a href="#cb163-2243"></a></span>
<span id="cb163-2244"><a href="#cb163-2244"></a><span class="co"># calcular los promedios por poblacion en los datos </span></span>
<span id="cb163-2245"><a href="#cb163-2245"></a>prom_pobs <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(y <span class="sc">~</span> poblacion, xy_datos_mixto, mean)</span>
<span id="cb163-2246"><a href="#cb163-2246"></a></span>
<span id="cb163-2247"><a href="#cb163-2247"></a><span class="co"># unir</span></span>
<span id="cb163-2248"><a href="#cb163-2248"></a><span class="fu">cbind</span>(interceptos, <span class="at">prom_pobs=</span> prom_pobs[,<span class="dv">2</span>])</span>
<span id="cb163-2249"><a href="#cb163-2249"></a></span>
<span id="cb163-2250"><a href="#cb163-2250"></a><span class="in">```</span></span>
<span id="cb163-2251"><a href="#cb163-2251"></a></span>
<span id="cb163-2252"><a href="#cb163-2252"></a>&nbsp;</span>
<span id="cb163-2253"><a href="#cb163-2253"></a></span>
<span id="cb163-2254"><a href="#cb163-2254"></a><span class="ss">-   </span>La varianza entre los niveles del factor aleatorio (<span class="in">`poblacion`</span>) es de <span class="in">`r var(ranef(mix_eff_mod)$poblacion[,1])`</span> y la desviación estándar de <span class="in">`r sd(ranef(mix_eff_mod)$poblacion[,1])`</span></span>
<span id="cb163-2255"><a href="#cb163-2255"></a></span>
<span id="cb163-2256"><a href="#cb163-2256"></a>&nbsp;</span>
<span id="cb163-2257"><a href="#cb163-2257"></a>:::</span>
<span id="cb163-2258"><a href="#cb163-2258"></a></span>
<span id="cb163-2259"><a href="#cb163-2259"></a>&nbsp;</span>
<span id="cb163-2260"><a href="#cb163-2260"></a></span>
<span id="cb163-2261"><a href="#cb163-2261"></a><span class="fu">### La paradoja de Simpson</span></span>
<span id="cb163-2262"><a href="#cb163-2262"></a></span>
<span id="cb163-2263"><a href="#cb163-2263"></a>La paradoja de Simpson es un fenómeno en estadística en el que una tendencia aparece en varios grupos de datos pero desaparece o se invierte cuando se combinan los grupos. Se ha utilizado para ilustrar el tipo de resultados engañosos que puede generar el ignorar la estructura en los datos y las relaciones causales entre variables.</span>
<span id="cb163-2264"><a href="#cb163-2264"></a></span>
<span id="cb163-2265"><a href="#cb163-2265"></a><span class="in">```{r, out.width = "80%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-2266"><a href="#cb163-2266"></a></span>
<span id="cb163-2267"><a href="#cb163-2267"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/simpsons_paradox.gif"</span>)</span>
<span id="cb163-2268"><a href="#cb163-2268"></a></span>
<span id="cb163-2269"><a href="#cb163-2269"></a><span class="in">```</span></span>
<span id="cb163-2270"><a href="#cb163-2270"></a></span>
<span id="cb163-2271"><a href="#cb163-2271"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"3"</span><span class="kw">&gt;</span>Tomado de wikipedia<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-2272"><a href="#cb163-2272"></a></span>
<span id="cb163-2273"><a href="#cb163-2273"></a>&nbsp;</span>
<span id="cb163-2274"><a href="#cb163-2274"></a></span>
<span id="cb163-2275"><a href="#cb163-2275"></a>La estructura de los datos debido a observaciones pertenecientes al mismo grupo puede ser tomada en cuenta usando el grupo como un factor aleatorio, tal y como se hizo en el ejemplo anterior.</span>
<span id="cb163-2276"><a href="#cb163-2276"></a></span>
<span id="cb163-2277"><a href="#cb163-2277"></a>&nbsp;</span>
<span id="cb163-2278"><a href="#cb163-2278"></a></span>
<span id="cb163-2279"><a href="#cb163-2279"></a>::: {.alert .alert-info}</span>
<span id="cb163-2280"><a href="#cb163-2280"></a><span class="kw">&lt;center&gt;&lt;b&gt;&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Modelos lineales como abordaje estadístico estándar <span class="kw">&lt;/font&gt;&lt;/b&gt;&lt;/center&gt;</span></span>
<span id="cb163-2281"><a href="#cb163-2281"></a></span>
<span id="cb163-2282"><a href="#cb163-2282"></a><span class="in">```{r, out.width = "40%", echo = FALSE, fig.align= "center"}</span></span>
<span id="cb163-2283"><a href="#cb163-2283"></a></span>
<span id="cb163-2284"><a href="#cb163-2284"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./images/swiss_knife.png"</span>)</span>
<span id="cb163-2285"><a href="#cb163-2285"></a></span>
<span id="cb163-2286"><a href="#cb163-2286"></a><span class="in">```</span></span>
<span id="cb163-2287"><a href="#cb163-2287"></a></span>
<span id="cb163-2288"><a href="#cb163-2288"></a><span class="kw">&lt;center&gt;&lt;font</span> <span class="er">size</span> <span class="ot">=</span> <span class="st">5</span><span class="kw">&gt;</span>$\hat{Y} \sim_{función\ de\ enlace} (\beta_{o} + \beta_{grupo}) + \beta_{1} * x_{1} + \cdots + \beta_{n} * x_{n}$<span class="kw">&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb163-2289"><a href="#cb163-2289"></a></span>
<span id="cb163-2290"><a href="#cb163-2290"></a><span class="ss">-   </span>Este modelo básico incluye una función de enlace que cuando es gausiana (i.e. normal) equivale a un modelo lineal y cuando no, a un modelo generalizado</span>
<span id="cb163-2291"><a href="#cb163-2291"></a></span>
<span id="cb163-2292"><a href="#cb163-2292"></a><span class="ss">-   </span>Cuando el $\beta_{grupo}$ es diferente entre grupos (i.e. cuando el intercepto difiere entre grupos) es un modelo mixto con intercepto variable (i.e. aleatorio)</span>
<span id="cb163-2293"><a href="#cb163-2293"></a></span>
<span id="cb163-2294"><a href="#cb163-2294"></a>&nbsp;</span>
<span id="cb163-2295"><a href="#cb163-2295"></a>:::</span>
<span id="cb163-2296"><a href="#cb163-2296"></a></span>
<span id="cb163-2297"><a href="#cb163-2297"></a>&nbsp;</span>
<span id="cb163-2298"><a href="#cb163-2298"></a></span>
<span id="cb163-2299"><a href="#cb163-2299"></a>Este manual solo pretende sugerir un abordaje estadístico centrado en los modelos de regresión desde el cual se pueden llevar a cabo adecuadamente la mayoría de los análisis estadísticos que usamos en biología. **El manual no tiene como objetivo explicar en detalle las particularidades de los modelos generalizados y mixtos**. Note que estos modelos, principalmente los mixtos, pueden adaptarse a otras estructuras de datos mas complejas no cubiertas aquí, como lo son las pendientes aleatorias, pendientes e interceptos aleatorios, estructuras de correlación (i.e. autocorrelación espacial o temporal, pedigrís o árboles filogenéticos), medidas repetidas y el uso de pseudoreplicas, entre otras.</span>
<span id="cb163-2300"><a href="#cb163-2300"></a></span>
<span id="cb163-2301"><a href="#cb163-2301"></a>&nbsp;</span>
<span id="cb163-2302"><a href="#cb163-2302"></a></span>
<span id="cb163-2303"><a href="#cb163-2303"></a>------------------------------------------------------------------------</span>
<span id="cb163-2304"><a href="#cb163-2304"></a></span>
<span id="cb163-2305"><a href="#cb163-2305"></a><span class="fu">## Referencias</span></span>
<span id="cb163-2306"><a href="#cb163-2306"></a></span>
<span id="cb163-2307"><a href="#cb163-2307"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Richard McElreath's Statistical Rethinking book</span><span class="co">](https://github.com/rmcelreath/stat_rethinking_2022)</span></span>
<span id="cb163-2308"><a href="#cb163-2308"></a></span>
<span id="cb163-2309"><a href="#cb163-2309"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R's rbinom -- Simulate Binomial or Bernoulli trials</span><span class="co">](https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rbinom/)</span></span>
<span id="cb163-2310"><a href="#cb163-2310"></a></span>
<span id="cb163-2311"><a href="#cb163-2311"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R's rnorm -- selecting values from a normal distribution</span><span class="co">](https://www.programmingr.com/examples/neat-tricks/sample-r-function/r-rnorm/)</span></span>
<span id="cb163-2312"><a href="#cb163-2312"></a></span>
<span id="cb163-2313"><a href="#cb163-2313"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R's exp -- Simulating Exponential Distributions</span><span class="co">](https://www.programmingr.com/examples/neat-tricks/sample-r-function/rexp/)</span></span>
<span id="cb163-2314"><a href="#cb163-2314"></a></span>
<span id="cb163-2315"><a href="#cb163-2315"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Simulating data in R</span><span class="co">](https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/)</span></span>
<span id="cb163-2316"><a href="#cb163-2316"></a></span>
<span id="cb163-2317"><a href="#cb163-2317"></a>&nbsp;</span>
<span id="cb163-2318"><a href="#cb163-2318"></a></span>
<span id="cb163-2319"><a href="#cb163-2319"></a>------------------------------------------------------------------------</span>
<span id="cb163-2320"><a href="#cb163-2320"></a></span>
<span id="cb163-2321"><a href="#cb163-2321"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"4"</span><span class="kw">&gt;</span>Información de la sesión<span class="kw">&lt;/font&gt;</span></span>
<span id="cb163-2322"><a href="#cb163-2322"></a></span>
<span id="cb163-2323"><a href="#cb163-2323"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb163-2324"><a href="#cb163-2324"></a></span>
<span id="cb163-2325"><a href="#cb163-2325"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb163-2326"><a href="#cb163-2326"></a></span>
<span id="cb163-2327"><a href="#cb163-2327"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2023 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>